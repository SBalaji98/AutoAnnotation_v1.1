(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{116:function(e,t,a){e.exports=a.p+"static/media/carback.d753e984.jpg"},188:function(e,t,a){},218:function(e,t){},275:function(e,t,a){e.exports=a(501)},498:function(e,t,a){},499:function(e,t,a){},501:function(e,t,a){"use strict";a.r(t);var n,o=a(0),r=a.n(o),i=a(16),c=a.n(i),l=(a(188),a(46)),s=a(47),u=a(57),m=a(61),d=a(58),g=a(62),h=a(74),p=a(91),f=a(41),b=a.n(f),v=a(14),E=a(24),y=a.n(E),O=a(66),w=a(11),x=a(10),j=a(539),I=a(542),_=a(233),N=a.n(_),S=a(506),T=a(544),C=a(105),k=a(40),A=a.n(k),M=a(26),L=Object(j.a)({container:{margin:8},header:{display:"flex",flexDirection:"row",alignItems:"center",padding:8,paddingLeft:16,paddingRight:16},title:{fontSize:14,fontWeight:"bold",flexGrow:1,paddingLeft:8,color:C.a[800],"& span":{color:C.a[600],fontSize:12}},expandButton:{padding:0,width:30,height:30,"& .icon":{marginTop:-6,width:20,height:20,transition:"500ms transform","&.expanded":{transform:"rotate(180deg)"}}},expandedContent:{maxHeight:300,overflowY:"auto","&.noScroll":{overflowY:"visible",overflow:"visible"}}}),R=Object(o.memo)(function(e){var t=e.icon,a=e.title,n=e.subTitle,i=e.children,c=e.noScroll,l=void 0!==c&&c,s=e.expandedByDefault,u=void 0!==s&&s,m=L(),d=r.a.createElement("div",{className:A()(m.expandedContent,l&&"noScroll")},i),g=Object(o.useState)(u),h=Object(x.a)(g,2),p=h[0],f=h[1],b=Object(M.a)(function(){return f(!p)});return r.a.createElement(I.a,{className:m.container},r.a.createElement("div",{className:m.header},t,r.a.createElement("div",{className:m.title},a," ",r.a.createElement("span",null,n)),r.a.createElement(S.a,{onClick:b,className:m.expandButton},r.a.createElement(N.a,{className:A()("icon",p&&"expanded")}))),l?p?d:null:r.a.createElement(T.a,{in:p},d))},function(e,t){return e.title===t.title&&e.children===t.children}),P=a(123),D=a.n(P),W=a(260),B=a(138),G=a.n(B),z=Object(W.a)("div")({paddingLeft:16,paddingRight:16,fontSize:12,"& h1":{fontSize:18},"& h2":{fontSize:14},"& h3":{fontSize:12},"& h4":{fontSize:12},"& h5":{fontSize:12},"& h6":{fontSize:12},"& p":{fontSize:12},"& a":{},"& img":{width:"100%"}}),H=(Object(o.memo)(function(e){var t=e.description;return r.a.createElement(R,{title:"Task Description",icon:r.a.createElement(D.a,{style:{color:C.a[700]}}),expandedByDefault:!0},r.a.createElement(z,null,r.a.createElement(G.a,{source:t})))}),a(234)),V=a.n(H),F=a(545),U=a(546),Y=a(217),J=a(79),q=a.n(J),K=Object(j.a)({img:{width:40,height:40,borderRadius:8}}),X=function(e){return[e.name,(e.regions||[]).length,e.src]},Z=Object(o.memo)(function(e){var t=e.images,a=e.onSelect,n=K();return r.a.createElement(R,{title:"Images",subTitle:"(".concat(t.length,")"),icon:r.a.createElement(V.a,{style:{color:C.a[700]}})},r.a.createElement("div",null,r.a.createElement(F.a,null,t.map(function(e,t){return r.a.createElement(U.a,{button:!0,onClick:function(){return a(e)},dense:!0,key:t},r.a.createElement("img",{className:n.img,src:e.src}),r.a.createElement(Y.a,{primary:e.name,secondary:"".concat((e.regions||[]).length," Labels")}))}))))},function(e,t){return q()(e.images.map(X),t.images.map(X))}),Q=a(239),$=a.n(Q),ee=a(547),te=a(235),ae=a.n(te),ne=a(236),oe=a.n(ne),re=a(86),ie=a.n(re),ce=a(113),le=a.n(ce),se=a(237),ue=a.n(se),me=a(169),de=a.n(me),ge=a(238),he=a.n(ge),pe=a(110),fe={container:{fontSize:11,fontWeight:"bold",color:C.a[700],"& .icon":{marginTop:4,width:16,height:16},"& .icon2":{opacity:.5,width:16,height:16,transition:"200ms opacity","&:hover":{cursor:"pointer",opacity:1}}},row:{padding:4,cursor:"pointer","&.header:hover":{backgroundColor:"#fff"},"&.highlighted":{backgroundColor:pe.a[100]},"&:hover":{backgroundColor:pe.a[50],color:C.a[800]}},chip:{display:"flex",flexDirection:"row",padding:2,borderRadius:2,paddingLeft:4,paddingRight:4,alignItems:"center","& .color":{borderRadius:5,width:10,height:10,marginRight:4},"& .text":{}}},be=Object(j.a)(fe),ve=Object(W.a)("div")({borderTop:"1px solid ".concat(C.a[200]),marginTop:2,marginBottom:2}),Ee=function(e){var t=e.color,a=e.text,n=be();return r.a.createElement("span",{className:n.chip},r.a.createElement("div",{className:"color",style:{backgroundColor:t}}),r.a.createElement("div",{className:"text"},a))},ye=function(e){var t=e.header,a=e.highlighted,n=e.order,i=e.classification,c=e.area,l=(e.tags,e.trash),s=e.lock,u=e.visible,m=e.onClick,d=be(),g=Object(o.useState)(!1),h=Object(x.a)(g,2),p=(h[0],h[1]);return r.a.createElement("div",{onClick:m,onMouseEnter:function(){return p(!0)},onMouseLeave:function(){return p(!1)},className:A()(d.row,{header:t,highlighted:a})},r.a.createElement(ee.a,{container:!0,alignItems:"center"},r.a.createElement(ee.a,{item:!0,xs:2},r.a.createElement("div",{style:{textAlign:"right",paddingRight:10}},n)),r.a.createElement(ee.a,{item:!0,xs:5},i),r.a.createElement(ee.a,{item:!0,xs:2},r.a.createElement("div",{style:{textAlign:"right",paddingRight:6}},c)),r.a.createElement(ee.a,{item:!0,xs:1},l),r.a.createElement(ee.a,{item:!0,xs:1},s),r.a.createElement(ee.a,{item:!0,xs:1},u)))},Oe=Object(o.memo)(function(){return r.a.createElement(ye,{header:!0,highlighted:!1,order:r.a.createElement(ae.a,{className:"icon"}),classification:r.a.createElement("div",{style:{paddingLeft:10}},"Class"),area:r.a.createElement(oe.a,{className:"icon"}),trash:r.a.createElement(ie.a,{className:"icon"}),lock:r.a.createElement(le.a,{className:"icon"}),visible:r.a.createElement(de.a,{className:"icon"})})}),we=Object(o.memo)(function(e){var t=e.region,a=e.highlighted,n=e.onSelectRegion,o=e.onDeleteRegion,i=e.onChangeRegion,c=(e.visible,e.locked,e.color),l=e.cls,s=e.index;return r.a.createElement(ye,{header:!1,highlighted:a,onClick:function(){return n(t)},order:"#".concat(s+1),classification:r.a.createElement(Ee,{text:l||"",color:c||"#ddd"}),area:"",trash:r.a.createElement(ie.a,{onClick:function(){return o(t)},className:"icon2"}),lock:t.locked?r.a.createElement(le.a,{onClick:function(){return i(Object(w.a)({},t,{locked:!1}))},className:"icon2"}):r.a.createElement(ue.a,{onClick:function(){return i(Object(w.a)({},t,{locked:!0}))},className:"icon2"}),visible:t.visible||void 0===t.visible?r.a.createElement(de.a,{onClick:function(){return i(Object(w.a)({},t,{visible:!1}))},className:"icon2"}):r.a.createElement(he.a,{onClick:function(){return i(Object(w.a)({},t,{visible:!0}))},className:"icon2"})})},function(e,t){return e.highlighted===t.highlighted&&e.visible===t.visible&&e.locked===t.locked&&e.id===t.id&&e.index===t.index&&e.cls===t.cls&&e.color===t.color}),xe=function(e){return[e.id,e.color,e.locked,e.visible,e.highlighted]},je=Object(o.memo)(function(e){var t=e.regions,a=e.onDeleteRegion,n=e.onChangeRegion,o=e.onSelectRegion,i=be();return r.a.createElement(R,{title:"Regions",subTitle:"",icon:r.a.createElement($.a,{style:{color:C.a[700]}}),expandedByDefault:!0},r.a.createElement("div",{className:i.container},r.a.createElement(Oe,null),r.a.createElement(ve,null),t.map(function(e,t){return r.a.createElement(we,Object.assign({key:e.id},e,{region:e,index:t,onSelectRegion:o,onDeleteRegion:a,onChangeRegion:n}))})))},function(e,t){return q()(e.regions.map(xe),t.regions.map(xe))}),Ie=a(240),_e=a.n(Ie),Ne=a(548),Se=a(166),Te=a.n(Se),Ce=a(114),ke=a.n(Ce),Ae=Object(j.a)({emptyText:{fontSize:14,fontWeight:"bold",color:C.a[500],textAlign:"center",padding:20}}),Me=Object(o.memo)(function(e){var t=e.history,a=e.onRestoreHistory,n=Ae();return r.a.createElement(R,{title:"History",icon:r.a.createElement(_e.a,{style:{color:C.a[700]}}),expandedByDefault:!0},r.a.createElement(F.a,null,0===t.length&&r.a.createElement("div",{className:n.emptyText},"No History Yet"),t.map(function(e,t){var n=e.name,o=e.time;return r.a.createElement(U.a,{button:!0,dense:!0,key:t},r.a.createElement(Y.a,{primary:n,secondary:ke()(o).format("LT")}),0===t&&r.a.createElement(Ne.a,{onClick:function(){return a()}},r.a.createElement(S.a,null,r.a.createElement(Te.a,null))))})))},function(e,t){return q()(e.history.map(function(e){return[e.name,e.time]}),t.history.map(function(e){return[e.name,e.time]}))}),Le=function(e){var t=e.state,a=e.lastAction,n=(t.images||[]).find(function(e){return e.src===t.selectedImage}),o=n?(n.regions||[]).find(function(e){return e.highlighted}):null;return r.a.createElement(R,{title:"Debug",icon:r.a.createElement("span",null),expandedByDefault:!0},r.a.createElement("div",{style:{padding:4}},r.a.createElement("div",null,r.a.createElement("b",null,"region"),":"),r.a.createElement("pre",null,JSON.stringify(o,null,"  ")),r.a.createElement("div",null,r.a.createElement("b",null,"lastAction"),":"),r.a.createElement("pre",null,JSON.stringify(a,null,"  ")),r.a.createElement("div",null,r.a.createElement("b",null,"mode"),":"),r.a.createElement("pre",null,JSON.stringify(t.mode,null,"  ")),r.a.createElement("div",null,r.a.createElement("b",null,"frame:")),r.a.createElement("pre",null,JSON.stringify(t.selectedImageFrameTime,null,"  "))))},Re=a(241),Pe=a.n(Re),De=a(65),We=a(8),Be=a.n(We),Ge=(Object(j.a)({}),[]),ze=Object(o.memo)(function(e){var t=e.currentImage,a=e.imageClsList,n=void 0===a?Ge:a,i=e.imageTagList,c=void 0===i?Ge:i,l=e.onChangeImage;if(!t)return null;var s=t.tags,u=void 0===s?[]:s,m=t.cls,d=void 0===m?null:m,g=Object(M.a)(function(e){return l({cls:e.value})}),h=Object(M.a)(function(e){return l({tags:e.map(function(e){return e.value})})}),p=Object(o.useMemo)(function(){return d?{value:d,label:d}:null},[d]),f=Object(o.useMemo)(function(){return Object(We.asMutable)(n.map(function(e){return{value:e,label:e}}))},[n]),b=Object(o.useMemo)(function(){return Object(We.asMutable)(c.map(function(e){return{value:e,label:e}}))},[c]),v=Object(o.useMemo)(function(){return u.map(function(e){return{value:e,label:e}})},[u]);return r.a.createElement(R,{title:"Image Tags",expandedByDefault:!0,noScroll:!0,icon:r.a.createElement(Pe.a,{style:{color:C.a[700]}})},n.length>0&&r.a.createElement("div",{style:{padding:8}},r.a.createElement(De.a,{placeholder:"Image Classification",onChange:g,value:p,options:f})),c.length>0&&r.a.createElement("div",{style:{padding:8,paddingTop:0}},r.a.createElement(De.a,{isMulti:!0,placeholder:"Image Tags",onChange:h,value:v,options:b})))},function(e,t){return e.currentImage.cls===t.currentImage.cls&&e.currentImage.tags===t.currentImage.tags&&e.imageClsList===t.imageClsList&&e.imageTagList===t.imageTagList}),He=a(242),Ve=a.n(He),Fe=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(e<1e3)return e+"ms";var a=e/1e3;if(a<60)return Number.isInteger(a)?a+"s":a.toFixed(t)+"s";var n=a/60;return Number.isInteger(n)?n+"m":n.toFixed(t)+"m"},Ue=Object(W.a)("div")({cursor:"pointer",display:"flex",alignItems:"center",padding:8,fontSize:14,color:C.a[700],"&.current":{backgroundColor:pe.a[100]},"&:hover":{backgroundColor:C.a[100]},"& .time":{flexGrow:1,fontWeight:"bold","& .regionCount":{marginLeft:8,fontWeight:"normal",color:C.a[500]}},"& .trash":{"& .icon":{fontSize:18,color:C.a[600],transition:"transform 80ms","&:hover":{color:C.a[800],transform:"scale(1.25,1.25)"}}}}),Ye=function(e){var t=e.currentVideoTime,a=e.keyframes,n=e.onChangeVideoTime,o=e.onDeleteKeyframe,i=Object.keys(a).map(function(e){return parseInt(e)});return r.a.createElement(R,{title:"Keyframes",subTitle:"",icon:r.a.createElement(Ve.a,{style:{color:C.a[700]}}),expandedByDefault:!0},i.map(function(e){return r.a.createElement(Ue,{fullWidth:!0,key:e,className:t===e?"current":"",onClick:function(){return n(e)}},r.a.createElement("div",{className:"time"},Fe(e,2),r.a.createElement("span",{className:"regionCount"},"(",(a[e].regions||[]).length,")")),r.a.createElement("div",{className:"trash"},r.a.createElement(ie.a,{onClick:function(t){o(e),t.stopPropagation()},className:"icon"})))}))},Je=a(228),qe=(Object(j.a)({shortcutKeyFieldWrapper:{paddingTop:8,display:"inline-flex",width:"100%"},shortcutKeyText:{lineHeight:0},shortcutTextfield:{width:"100%",boxSizing:"border-box",textAlign:"center"}}),a(261)),Ke=a(559),Xe=Object(W.a)("div")({"& > div":{width:"100%",height:"100%"}}),Ze=function(e){var t=e.children,a=Object(qe.a)(e,["children"]),n=Object(o.useState)(!1),i=Object(x.a)(n,2),c=i[0],l=i[1],s=Object(M.a)(function(e){c||l(!0),a.onMouseMove&&a.onMouseMove(e)}),u=Object(M.a)(function(e){setTimeout(function(){c&&l(!1)},100)});return r.a.createElement(Xe,Object.assign({},a,{onMouseMove:s,onMouseLeave:u}),r.a.createElement(Ke.a,{enabled:c,removeScrollBar:!1},t))},Qe=a(243),$e=a.n(Qe),et=function(e){var t=e.handlePreview,a=e.previewImages;return r.a.createElement(R,{title:"Review",icon:r.a.createElement($e.a,{style:{color:C.a[700]}}),expandedByDefault:!0},a.length>0&&r.a.createElement("table",{className:"w3-table"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"sl.No"),r.a.createElement("th",null,"Images"))),r.a.createElement("tbody",null,a.map(function(e,a){return r.a.createElement("tr",{onClick:function(){return t(e)}},r.a.createElement("td",null,a+1),r.a.createElement("td",{className:"w3-hover-grey"},e))}))))},tt=(Object(o.memo)(et),a(218),function(e){var t=e.allowed_metadata,a=e.metadata,n=e.onChange;return r.a.createElement(R,{title:"Meta Data",icon:r.a.createElement(D.a,{style:{color:C.a[700]}}),expandedByDefault:!0},r.a.createElement("label",null,"Climate"),r.a.createElement(De.a,{className:"w3-margin-bottom w3-margin-left w3-margin-right",placeholder:"Classification",onChange:function(e){return n(Object(w.a)({},a,{climate:e.value}))},value:a.climate?{label:a.climate,value:a.climate}:null,options:Object(We.asMutable)(t.climate.map(function(e){return{value:e,label:e}}))}),r.a.createElement("label",null,"Road"),r.a.createElement(De.a,{className:"w3-margin-bottom w3-margin-left w3-margin-right",placeholder:"Classification",onChange:function(e){return n(Object(w.a)({},a,{road:e.value}))},value:a.road?{label:a.road,value:a.road}:null,options:Object(We.asMutable)(t.road.map(function(e){return{value:e,label:e}}))}),r.a.createElement("label",null,"Time of Day"),r.a.createElement(De.a,{className:"w3-margin-bottom w3-margin-left w3-margin-right",placeholder:"Classification",onChange:function(e){return n(Object(w.a)({},a,{time_of_day:e.value}))},value:a.time_of_day?{label:a.time_of_day,value:a.time_of_day}:null,options:Object(We.asMutable)(t.time_of_day.map(function(e){return{value:e,label:e}}))}),r.a.createElement("label",null,"Area"),r.a.createElement(De.a,{className:"w3-margin-bottom w3-margin-left w3-margin-right",placeholder:"Classification",onChange:function(e){return n(Object(w.a)({},a,{area:e.value}))},value:a.area?{label:a.area,value:a.area}:null,options:Object(We.asMutable)(t.area.map(function(e){return{value:e,label:e}}))}),r.a.createElement("div",null,r.a.createElement("label",null,"Number of Lanes"),r.a.createElement("input",{className:"w3-button w3-border w3-margin-bottom",placeholder:"no. of Lanes",type:"number",onChange:function(e){return n(Object(w.a)({},a,{no_of_lanes:e.currentTarget.value}))}})),r.a.createElement("div",null,r.a.createElement("label",null,"Number of classes"),r.a.createElement("input",{className:"w3-button w3-border w3-margin-bottom ",placeholder:"no. of classes",type:"number",onChange:function(e){return n(Object(w.a)({},a,{no_of_classes:e.currentTarget.value}))}})))}),at=(Object(o.memo)(tt),Object(j.a)({})),nt=[],ot=function(e){var t=e.metadata,a=e.allowed_metadata,n=e.preview,o=e.previewList,i=e.debug,c=(e.taskDescription,e.keyframes),l=e.images,s=e.regions,u=e.history,m=e.labelImages,d=e.currentImage,g=e.currentVideoTime,h=e.imageClsList,p=e.imageTagList,f=e.onChangeMetadata,b=e.onChangeImage,v=e.onSelectRegion,E=e.onSelectImage,y=e.onChangeRegion,O=e.onDeleteRegion,w=e.onRestoreHistory,x=e.onChangeVideoTime,j=e.onDeleteKeyframe;e.onShortcutActionDispatched,at();return s||(s=nt),r.a.createElement("div",null,r.a.createElement(tt,{allowed_metadata:a,metadata:null===t?{climate:"None",road:"None",time_of_day:"None",area:"None",no_of_classes:0,no_of_lanes:0}:t,onChange:f}),r.a.createElement(et,{handlePreview:n,previewImages:o}),i&&r.a.createElement(Le,{state:i,lastAction:i.lastAction}),m&&r.a.createElement(ze,{currentImage:d,imageClsList:h,imageTagList:p,onChangeImage:b,expandedByDefault:!0}),l&&l.length>1&&r.a.createElement(Z,{onSelect:E,images:l}),r.a.createElement(je,{regions:s,onSelectRegion:v,onChangeRegion:y,onDeleteRegion:O}),r.a.createElement(Me,{history:u,onRestoreHistory:function(){return w()}}),c&&r.a.createElement(Ye,{currentVideoTime:g,keyframes:c,onChangeVideoTime:x,onDeleteKeyframe:j}))},rt=a(147),it=(a(444),function(e){var t=e.mousePosition,a=e.x,n=e.y,i=Object(o.useState)(),c=Object(x.a)(i,2),l=(c[0],c[1]);return t&&(a=t.current.x,n=t.current.y),Object(o.useEffect)(function(){if(t){var e=setInterval(function(){a===t.current.x&&n===t.current.y||l([t.current.x,t.current.y])},10);return function(){return clearInterval(e)}}}),r.a.createElement(o.Fragment,null,r.a.createElement("div",{style:{position:"absolute",height:"100%",width:1,zIndex:10,backgroundColor:"#f00",left:a,pointerEvents:"none",top:0}}),r.a.createElement("div",{style:{position:"absolute",width:"100%",zIndex:10,height:1,backgroundColor:"#f00",top:n,pointerEvents:"none",left:0}}))}),ct={regionInfo:{fontSize:12,cursor:"default",transition:"opacity 200ms",opacity:.7,"&:hover":{opacity:.9,cursor:"pointer"},"&.highlighted":{opacity:.9,"&:hover":{opacity:1}},fontWeight:600,color:C.a[900],padding:8,"& .name":{display:"flex",flexDirection:"row",alignItems:"center","& .circle":{marginRight:4,boxShadow:"0px 0px 2px rgba(0,0,0,0.4)",width:10,height:10,borderRadius:5}},"& .tags":{"& .tag":{color:C.a[700],display:"inline-block",margin:1,fontSize:10,textDecoration:"underline"}}}},lt=a(219),st=a(167),ut=a.n(st),mt=Object(j.a)(ct),dt=Object(o.memo)(function(e){var t=e.region,a=e.editing,n=e.allowedClasses,o=e.allowedTags,i=e.onDelete,c=e.onChange,l=e.onClose,s=e.onOpen,u=mt();return r.a.createElement(I.a,{onKeyPress:function(e){e.stopPropagation()},onKeyDown:function(e){e.stopPropagation()},onKeyUp:function(e){e.stopPropagation()},onClick:function(){return a?null:s(t)},className:A()(u.regionInfo,{highlighted:t.highlighted})},a?r.a.createElement("div",{style:{width:200}},r.a.createElement("div",{style:{display:"flex",flexDirection:"row"}},r.a.createElement("div",{style:{display:"flex",backgroundColor:t.color,color:"#fff",padding:4,paddingLeft:8,paddingRight:8,borderRadius:4,fontWeight:"bold",textShadow:"0px 0px 5px rgba(0,0,0,0.4)"}},t.type),r.a.createElement("div",{style:{flexGrow:1}}),r.a.createElement(S.a,{onClick:function(){return i(t)},tabIndex:-1,style:{width:22,height:22},size:"small",variant:"outlined"},r.a.createElement(ie.a,{style:{marginTop:-8,width:16,height:16}}))),(n||[]).length>0&&r.a.createElement("div",{style:{marginTop:6}},r.a.createElement(De.a,{placeholder:"Classification",onChange:function(e){return c(Object(w.a)({},t,{cls:e.value}))},value:t.cls?{label:t.cls,value:t.cls}:null,options:Object(We.asMutable)(n.map(function(e){return{value:e,label:e}}))})),(o||[]).length>0&&r.a.createElement("div",{style:{marginTop:4}},r.a.createElement(De.a,{onChange:function(e){return c(Object(w.a)({},t,{tags:e.map(function(e){return e.value})}))},placeholder:"Tags",value:(t.tags||[]).map(function(e){return{label:e,value:e}}),isMulti:!0,options:Object(We.asMutable)(o.map(function(e){return{value:e,label:e}}))})),r.a.createElement("div",{style:{marginTop:4,display:"flex"}},r.a.createElement("div",{style:{flexGrow:1}}),r.a.createElement(lt.a,{onClick:function(){return l(t)},size:"small",variant:"contained",color:"primary"},r.a.createElement(ut.a,null)))):r.a.createElement("div",null,t.cls&&r.a.createElement("div",{className:"name"},r.a.createElement("div",{className:"circle",style:{backgroundColor:t.color}}),t.cls),t.tags&&r.a.createElement("div",{className:"tags"},t.tags.map(function(e){return r.a.createElement("div",{key:e,className:"tag"},e)}))))},function(e,t){return e.editing===t.editing&&e.region.x===t.region.x&&e.region.y===t.region.y&&e.region.tags===t.region.tags&&e.region.cls===t.region.cls&&e.region.color===t.region.color&&e.region.highlighted===t.region.highlighted}),gt=Object(j.a)({"@keyframes borderDance":{from:{strokeDashoffset:0},to:{strokeDashoffset:100}},highlightBox:{zIndex:2,transition:"opacity 500ms","&.highlighted":{zIndex:3},"&:not(.highlighted)":{opacity:0},"&:not(.highlighted):hover":{opacity:.6},"& path":{vectorEffect:"non-scaling-stroke",strokeWidth:2,stroke:"#FFF",fill:"none",strokeDasharray:5,animationName:"$borderDance",animationDuration:"4s",animationTimingFunction:"linear",animationIterationCount:"infinite",animationPlayState:"running"}}}),ht=function(e){var t=e.mouseEvents,a=e.dragWithPrimary,n=e.zoomWithPrimary,o=e.createWithPrimary,i=e.onBeginMovePoint,c=e.onSelectRegion,l=e.region,s=e.pbox,u=gt();return r.a.createElement("svg",Object.assign({key:l.id,className:A()(u.highlightBox,{highlighted:l.highlighted})},t,n||a?{}:{onMouseDown:function(e){return!l.locked&&"point"===l.type&&l.highlighted&&0===e.button?i(l):0!==e.button||o?void t.onMouseDown(e):c(l)}},{style:Object(w.a)({},l.highlighted?{pointerEvents:"point"!==l.type?"none":void 0,cursor:"grab"}:{cursor:n||a||o?void 0:"pointer",pointerEvents:n||a||o&&!l.highlighted?"none":void 0},{position:"absolute",left:s.x-5,top:s.y-5,width:s.w+10,height:s.h+10})}),r.a.createElement("path",{d:"M5,5 L".concat(s.w+5,",5 L").concat(s.w+5,",").concat(s.h+5," L5,").concat(s.h+5," Z")}))},pt=a(562),ft=a(553),bt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1/0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,a="undefined"!==typeof window,n=Object(pt.a)({width:a?window.innerWidth:e,height:a?window.innerHeight:t}),r=Object(x.a)(n,2),i=r[0],c=r[1];return Object(o.useEffect)(function(){if(a){var e=function(){c({width:window.innerWidth,height:window.innerHeight})};return window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}}},[]),Object(ft.a)(function(){a&&(window.innerWidth===i.width&&window.innerHeight===i.height||c({width:window.innerWidth,height:window.innerHeight}))},100),i},vt=function(e){var t=e.canvasEl,a=e.changeMat,n=e.changeDragging,r=e.zoomStart,i=(e.zoomEnd,e.changeZoomStart),c=e.changeZoomEnd,l=e.layoutParams,s=e.zoomWithPrimary,u=e.dragWithPrimary,m=e.mat,d=e.onMouseMove,g=e.onMouseUp,h=e.onMouseDown,p=e.dragging,f=Object(o.useRef)({x:0,y:0}),b=Object(o.useRef)({x:0,y:0}),v=function(e,t){var n=[t.x,t.y],o=n[0],r=n[1],i="object"===typeof e?e.to/m.a:1+.2*e;m.translate(o,r).scaleU(i),m.a>2&&m.scaleU(2/m.a),m.a<.1&&m.scaleU(.1/m.a),m.translate(-o,-r),a(m.clone())};return{mouseEvents:{onMouseMove:function(e){var n=t.current.getBoundingClientRect(),o=n.left,i=n.top;b.current.x=f.current.x,b.current.y=f.current.y,f.current.x=e.clientX-o,f.current.y=e.clientY-i;var u=m.applyToPoint(f.current.x,f.current.y);s&&r&&c(u);var g=l.current,h=g.iw,v=g.ih;d({x:u.x/h,y:u.y/v}),p&&(m.translate(b.current.x-f.current.x,b.current.y-f.current.y),a(m.clone())),e.preventDefault()},onMouseDown:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e.preventDefault(),1===e.button||0===e.button&&u)return n(!0);var a=m.applyToPoint(f.current.x,f.current.y);if(s&&0===e.button)return i(a),void c(a);if(0===e.button){t.type,t.type;var o=l.current,r=o.iw,d=o.ih;h({x:a.x/r,y:a.y/d})}},onMouseUp:function(e){e.preventDefault();var t=m.applyToPoint(f.current.x,f.current.y);if(r){var o=t;if(Math.abs(r.x-o.x)<10&&Math.abs(r.y-o.y)<10)m.a<1?v({to:1},f.current):v({to:.25},f.current);else{var s=l.current,d=s.iw,h=s.ih;if(r.x>o.x){var p=[o.x,r.x];r.x=p[0],o.x=p[1]}if(r.y>o.y){var b=[o.y,r.y];r.y=b[0],o.y=b[1]}var E=Math.min((o.x-r.x)/d,(o.y-r.y)/h);E<.1&&(E=.1),E>10&&(E=10);var y=rt.Matrix.from(1,0,0,1,-10,-10).translate(r.x,r.y).scaleU(E);a(y.clone())}i(null),c(null)}if(1===e.button||0===e.button&&u)return n(!1);if(0===e.button){var O=l.current,w=O.iw,x=O.ih;g({x:t.x/w,y:t.y/x})}},onWheel:function(e){var t=e.deltaY>0?1:e.deltaY<0?-1:0;v(t,f.current)}},mousePosition:f}},Et=function(e){var t=e.layoutParams,a=e.mat;return Object(M.a)(function(e){var n=t.current,o=n.iw,r=n.ih,i=function(e){switch(e.type){case"polygon":var t={x:Math.min.apply(Math,Object(v.a)(e.points.map(function(e){var t=Object(x.a)(e,2),a=t[0];return t[1],a}))),y:Math.min.apply(Math,Object(v.a)(e.points.map(function(e){var t=Object(x.a)(e,2);return t[0],t[1]}))),w:0,h:0};return t.w=Math.max.apply(Math,Object(v.a)(e.points.map(function(e){var t=Object(x.a)(e,2),a=t[0];return t[1],a})))-t.x,t.h=Math.max.apply(Math,Object(v.a)(e.points.map(function(e){var t=Object(x.a)(e,2);return t[0],t[1]})))-t.y,t;case"box":return{x:e.x,y:e.y,w:e.w,h:e.h};case"point":return{x:e.x,y:e.y,w:0,h:0};case"pixel":if(void 0!==e.sx&&void 0!==e.sy&&e.w&&e.h)return{x:e.sx,y:e.sy,w:e.w,h:e.h};if(e.points){var a={x:Math.min.apply(Math,Object(v.a)(e.points.map(function(e){var t=Object(x.a)(e,2),a=t[0];return t[1],a}))),y:Math.min.apply(Math,Object(v.a)(e.points.map(function(e){var t=Object(x.a)(e,2);return t[0],t[1]}))),w:0,h:0};return a.w=Math.max.apply(Math,Object(v.a)(e.points.map(function(e){var t=Object(x.a)(e,2),a=t[0];return t[1],a})))-a.x,a.h=Math.max.apply(Math,Object(v.a)(e.points.map(function(e){var t=Object(x.a)(e,2);return t[0],t[1]})))-a.y,a}}throw new Error("unknown region")}(e),c="point"===e.type?15:2,l={x:i.x*o-c,y:i.y*r-c,w:i.w*o+2*c,h:i.h*r+2*c};return Object(w.a)({},a.clone().inverse().applyToPoint(l.x,l.y),{w:l.w/a.a,h:l.h/a.d})})},yt=Object(W.a)("svg")({pointerEvents:"none",position:"absolute",zIndex:1,left:0,top:0,width:"100%",height:"100%","& text":{fill:"#fff"},"& path":{vectorEffect:"non-scaling-stroke",strokeWidth:2,opacity:.5,stroke:"#FFF",fill:"none",strokeDasharray:5,animationDuration:"4s",animationTimingFunction:"linear",animationIterationCount:"infinite",animationPlayState:"running"}}),Ot=function(e){var t=e.projectRegionBox,a=e.regions,n=e.pointDistancePrecision,i=e.realSize;return r.a.createElement(yt,null,a.filter(function(e){return"point"===e.type}).flatMap(function(e,c){return a.filter(function(e,t){return t>c}).filter(function(e){return"point"===e.type}).map(function(a){var c,l=t(e),s=t(a),u={x:(l.x+l.w/2+s.x+s.w/2)/2,y:(l.y+l.h/2+s.y+s.h/2)/2};if(i){var m=i.w,d=i.h,g=i.unitName;c=Math.sqrt(Math.pow(e.x*m-a.x*m,2)+Math.pow(e.y*d-a.y*d,2)).toFixed(n)+g}else c=(100*Math.sqrt(Math.pow(e.x-a.x,2)+Math.pow(e.y-a.y,2))).toFixed(n)+"%";return r.a.createElement(o.Fragment,null,r.a.createElement("path",{d:"M".concat(l.x+l.w/2,",").concat(l.y+l.h/2," L").concat(s.x+s.w/2,",").concat(s.y+s.h/2)}),r.a.createElement("text",{x:u.x,y:u.y},c))})}))},wt=function(e){var t=e.regions,a=e.projectRegionBox,n=e.mouseEvents,o=e.regionClsList,i=e.regionTagList,c=e.onBeginRegionEdit,l=e.onChangeRegion,s=e.onCloseRegionEdit,u=e.onDeleteRegion,m=e.layoutParams,d=e.imageSrc,g=e.RegionEditLabel,h=null!=g?g:dt;return t.filter(function(e){return e.visible||void 0===e.visible}).map(function(e){var g=a(e),p=m.current,f=(p.iw,p.ih,8);e.highlighted&&"box"===e.type&&(f+=6);var b=e.editingLabels&&!e.locked?170:e.tags?60:50,v=g.y>b,E=v?{left:g.x,top:g.y-f/2}:{left:g.x,top:g.y+g.h+f/2};return e.locked?r.a.createElement("div",{key:e.id,style:Object(w.a)({position:"absolute"},E,{zIndex:10+(e.editingLabels?5:0)})},r.a.createElement(I.a,{style:Object(w.a)({position:"absolute",left:0},v?{bottom:0}:{top:0},{zIndex:10,backgroundColor:"#fff",borderRadius:4,padding:2,paddingBottom:0,opacity:.5,pointerEvents:"none"})},r.a.createElement(le.a,{style:{width:16,height:16,color:"#333"}}))):r.a.createElement("div",{key:e.id,style:Object(w.a)({position:"absolute"},E,{zIndex:10+(e.editingLabels?5:0),width:200}),onMouseDown:function(e){return e.preventDefault()},onMouseUp:function(e){return e.preventDefault()},onMouseEnter:function(t){e.editingLabels&&(n.onMouseUp(t),t.button=1,n.onMouseUp(t))}},r.a.createElement("div",Object.assign({style:Object(w.a)({position:"absolute",left:0},v?{bottom:0}:{top:0})},e.editingLabels?{}:function(e){for(var t=Object(w.a)({},e),a=arguments.length,n=new Array(a>1?a-1:0),o=1;o<a;o++)n[o-1]=arguments[o];for(var r=0,i=n;r<i.length;r++)delete t[i[r]];return t}(n,"onMouseDown","onMouseUp")),r.a.createElement(h,{allowedClasses:o,allowedTags:i,onOpen:c,onChange:l,onClose:s,onDelete:u,editing:e.editingLabels,region:e,regions:t,imageSrc:d})))})},xt=Object(W.a)("div")({width:8,height:8,zIndex:2,border:"2px solid #FFF",position:"absolute"}),jt=[["nw-resize","n-resize","ne-resize"],["w-resize","grab","e-resize"],["sw-resize","s-resize","se-resize"]],It=function(e){var t=e.regions,a=e.mouseEvents,n=e.projectRegionBox,i=e.dragWithPrimary,c=e.createWithPrimary,l=e.zoomWithPrimary,s=e.onBeginMovePoint,u=e.onSelectRegion,m=e.layoutParams,d=e.mat,g=e.onBeginBoxTransform,h=e.onBeginMovePolygonPoint,p=e.onAddPolygonPoint;return t.filter(function(e){return e.visible||void 0===e.visible}).filter(function(e){return!e.locked}).map(function(e,t){var f=n(e),b=m.current,v=b.iw,E=b.ih;return r.a.createElement(o.Fragment,{key:e.id},r.a.createElement(Ze,null,r.a.createElement(ht,{region:e,mouseEvents:a,dragWithPrimary:i,createWithPrimary:c,zoomWithPrimary:l,onBeginMovePoint:s,onSelectRegion:u,pbox:f}),"box"===e.type&&!i&&!l&&!e.locked&&e.highlighted&&d.a<1.2&&[[0,0],[.5,0],[1,0],[1,.5],[1,1],[.5,1],[0,1],[0,.5],[.5,.5]].map(function(t,n){var o=Object(x.a)(t,2),i=o[0],c=o[1];return r.a.createElement(xt,Object.assign({key:n},a,{onMouseDown:function(t){if(0===t.button)return g(e,[2*i-1,2*c-1]);a.onMouseDown(t)},style:{left:f.x-4-2+f.w*i,top:f.y-4-2+f.h*c,cursor:jt[2*c][2*i],borderRadius:.5===i&&.5===c?4:void 0}}))}),"polygon"===e.type&&!i&&!l&&!e.locked&&e.highlighted&&e.points.map(function(t,n){var o=Object(x.a)(t,2),i=o[0],c=o[1],l=d.clone().inverse().applyToPoint(i*v,c*E);return r.a.createElement(xt,Object.assign({key:n},a,{onMouseDown:function(t){if(0===t.button&&(!e.open||0===n))return h(e,n);a.onMouseDown(t)},style:{cursor:e.open?0===n?"pointer":void 0:"move",pointerEvents:e.open&&n===e.points.length-1?"none":void 0,left:l.x-4,top:l.y-4}}))}),"polygon"===e.type&&e.highlighted&&!i&&!l&&!e.locked&&!e.open&&e.points.length>1&&e.points.map(function(t,a){return[t,e.points[(a+1)%e.points.length]]}).map(function(e){var t=Object(x.a)(e,2),a=t[0],n=t[1];return[(a[0]+n[0])/2,(a[1]+n[1])/2]}).map(function(t,n){var o=d.clone().inverse().applyToPoint(t[0]*v,t[1]*E);return r.a.createElement(xt,Object.assign({key:n},a,{onMouseDown:function(o){if(0===o.button)return p(e,t,n+1);a.onMouseDown(o)},style:{cursor:"copy",left:o.x-4,top:o.y-4,border:"2px dotted #fff",opacity:.5}}))})))})},_t=a(64),Nt=Object(o.createContext)({showCrosshairs:!1}),St=function(){return Object(o.useContext)(Nt)},Tt=function(e){var t=e.children,a=Object(o.useState)(function(){return function(){if(!window||!window.localStorage)return{};for(var e={},t=0;t<window.localStorage.length;t++){var a=window.localStorage.key(t);if(a.startsWith("settings_"))try{e[a.replace("settings_","")]=JSON.parse(window.localStorage.getItem(a))}catch(n){}}return e}()}),n=Object(x.a)(a,2),i=n[0],c=n[1];return r.a.createElement(Nt.Provider,{value:Object(w.a)({},i,{changeSetting:function(e,t){c(Object(w.a)({},i,Object(_t.a)({},e,t))),window.localStorage.setItem("settings_".concat(e),JSON.stringify(t))}})},t)},Ct=Object(W.a)("video")({zIndex:0,position:"absolute"}),kt=Object(W.a)("img")({zIndex:0,position:"absolute"}),At=function(e){var t=e.imagePosition,a=e.mouseEvents,n=e.videoTime,i=e.videoSrc,c=e.imageSrc,l=e.onLoad,s=e.videoPlaying,u=e.onChangeVideoTime,m=e.onChangeVideoPlaying,d=St(),g=Object(o.useRef)(),h=Object(o.useRef)();Object(o.useEffect)(function(){!s&&g.current&&(g.current.currentTime=(n||0)/1e3)},[n]),Object(o.useEffect)(function(){var e=!1;return g.current&&(s?(g.current.play(),e=!0,d.videoPlaybackSpeed&&(g.current.playbackRate=parseFloat(d.videoPlaybackSpeed))):g.current.pause()),function t(){if(e&&g.current){var a=Math.floor(1e3*g.current.currentTime);n!==a&&u(a),g.current.paused&&(e=!1,m(!1)),requestAnimationFrame(t)}}(),function(){e=!1}},[s]);var p=Object(M.a)(function(e){var t=e.currentTarget;t.currentTime=(n||0)/1e3,l&&l({naturalWidth:t.videoWidth,naturalHeight:t.videoHeight,videoElm:t,duration:t.duration})}),f=Object(M.a)(function(e){var t=e.currentTarget;l&&l({naturalWidth:t.naturalWidth,naturalHeight:t.naturalHeight,imageElm:t})}),b=Object(o.useMemo)(function(){var e=t.bottomRight.x-t.topLeft.x,a=t.bottomRight.y-t.topLeft.y;return{left:t.topLeft.x,top:t.topLeft.y,width:isNaN(e)?0:e,height:isNaN(a)?0:a}},[t.topLeft.x,t.topLeft.y,t.bottomRight.x,t.bottomRight.y]);return i||c?c&&void 0===n?r.a.createElement(kt,Object.assign({},a,{src:c,ref:h,style:b,onLoad:f})):r.a.createElement(Ct,Object.assign({},a,{ref:g,style:b,onLoadedMetadata:p,src:i||c})):"No imageSrc or videoSrc provided"},Mt=Object(j.a)({canvas:{width:"100%",height:"100%",position:"relative",zIndex:1},zoomIndicator:{position:"absolute",bottom:16,right:0,backgroundColor:"rgba(0,0,0,0.4)",color:"#fff",opacity:.5,fontWeight:"bolder",fontSize:14,padding:4}}),Lt=function(e){var t=e.regions,a=e.imageSrc,n=e.videoSrc,i=e.videoTime,c=e.realSize,l=e.showTags,s=e.onMouseMove,u=void 0===s?function(e){return null}:s,m=e.onMouseDown,d=void 0===m?function(e){return null}:m,g=e.onMouseUp,h=void 0===g?function(e){return null}:g,p=e.dragWithPrimary,f=void 0!==p&&p,b=e.zoomWithPrimary,E=void 0!==b&&b,y=e.createWithPrimary,O=void 0!==y&&y,j=e.pointDistancePrecision,I=void 0===j?0:j,_=e.regionClsList,N=e.regionTagList,S=e.showCrosshairs,T=e.showPointDistances,C=e.allowedArea,k=e.RegionEditLabel,A=void 0===k?null:k,L=e.videoPlaying,R=void 0!==L&&L,P=e.onImageOrVideoLoaded,D=e.onChangeRegion,W=e.onBeginRegionEdit,B=e.onCloseRegionEdit,G=e.onBeginBoxTransform,z=e.onBeginMovePolygonPoint,H=e.onAddPolygonPoint,V=e.onSelectRegion,F=e.onBeginMovePoint,U=e.onDeleteRegion,Y=e.onChangeVideoTime,J=e.onChangeVideoPlaying,q=Mt(),K=Object(o.useRef)(null),X=Object(o.useRef)({}),Z=Object(pt.a)(!1),Q=Object(x.a)(Z,2),$=Q[0],ee=Q[1],te=Object(pt.a)(0),ae=Object(x.a)(te,2),ne=ae[0],oe=ae[1],re=Object(pt.a)(null),ie=Object(x.a)(re,2),ce=ie[0],le=ie[1],se=Object(pt.a)(null),ue=Object(x.a)(se,2),me=ue[0],de=ue[1],ge=Object(pt.a)(rt.Matrix.from(1,0,0,1,-10,-10)),he=Object(x.a)(ge,2),pe=he[0],fe=he[1],be=Object(o.useRef)({}),ve=bt(),Ee=vt({canvasEl:K,dragging:$,mat:pe,layoutParams:X,changeMat:fe,zoomStart:ce,zoomEnd:me,changeZoomStart:le,changeZoomEnd:de,changeDragging:ee,zoomWithPrimary:E,dragWithPrimary:f,onMouseMove:u,onMouseDown:d,onMouseUp:h}),ye=Ee.mouseEvents,Oe=Ee.mousePosition;Object(o.useLayoutEffect)(function(){return fe(pe.clone())},[ve]);pe.applyToPoint(Oe.current.x,Oe.current.y);var we=Et({layoutParams:X,mat:pe}),xe=Object(o.useState)(),je=Object(x.a)(xe,2),Ie=je[0],_e=je[1],Ne=Boolean(Ie&&Ie.naturalWidth),Se=Object(M.a)(function(e){var t={naturalWidth:e.naturalWidth,naturalHeight:e.naturalHeight,duration:e.duration};P&&P(t),_e(t),setTimeout(function(){return _e(t)},10)}),Te=function(){var e=Object(o.useRef)(null);if(null===e.current){e.current={image:new Image,pattern:null};var t=document.createElement("canvas");t.width=100,t.height=100;var a=t.getContext("2d");e.current.image.onload=function(){e.current.pattern=a.createPattern(e.current.image,"repeat")},e.current.image.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAC4jAAAuIwF4pT92AAAAB3RJTUUH4wMSAxY5oG+lzgAAABl0RVh0Q29tbWVudABDcmVhdGVkIHdpdGggR0lNUFeBDhcAAAAcSURBVAjXY/jPwPCfAQnA+TAGugLcAhhakRUAAK3lEe8m9qZhAAAAAElFTkSuQmCC"}return e.current.pattern}(),Ce=K.current;if(Ce&&Ne){var ke=Ce.clientWidth,Ae=Ce.clientHeight,Me=Math.max(Ie.naturalWidth/(ke-20),Ie.naturalHeight/(Ae-20)),Le=Ie.naturalWidth/Me,Re=Ie.naturalHeight/Me;X.current={iw:Le,ih:Re,fitScale:Me,canvasWidth:ke,canvasHeight:Ae}}Object(o.useLayoutEffect)(function(){if(Ie){var e=Ce.clientWidth,a=Ce.clientHeight;Ce.width=e,Ce.height=a;var n=Ce.getContext("2d");n.save(),n.transform.apply(n,Object(v.a)(pe.clone().inverse().toArray()));var o=X.current,r=o.iw,i=o.ih;if(C){var c=C.x,l=C.y,s=C.w,u=C.h;n.save(),n.globalAlpha=.25;var m=[[0,0],[r,0],[r,i],[0,i]],d=[[c*r,l*i],[c*r+s*r,l*i],[c*r+s*r,l*i+u*i],[c*r,l*i+u*i]];n.moveTo.apply(n,Object(v.a)(m[0])),m.forEach(function(e){return n.lineTo.apply(n,Object(v.a)(e))}),n.lineTo.apply(n,Object(v.a)(m[0])),n.closePath(),d.reverse(),n.moveTo.apply(n,Object(v.a)(d[0])),d.forEach(function(e){return n.lineTo.apply(n,Object(v.a)(e))}),n.lineTo.apply(n,Object(v.a)(d[0])),n.fillStyle=Te||"#f00",n.fill(),n.restore()}n.save(),n.globalAlpha=.5*pe.a+.5,n.lineWidth=1*pe.a+1,n.globalAlpha>.6&&(n.shadowColor="black",n.shadowBlur=4);var g=!0,h=!1,p=void 0;try{for(var f,b=function(){var e=f.value;switch(e.type){case"point":n.save(),n.beginPath(),n.strokeStyle=e.color,n.moveTo(e.x*r-10,e.y*i),n.lineTo(e.x*r-2,e.y*i),n.moveTo(e.x*r+10,e.y*i),n.lineTo(e.x*r+2,e.y*i),n.moveTo(e.x*r,e.y*i-10),n.lineTo(e.x*r,e.y*i-2),n.moveTo(e.x*r,e.y*i+10),n.lineTo(e.x*r,e.y*i+2),n.moveTo(e.x*r+5,e.y*i),n.arc(e.x*r,e.y*i,5,0,2*Math.PI),n.stroke(),n.restore();break;case"box":n.save(),n.shadowColor="black",n.shadowBlur=4,n.strokeStyle=e.color,n.strokeRect(e.x*r,e.y*i,e.w*r,e.h*i),n.restore();break;case"polygon":n.save(),n.shadowColor="black",n.shadowBlur=4,n.strokeStyle=e.color,n.beginPath(),n.moveTo(e.points[0][0]*r,e.points[0][1]*i);var t=!0,a=!1,o=void 0;try{for(var c,l=e.points[Symbol.iterator]();!(t=(c=l.next()).done);t=!0){var s=c.value;n.lineTo(s[0]*r,s[1]*i)}}catch(u){a=!0,o=u}finally{try{t||null==l.return||l.return()}finally{if(a)throw o}}e.open||n.closePath(),n.stroke(),n.restore();break;case"pixel":n.save(),be.current[e.src]?"CANVAS"===be.current[e.src].nodeName&&(n.globalAlpha=.6,n.drawImage(be.current[e.src],e.sx*r,e.sy*i,e.w*r,e.h*i)):(be.current[e.src]=new Image,be.current[e.src].onload=function(){var t=be.current[e.src],a=document.createElement("canvas");a.width=t.naturalWidth,a.height=t.naturalHeight;var n=a.getContext("2d");n.drawImage(t,0,0);for(var o=n.getImageData(0,0,t.naturalWidth,t.naturalHeight),r=0;r<o.data.length;r+=4){var i=o.data.slice(r,r+4),c=Object(x.a)(i,4),l=c[0],s=c[1],u=c[2],m=(c[3],l<10&&s<10&&u<10);o.data[r]=0,o.data[r+1]=0,o.data[r+2]=m?255:0,o.data[r+3]=m?255:0}n.clearRect(0,0,t.naturalWidth,t.naturalHeight),n.putImageData(o,0,0),be.current[e.src]=a,oe(ne+1)},be.current[e.src].src=e.src),n.restore()}},E=t.filter(function(e){return e.visible||void 0===e.visible})[Symbol.iterator]();!(g=(f=E.next()).done);g=!0)b()}catch(y){h=!0,p=y}finally{try{g||null==E.return||E.return()}finally{if(h)throw p}}n.restore(),n.restore()}});var Pe=X.current,De=Pe.iw,We=Pe.ih,Be=ce&&me?Object(w.a)({},pe.clone().inverse().applyToPoint(ce.x,ce.y),{w:(me.x-ce.x)/pe.a,h:(me.y-ce.y)/pe.d}):null;Be&&(Be.w<0&&(Be.x+=Be.w,Be.w*=-1),Be.h<0&&(Be.y+=Be.h,Be.h*=-1));var Ge={topLeft:pe.clone().inverse().applyToPoint(0,0),bottomRight:pe.clone().inverse().applyToPoint(De,We)};return r.a.createElement("div",{style:{width:"100%",height:"100%",maxHeight:"calc(100vh - 68px)",position:"relative",overflow:"hidden",cursor:O?"crosshair":$?"grabbing":f?"grab":E?pe.a<1?"zoom-out":"zoom-in":void 0}},S&&r.a.createElement(it,{key:"crossHairs",mousePosition:Oe}),Ne&&r.a.createElement(It,{key:"regionSelectAndTransformBoxes",regions:t,mouseEvents:ye,projectRegionBox:we,dragWithPrimary:f,createWithPrimary:O,zoomWithPrimary:E,onBeginMovePoint:F,onSelectRegion:V,layoutParams:X,mat:pe,onBeginBoxTransform:G,onBeginMovePolygonPoint:z,onAddPolygonPoint:H}),Ne&&l&&r.a.createElement(Ze,{key:"regionTags"},r.a.createElement(wt,{regions:t,projectRegionBox:we,mouseEvents:ye,regionClsList:_,regionTagList:N,onBeginRegionEdit:W,onChangeRegion:D,onCloseRegionEdit:B,onDeleteRegion:U,layoutParams:X,imageSrc:a,RegionEditLabel:A})),E&&null!==Be&&r.a.createElement("div",{key:"zoomBox",style:{position:"absolute",zIndex:1,border:"1px solid #fff",pointerEvents:"none",left:Be.x,top:Be.y,width:Be.w,height:Be.h}}),T&&r.a.createElement(Ot,{key:"pointDistances",regions:t,realSize:c,projectRegionBox:we,pointDistancePrecision:I}),r.a.createElement(Ze,Object.assign({style:{width:"100%",height:"100%"}},ye),r.a.createElement(r.a.Fragment,null,r.a.createElement("canvas",{className:q.canvas,ref:K}),r.a.createElement(At,{videoPlaying:R,imagePosition:Ge,mouseEvents:ye,onLoad:Se,videoTime:i,videoSrc:n,imageSrc:a,onChangeVideoTime:Y,onChangeVideoPlaying:J}))),r.a.createElement("div",{className:q.zoomIndicator},(1/pe.a*100).toFixed(0),"%"))},Rt=Object(W.a)(lt.a)({width:80,margin:2}),Pt=Object(W.a)("div")({fontWeight:"bold"}),Dt=Object(o.createContext)(),Wt=Object(o.memo)(function(e){var t=e.name,a=e.disabled,n=e.Icon,o=e.onClick;return r.a.createElement(Rt,{disabled:a,onClick:o},r.a.createElement("div",null,r.a.createElement(n,null),r.a.createElement(Pt,null,t)))},function(e,t){return e.name===t.name&&e.disabled===t.disabled}),Bt=function(e){var t=e.name,a=e.disabled,n=e.Icon,i=Object(o.useContext)(Dt).onHeaderButtonClick,c=Object(M.a)(function(){return i(t)});return r.a.createElement(Wt,{name:t,disabled:a,Icon:n,onClick:c})},Gt=a(148),zt=a.n(Gt),Ht=a(149),Vt=a.n(Ht),Ft=a(246),Ut=a.n(Ft),Yt=a(247),Jt=a.n(Yt),qt=a(249),Kt=a.n(qt),Xt=a(172),Zt=a.n(Xt),Qt=a(245),$t=a.n(Qt),ea=a(248),ta=a.n(ea),aa={header:{display:"flex",position:"relative",flexDirection:"row",flexShrink:0,zIndex:10,boxShadow:"0px 3px 8px rgba(0,0,0,.1)"},fileInfo:{alignItems:"center",flexGrow:1,"&.videoMode":{flexMode:.1},display:"flex",fontWeight:"bold",color:C.a[800],marginRight:16,fontSize:24,paddingLeft:16}},na=a(170),oa=a.n(na),ra=a(108),ia=a(244),ca=Object(W.a)("div")({position:"relative",display:"flex",flexGrow:1,minWidth:240,marginLeft:16,marginRight:16}),la=Object(W.a)("div")({position:"absolute",width:2,marginLeft:-1,height:"100%",backgroundColor:C.a[300],bottom:0}),sa=Object(W.a)("div")({position:"absolute",userSelect:"none",fontSize:10,color:C.a[600],fontWeight:"bold",bottom:0}),ua=Object(W.a)("div")({position:"absolute",bottom:"calc(50% + 6px)",fontSize:10,fontWeight:"bold",color:"#fff",display:"grid",placeItems:"center",width:48,marginLeft:-24,borderRadius:2,height:24,backgroundColor:pe.a[500],userSelect:"none",fontVariantNumeric:"tabular-nums","&::before":{position:"absolute",bottom:-6,left:16,content:'""',width:0,height:0,borderTop:"8px solid ".concat(pe.a[500]),borderLeft:"8px solid transparent",borderRight:"8px solid transparent"}}),ma=Object(W.a)("div")((n={position:"absolute",bottom:8,cursor:"pointer",opacity:.75,fontSize:10,fontWeight:"bold",color:"#fff",display:"grid",placeItems:"center",width:16,marginLeft:0,borderTopLeftRadius:2,borderTopRightRadius:2,height:12},Object(_t.a)(n,"marginLeft",-8),Object(_t.a)(n,"backgroundColor",ra.a[500]),Object(_t.a)(n,"userSelect","none"),Object(_t.a)(n,"fontVariantNumeric","tabular-nums"),Object(_t.a)(n,"&::before",{position:"absolute",bottom:-8,left:0,content:'""',width:0,height:0,borderTop:"8px solid ".concat(ra.a[500]),borderLeft:"8px solid transparent",borderRight:"8px solid transparent"}),n)),da=[[50,250],[100,500],[250,1e3],[1e3,5e3],[5e3,3e4],[1e4,6e4],[3e4,12e4],[6e4,3e5],[3e5,18e5],[6e5,36e5],[18e5,108e5],[36e5,18e6]],ga=function(e){var t=e.currentTime,a=void 0===t?0:t,n=e.duration,i=e.onChangeCurrentTime,c=e.keyframes,l=Object(ia.a)(),s=Object(x.a)(l,2),u=s[0],m=s[1],d=Object(o.useState)(a),g=Object(x.a)(d,2),h=g[0],p=g[1],f=Object(pt.a)(!1),b=Object(x.a)(f,2),v=b[0],E=b[1],y=Object.keys(c||{}).map(function(e){return parseInt(e)}).filter(function(e){return!isNaN(e)}).sort(function(e,t){return e-t});Object(o.useEffect)(function(){a!==h&&p(a)},[a]);var O=Object(o.useMemo)(function(){return function(e){var t=!0,a=!1,n=void 0;try{for(var o,r=da[Symbol.iterator]();!(t=(o=r.next()).done);t=!0){var i=o.value,c=Object(x.a)(i,2),l=c[0],s=c[1];if(e/s<6&&e/s>2)return[l,s]}}catch(u){a=!0,n=u}finally{try{t||null==r.return||r.return()}finally{if(a)throw n}}return[e/4,e]}(n)},[n]),w=Object(x.a)(O,2),j=w[0],I=w[1],_=Object(M.a)(function(e){if(v){var t=(e.clientX-m.left)/m.width;p(Math.min(n,Math.max(0,Math.floor(t*n))))}}),N=Object(M.a)(function(e){E(!1);var t=(e.clientX-m.left)/m.width,a=Math.min(n,Math.max(0,Math.floor(t*n)));p(a),i(a)});return n?r.a.createElement(ca,{onMouseMove:_,onMouseUp:N,ref:u},oa()(0,n,I).map(function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement(la,{key:e,style:{left:e/n*m.width,height:"50%"}}),r.a.createElement(sa,{style:{left:e/n*m.width+8,bottom:"calc(50% - 12px)"}},Fe(e)))}),oa()(0,n,j).filter(function(e){return!Number.isInteger(e/I)}).map(function(e){return r.a.createElement(la,{key:e,style:{left:e/n*m.width,height:"25%"}})}),y.map(function(e){return r.a.createElement(ma,{onClick:function(){return i(e)},key:e,style:{left:e/n*m.width}})}),r.a.createElement(ua,{onMouseDown:function(e){return E(!0)},style:{cursor:v?"grabbing":"grab",left:h/n*m.width}},Fe(h))):null},ha=a(250),pa=a.n(ha),fa=Object(j.a)(aa),ba=function(e){var t=e.state,a=e.onHeaderButtonClick,n=e.title,o=e.inFullScreen,i=e.videoMode,c=(e.isAVideoFrame,e.nextVideoFrameHasRegions),l=void 0!==c&&c,s=e.videoDuration,u=e.currentVideoTime,m=e.multipleImages,d=e.videoPlaying,g=e.onChangeCurrentTime,h=e.keyframes,p=e.alwaysShowPrevButton,f=e.alwaysShowNextButton,b=fa();return r.a.createElement("div",{className:b.header},r.a.createElement("div",{className:A()(b.fileInfo,i&&"videoMode")},n),r.a.createElement("div",{className:A()(b.fileInfo,i&&"videoMode")},"Mode: ","object_detection"===t.annotatemode?"Object Detection":"Segmentation"),i&&r.a.createElement(ga,{key:"keyframeTimeline",currentTime:u,duration:s,onChangeCurrentTime:g,keyframes:h}),r.a.createElement("div",{className:b.headerActions},r.a.createElement(Dt.Provider,{value:{onHeaderButtonClick:a}},(m||p)&&r.a.createElement(Bt,{name:"Prev",Icon:zt.a}),(m||f)&&r.a.createElement(r.a.Fragment,null,r.a.createElement(Bt,{name:"Next",Icon:Vt.a}),r.a.createElement(Bt,{name:"Clone",disabled:l,Icon:$t.a})),i&&r.a.createElement(r.a.Fragment,null,d?r.a.createElement(Bt,{key:"pause",name:"Pause",Icon:Jt.a}):r.a.createElement(Bt,{key:"play",name:"Play",Icon:Ut.a})),r.a.createElement(Bt,{name:"object_detection"===t.annotatemode?"SEGMENTATION":"OBJECT DETECTION",Icon:ta.a}),t.curr_image_index>0&&r.a.createElement(Bt,{name:"prev image",Icon:zt.a}),r.a.createElement(Bt,{name:"next image",Icon:Vt.a}),r.a.createElement(Bt,{name:"Settings",Icon:Kt.a}),o?r.a.createElement(Bt,{name:"Window",Icon:Zt.a}):r.a.createElement(Bt,{name:"Fullscreen",Icon:Zt.a}),r.a.createElement(Bt,{name:"Review",Icon:pa.a}))))},va=a(80),Ea=a(81),ya=a(565),Oa=Object(o.createContext)(),wa=Object(o.memo)(function(e){var t=e.id,a=e.name,n=e.icon,i=e.selected,c=e.togglable,l=e.alwaysShowing,s=void 0!==l&&l,u=Object(o.useContext)(Oa),m=u.enabledTools,d=u.selectedTool,g=u.onClickTool;return m.includes(t)||s?(i=i||d===t,r.a.createElement(ya.a,{placement:"right",title:a},r.a.createElement("div",null,r.a.createElement(S.a,{disabled:c?void 0:i,"aria-label":a,onClick:function(){return g(t)},size:"small",style:{width:50,height:50,margin:1,color:i?pe.a[500]:void 0}},n)))):null},function(e,t){return e.togglable===t.togglable&&e.selected===t.selected&&e.name===t.name&&e.id===t.id}),xa=Object(j.a)({iconTools:{display:"flex",padding:4,flexDirection:"column",zIndex:9,boxShadow:"0px 0px 5px rgba(0,0,0,0.1)",borderRight:"1px solid ".concat(C.a[300]),backgroundColor:C.a[100]}}),ja=["select","create-point","create-box","create-polygon"],Ia=function(e){var t=e.showTags,a=e.selectedTool,n=e.onClickTool,i=e.enabledTools,c=void 0===i?ja:i,l=xa(),s=Object(o.useMemo)(function(){return{enabledTools:c,selectedTool:a,onClickTool:n}},[c,a]);return r.a.createElement("div",{className:l.iconTools},r.a.createElement(Oa.Provider,{value:s},r.a.createElement(wa,{id:"select",name:"Select Region",icon:r.a.createElement(va.a,{size:"xs",fixedWidth:!0,icon:Ea.d})}),r.a.createElement(wa,{alwaysShowing:!0,id:"pan",name:"Drag/Pan",icon:r.a.createElement(va.a,{size:"xs",fixedWidth:!0,icon:Ea.c})}),r.a.createElement(wa,{alwaysShowing:!0,id:"zoom",name:"Zoom In/Out",icon:r.a.createElement(va.a,{size:"xs",fixedWidth:!0,icon:Ea.f})}),r.a.createElement(wa,{alwaysShowing:!0,togglable:!0,id:"show-tags",selected:t,name:"Show Tags",icon:r.a.createElement(va.a,{size:"xs",fixedWidth:!0,icon:Ea.g})}),r.a.createElement(wa,{id:"create-point",name:"Add Point",icon:r.a.createElement(va.a,{size:"xs",fixedWidth:!0,icon:Ea.a})}),r.a.createElement(wa,{id:"create-box",name:"Add Bounding Box",icon:r.a.createElement(va.a,{size:"xs",fixedWidth:!0,icon:Ea.h})}),r.a.createElement(wa,{id:"create-polygon",name:"Add Polygon",icon:r.a.createElement(va.a,{size:"xs",fixedWidth:!0,icon:Ea.b})}),r.a.createElement(wa,{id:"create-pixel",name:"Add Pixel Region",icon:r.a.createElement(va.a,{size:"xs",fixedWidth:!0,icon:Ea.e})})))},_a={container:{display:"flex",flexGrow:1,flexDirection:"column",height:"100%",maxHeight:"100vh",backgroundColor:"#fff",overflow:"hidden","&.fullscreen":{position:"absolute",zIndex:99999,left:0,right:0,top:0,bottom:0}},workspace:{backgroundColor:C.a[200],flexGrow:1,display:"flex",flexDirection:"row",height:"100%",overflow:"hidden"},iconToolsContainer:{display:"flex"},imageCanvasContainer:{display:"flex",flexGrow:1,alignItems:"center",justifyContent:"center"},noImageSelected:{fontWeight:"bold",fontSize:32,color:C.a[500]},sidebarContainer:{width:300,flexShrink:0,overflowY:"auto",backgroundColor:C.a[100],borderLeft:"1px solid ".concat(C.a[300]),zIndex:9,height:"100%",boxShadow:"0px 0px 5px rgba(0,0,0,0.1)"}},Na=a(252),Sa=a.n(Na),Ta=a(563),Ca=a(554),ka=a(555),Aa=a(556),Ma=a(253),La=a.n(Ma),Ra=function(e){var t=e.open,a=e.onClose,n=St();return r.a.createElement(Ta.a,{open:t||!1,onClose:a},r.a.createElement(Ca.a,null,"Settings"),r.a.createElement(ka.a,{style:{minWidth:400}},r.a.createElement(La.a,{variant:"flat",noActions:!0,defaultAnswers:n,onQuestionChange:function(e,t,a){return n.changeSetting(e,t)},form:{questions:[{type:"boolean",title:"Show Crosshairs",name:"showCrosshairs"},{type:"dropdown",title:"Video Playback Speed",name:"videoPlaybackSpeed",defaultValue:".25x",choices:["0.25x","0.5x","1x","2x"]}]}})),r.a.createElement(Aa.a,null,r.a.createElement(lt.a,{onClick:a},"Close")))},Pa=a(258),Da=a.n(Pa),Wa=function(e){return e.enabled?r.a.createElement(Da.a,e,e.children):e.children},Ba=function(e){var t,a,n=null;return"image"===e.annotationType?-1===(n=e.images.findIndex(function(t){return t.src===e.selectedImage&&(void 0===e.selectedImageFrameTime||t.frameTime===e.selectedImageFrameTime)}))?(n=null,a=null):(t=["images",n],a=Object(We.getIn)(e,t)):"video"===e.annotationType&&(t=["keyframes",e.currentVideoTime||0],a=Object(We.getIn)(e,t)||null),{currentImageIndex:n,pathToActiveImage:t,activeImage:a}},Ga=[],za=function(e,t){if(e[t||0])return e[t||0].regions;var a=Object.keys(e).map(function(e){return parseInt(e)}).filter(function(e){return!isNaN(e)});if(0===a.length)return Ga;a.sort(function(e,t){return e-t});var n=a.findIndex(function(e){return e>=t});if(-1===n)return e[a[a.length-1]].regions||Ga;if(0===n)return Ga;var o=a[n-1],r=e[o],i=a[n],c=e[i],l={},s={},u=!0,m=!1,d=void 0;try{for(var g,h=r.regions[Symbol.iterator]();!(u=(g=h.next()).done);u=!0){var p=g.value;l[p.id]=p}}catch(S){m=!0,d=S}finally{try{u||null==h.return||h.return()}finally{if(m)throw d}}var f=!0,b=!1,v=void 0;try{for(var E,y=c.regions[Symbol.iterator]();!(f=(E=y.next()).done);f=!0){var O=E.value;s[O.id]=O}}catch(S){b=!0,v=S}finally{try{f||null==y.return||y.return()}finally{if(b)throw v}}var x=[],j=(i-t)/(i-o),I=1-j,_=function(e){var t=[l[e],s[e]],a=t[0],n=t[1];if(!n)return x.push(Object(w.a)({},a,{highlighted:!1,editingLabels:!1})),"continue";switch(a.type){case"point":x.push(Object(w.a)({},a,{highlighted:!1,editingLabels:!1,x:a.x*j+n.x*I,y:a.y*j+n.y*I}));break;case"box":x.push(Object(w.a)({},a,{highlighted:!1,editingLabels:!1,x:a.x*j+n.x*I,y:a.y*j+n.y*I,w:a.w*j+n.w*I,h:a.h*j+n.h*I}));break;case"polygon":n.points.length===a.points.length?x.push(Object(w.a)({},a,{highlighted:!1,editingLabels:!1,points:a.points.map(function(e,t){return[e[0]*j+n.points[t][0]*I,e[1]*j+n.points[t][1]*I]})})):x.push(a)}};for(var N in l)_(N);return x},Ha=[],Va=Object(j.a)(_a),Fa=function(e){var t,a=e.state,n=e.dispatch,i=(e.alwaysShowNextButton,e.alwaysShowPrevButton,e.RegionEditLabel),c=Va(),l=St(),s=Object(o.useRef)({}),u=function(e){for(var t=arguments.length,a=new Array(t>1?t-1:0),o=1;o<t;o++)a[o-1]=arguments[o];var r="".concat(e,"(").concat(a.join(","),")");if(s.current[r])return s.current[r];var i=function(){for(var t=arguments.length,o=new Array(t),r=0;r<t;r++)o[r]=arguments[r];return a.length>0?n(Object(w.a)({type:e},a.reduce(function(e,t,a){return e[t]=o[a],e},{}))):n(Object(w.a)({type:e},o[0]))};return s.current[r]=i,i},m=Ba(a),d=m.currentImageIndex,g=m.activeImage;null!==d&&(t=a.images[d+1]),Sa()(function(){return n({type:"CANCEL"})},{detectKeys:[27]});var h=g&&void 0!==g.frameTime,p=function(e){if("video"!==e.annotationType)return Ha;var t=e.keyframes,a=e.currentVideoTime,n=void 0===a?0:a;return Object(o.useMemo)(function(){return za(t,n)},[t,n])}(a);return r.a.createElement(Wa,{enabled:a.fullScreen,onChange:function(e){e||u("HEADER_BUTTON_CLICKED","buttonName")("Exit Fullscreen")}},r.a.createElement("div",{className:A()(c.container,a.fullScreen&&"Fullscreen")},r.a.createElement("div",{className:c.headerContainer},r.a.createElement(ba,{state:a,onHeaderButtonClick:u("HEADER_BUTTON_CLICKED","buttonName"),videoMode:"video"===a.annotationType,inFullScreen:a.fullScreen,isAVideoFrame:h,nextVideoFrameHasRegions:!t||t.regions&&t.regions.length>0,videoDuration:a.videoDuration,multipleImages:a.images&&a.images.length>1,title:"image"===a.annotationType?g?g.name:"No Image Selected":a.videoName||"",onChangeCurrentTime:u("CHANGE_VIDEO_TIME","newTime"),videoPlaying:a.videoPlaying,currentVideoTime:a.currentVideoTime,keyframes:a.keyframes})),r.a.createElement("div",{className:c.workspace},r.a.createElement("div",{className:c.iconToolsContainer},r.a.createElement(Ia,{enabledTools:a.enabledTools,showTags:a.showTags,selectedTool:a.selectedTool,onClickTool:u("SELECT_TOOL","selectedTool")})),r.a.createElement("div",{className:c.imageCanvasContainer},"image"!==a.annotationType||a.selectedImage?r.a.createElement("div",{style:{height:"100%",width:"100%"}},r.a.createElement(Lt,Object.assign({},l,{key:a.selectedImage,showTags:a.showTags,allowedArea:a.allowedArea,regionClsList:a.regionClsList,regionTagList:a.regionTagList,regions:"image"===a.annotationType?g.regions||[]:p,realSize:g?g.realSize:void 0,videoPlaying:a.videoPlaying,imageSrc:"image"===a.annotationType?a.selectedImage:null,videoSrc:"video"===a.annotationType?a.videoSrc:null,pointDistancePrecision:a.pointDistancePrecision,createWithPrimary:a.selectedTool.includes("create"),dragWithPrimary:"pan"===a.selectedTool,zoomWithPrimary:"zoom"===a.selectedTool,showPointDistances:a.showPointDistances,videoTime:"image"===a.annotationType?a.selectedImageFrameTime:a.currentVideoTime,onMouseMove:u("MOUSE_MOVE"),onMouseDown:u("MOUSE_DOWN"),onMouseUp:u("MOUSE_UP"),onChangeRegion:u("CHANGE_REGION","region"),onBeginRegionEdit:u("OPEN_REGION_EDITOR","region"),onCloseRegionEdit:u("CLOSE_REGION_EDITOR","region"),onDeleteRegion:u("DELETE_REGION","region"),onBeginBoxTransform:u("BEGIN_BOX_TRANSFORM","box","directions"),onBeginMovePolygonPoint:u("BEGIN_MOVE_POLYGON_POINT","polygon","pointIndex"),onAddPolygonPoint:u("ADD_POLYGON_POINT","polygon","point","pointIndex"),onSelectRegion:u("SELECT_REGION","region"),onBeginMovePoint:u("BEGIN_MOVE_POINT","point"),onImageLoaded:u("IMAGE_LOADED","image"),RegionEditLabel:i,onImageOrVideoLoaded:u("IMAGE_OR_VIDEO_LOADED","metadata"),onChangeVideoTime:u("CHANGE_VIDEO_TIME","newTime"),onChangeVideoPlaying:u("CHANGE_VIDEO_PLAYING","isPlaying")}))):r.a.createElement("div",{className:c.noImageSelected},"No Image Selected")),r.a.createElement("div",{className:c.sidebarContainer},r.a.createElement(ot,{metadata:a.metadata,allowed_metadata:a.allowed_metadata,preview:a.preview,previewList:a.previewList,debug:window.localStorage.$ANNOTATE_DEBUG_MODE&&a,taskDescription:a.taskDescription,images:a.images,regions:g?g.regions:null,history:a.history,currentImage:g,labelImages:a.labelImages,imageClsList:a.imageClsList,imageTagList:a.imageTagList,keyframes:a.keyframes,currentVideoTime:a.currentVideoTime,onChangeMetadata:u("CHANGE_METADATA","metadata"),onChangeImage:u("CHANGE_IMAGE","delta"),onSelectRegion:u("SELECT_REGION","region"),onDeleteRegion:u("DELETE_REGION","region"),onSelectImage:u("SELECT_IMAGE","image"),onChangeRegion:u("CHANGE_REGION","region"),onRestoreHistory:u("RESTORE_HISTORY"),onChangeVideoTime:u("CHANGE_VIDEO_TIME","newTime"),onDeleteKeyframe:u("DELETE_KEYFRAME","time"),onShortcutActionDispatched:n}))),r.a.createElement(Ra,{open:a.settingsOpen,onClose:function(){return n({type:"HEADER_BUTTON_CLICKED",buttonName:"Settings"})}})))},Ua={BEGIN_BOX_TRANSFORM:"Transform/Move Box",BEGIN_MOVE_POINT:"Move Point",DELETE_REGION:"Delete Region"},Ya=function(e,t){return Object(We.updateIn)(e,["history"],function(a){return[{time:ke()().toDate(),state:Object(We.without)(e,"history"),name:t}].concat((a||[]).slice(0,9))})},Ja=function(){return Math.random().toString().split(".")[1]},qa=function(){var e,t,a=(e=0,t=360,Math.floor(Math.random()*(t-e+1))+e);return"hsl(".concat(a,",").concat(100,"%,").concat(50,"%)")},Ka=function(e,t){if("MOUSE_MOVE"===t.type){if(Date.now()-(e.lastMouseMoveCall||0)<16)return e;e=Object(We.setIn)(e,["lastMouseMoveCall"],Date.now())}t.type.includes("MOUSE")||(e=Object(We.setIn)(e,["lastAction"],t));var a=Ba(e),n=a.currentImageIndex,o=a.pathToActiveImage,r=a.activeImage,i=function(e){var t="string"===typeof e?e:e.id;if(!r)return null;var a=(r.regions||[]).findIndex(function(e){return e.id===t});return-1===a?null:a},c=function(e){if(!r)return null;var t=i(e);return null===t?[null,null]:[r.regions[t],t]},l=function(t,a){var n=c(t),i=Object(x.a)(n,2),l=i[0],s=i[1];if(!l)return e;if(null!==a)return Object(We.setIn)(e,[].concat(Object(v.a)(o),["regions",s]),Object(w.a)({},l,a));var u=r.regions;return Object(We.setIn)(e,[].concat(Object(v.a)(o),["regions"]),(u||[]).filter(function(e){return e.id!==l.id}))},s=function(e){return r?Object(We.setIn)(e,[].concat(Object(v.a)(o),["regions"]),(r.regions||[]).map(function(e){return Object(w.a)({},e,{highlighted:!1})})):e},u=function(e){return null===n?e:Object(We.setIn)(e,[].concat(Object(v.a)(o),["regions"]),(r.regions||[]).map(function(e){return Object(w.a)({},e,{editingLabels:!1})}))},m=function(t){var a="object"===typeof t?t:{src:t},n=a.src,o=a.frameTime;return Object(We.setIn)(Object(We.setIn)(e,["selectedImage"],n),["selectedImageFrameTime"],o)};switch(t.type){case"@@INIT":return e;case"SELECT_IMAGE":return m(t.image);case"CHANGE_REGION":var d=i(t.region);if(null===d)return e;var g=r.regions[d];return g.cls!==t.region.cls&&(e=Ya(e,"Change Region Classification")),q()(g.tags,t.region.tags)||(e=Ya(e,"Change Region Tags")),Object(We.setIn)(e,[].concat(Object(v.a)(o),["regions",d]),t.region);case"CHANGE_IMAGE":if(!r)return e;for(var h=t.delta,p=0,f=Object.keys(h);p<f.length;p++){var b=f[p];"cls"===b&&Ya(e,"Change Image Class"),"tags"===b&&Ya(e,"Change Image Tags"),e=Object(We.setIn)(e,[].concat(Object(v.a)(o),[b]),h[b])}return e;case"SELECT_REGION":var E=t.region;if(null===i(t.region))return e;var y=Object(v.a)(r.regions||[]).map(function(e){return Object(w.a)({},e,{highlighted:e.id===E.id,editingLabels:e.id===E.id})});return Object(We.setIn)(e,[].concat(Object(v.a)(o),["regions"]),y);case"BEGIN_MOVE_POINT":return e=u(e),Object(We.setIn)(e,["mode"],{mode:"MOVE_REGION",regionId:t.point.id});case"BEGIN_BOX_TRANSFORM":var O=t.box,j=t.directions;return e=u(e),0===j[0]&&0===j[1]?Object(We.setIn)(e,["mode"],{mode:"MOVE_REGION",regionId:O.id}):Object(We.setIn)(e,["mode"],{mode:"RESIZE_BOX",regionId:O.id,freedom:j,original:{x:O.x,y:O.y,w:O.w,h:O.h}});case"BEGIN_MOVE_POLYGON_POINT":var I=t.polygon,_=t.pointIndex;return(e=u(e)).mode&&"DRAW_POLYGON"===e.mode.mode&&0===_?Object(We.setIn)(l(I,{points:I.points.slice(0,-1),open:!1}),["mode"],null):(e=Ya(e,"Move Polygon Point"),Object(We.setIn)(e,["mode"],{mode:"MOVE_POLYGON_POINT",regionId:I.id,pointIndex:_}));case"ADD_POLYGON_POINT":var N=t.polygon,S=t.point,T=t.pointIndex,C=i(N);if(null===C)return e;var k=Object(v.a)(N.points);return k.splice(T,0,S),Object(We.setIn)(e,[].concat(Object(v.a)(o),["regions",C]),Object(w.a)({},N,{points:k}));case"MOUSE_MOVE":var A=t.x,M=t.y;if(!e.mode)return e;if(!r)return e;switch(e.mode.mode){case"MOVE_POLYGON_POINT":var L=e.mode,R=L.pointIndex,P=L.regionId,D=i(P);return null===D?e:Object(We.setIn)(e,[].concat(Object(v.a)(o),["regions",D,"points",R]),[A,M]);case"MOVE_REGION":var W=e.mode.regionId,B=i(W);return null===B?e:Object(We.setIn)(e,[].concat(Object(v.a)(o),["regions",B]),function(e,t,a){switch(e.type){case"point":return Object(w.a)({},e,{x:t,y:a});case"box":return Object(w.a)({},e,{x:t-e.w/2,y:a-e.h/2})}return e}(r.regions[B],A,M));case"RESIZE_BOX":var G=e.mode,z=G.regionId,H=Object(x.a)(G.freedom,2),V=H[0],F=H[1],U=G.original,Y=U.x,J=U.y,K=U.w,X=U.h,Z=i(z);if(null===Z)return e;var Q=r.regions[Z],$=0===V?Y:-1===V?Math.min(Y+K,A):Y,ee=0===V?K:-1===V?K+(Y-$):Math.max(0,K+(A-Y-K)),te=0===F?J:-1===F?Math.min(J+X,M):J,ae=0===F?X:-1===F?X+(J-te):Math.max(0,X+(M-J-X));return ee<=.001&&(e=Object(We.setIn)(e,["mode","freedom"],[-1*V,F])),ae<=.001&&(e=Object(We.setIn)(e,["mode","freedom"],[V,-1*F])),Object(We.setIn)(e,[].concat(Object(v.a)(o),["regions",Z]),Object(w.a)({},Q,{x:$,w:ee,y:te,h:ae}));case"DRAW_POLYGON":var ne=e.mode.regionId,oe=c(ne),re=Object(x.a)(oe,2),ie=re[0],ce=re[1];return ie?Object(We.setIn)(e,[].concat(Object(v.a)(o),["regions",ce,"points",ie.points.length-1]),[A,M]):Object(We.setIn)(e,["mode"],null)}return e;case"MOUSE_DOWN":if(!r)return e;var le,se=t.x,ue=t.y;if(e.allowedArea){var me=e.allowedArea;if(se<me.x||se>me.x+me.w||ue<me.y||ue>me.y+me.h)return e}switch(e.selectedTool){case"create-point":e=Ya(e,"Create Point"),le={type:"point",x:se,y:ue,highlighted:!0,editingLabels:!0,color:qa(),id:Ja()};break;case"create-box":e=Ya(e,"Create Box"),le={type:"box",x:se,y:ue,w:.01,h:.01,highlighted:!0,editingLabels:!1,color:qa(),id:Ja()},e=s(e),e=Object(We.setIn)(e,["mode"],{mode:"RESIZE_BOX",editLabelEditorAfter:!0,regionId:le.id,freedom:[1,1],original:{x:se,y:ue,w:le.w,h:le.h},isNew:!0});break;case"create-polygon":if(e.mode&&"DRAW_POLYGON"===e.mode.mode)break;e=Ya(e,"Create Polygon"),le={type:"polygon",points:[[se,ue],[se,ue]],open:!0,highlighted:!0,color:qa(),id:Ja()},e=Object(We.setIn)(e,["mode"],{mode:"DRAW_POLYGON",regionId:le.id})}if(le&&(e=s(e)),e.mode)switch(e.mode.mode){case"DRAW_POLYGON":var de=c(e.mode.regionId),ge=Object(x.a)(de,2),he=ge[0],pe=ge[1];if(!he)break;return Object(We.setIn)(e,[].concat(Object(v.a)(o),["regions",pe]),Object(w.a)({},he,{points:he.points.concat([[se,ue]])}))}var fe=Object(v.a)(r.regions||[]).map(function(e){return Object(w.a)({},e,{editingLabels:!1})}).concat(le?[le]:[]);return Object(We.setIn)(e,[].concat(Object(v.a)(o),["regions"]),fe);case"MOUSE_UP":var be=t.x,ve=t.y;if(!e.mode)return e;switch(e.mode.mode){case"RESIZE_BOX":if(e.mode.isNew&&Math.abs(e.mode.original.x-be)<.01&&Math.abs(e.mode.original.y-ve)<.01)return Object(We.setIn)(l(e.mode.regionId,null),["mode"],null);if(e.mode.editLabelEditorAfter)return Object(w.a)({},l(e.mode.regionId,{editingLabels:!0}),{mode:null});case"MOVE_REGION":case"MOVE_POLYGON_POINT":return Object(w.a)({},e,{mode:null})}return e;case"CHANGE_REGION":var Ee=t.region,ye=i(t.region);return null===ye?e:Object(We.setIn)(e,[].concat(Object(v.a)(o),["regions",ye]),Ee);case"OPEN_REGION_EDITOR":t.region;var Oe=i(t.region);if(null===Oe)return e;var we=Object(We.setIn)(r.regions.map(function(e){return Object(w.a)({},e,{highlighted:!1,editingLabels:!1})}),[Oe],Object(w.a)({},(r.regions||[])[Oe],{highlighted:!0,editingLabels:!0}));return Object(We.setIn)(e,[].concat(Object(v.a)(o),["regions"]),we);case"CLOSE_REGION_EDITOR":t.region;var xe=i(t.region);return null===xe?e:Object(We.setIn)(e,[].concat(Object(v.a)(o),["regions",xe]),Object(w.a)({},(r.regions||[])[xe],{editingLabels:!1}));case"DELETE_REGION":return null===i(t.region)?e:Object(We.setIn)(e,[].concat(Object(v.a)(o),["regions"]),(r.regions||[]).filter(function(e){return e.id!==t.region.id}));case"HEADER_BUTTON_CLICKED":switch(t.buttonName.toLowerCase()){case"prev":return null===n?e:0===n?e:m(e.images[n-1]);case"next":return null===n?e:n===e.images.length-1?e:m(e.images[n+1]);case"clone":return null===n?e:n===e.images.length-1?e:Object(We.setIn)(m(e.images[n+1]),["images",n+1,"regions"],r.regions);case"settings":return Object(We.setIn)(e,["settingsOpen"],!e.settingsOpen);case"fullscreen":return Object(We.setIn)(e,["fullScreen"],!0);case"exit fullscreen":case"window":return Object(We.setIn)(e,["fullScreen"],!1);case"hotkeys":return e;case"exit":case"done":case"next image":case"prev image":return e;case"object detection":return Object(We.setIn)(e,["annotatemode"],"object_detection");case"segmentation":return Object(We.setIn)(e,["annotatemode"],"segmentation")}return e;case"SELECT_TOOL":return e=Object(We.setIn)(e,["mode"],null),"show-tags"===t.selectedTool?Object(We.setIn)(e,["showTags"],!e.showTags):(console.log("[selectedtool]",e.selectedTool),Object(We.setIn)(e,["selectedTool"],t.selectedTool));case"CANCEL":var je=e.mode;if(je)switch(je.mode){case"DRAW_POLYGON":return l(je.regionId,null);case"MOVE_POLYGON_POINT":case"RESIZE_BOX":case"MOVE_REGION":return Object(We.setIn)(e,["mode"],null)}var Ie=r.regions;return Ie.some(function(e){return e.editingLabels})?Object(We.setIn)(e,[].concat(Object(v.a)(o),["regions"]),Ie.map(function(e){return Object(w.a)({},e,{editingLabels:!1})})):Object(We.setIn)(e,[].concat(Object(v.a)(o),["regions"]),Ie.map(function(e){return Object(w.a)({},e,{highlighted:!1})}));case"RELOAD":return Object(We.setIn)(e,["images"],t.image);case"ANNOTATION_MODE":return"segmentation"===e.annotatemode?(console.log("[reducer annotatemode]",e.annotatemode),Object(We.setIn)(e,["enabledTools"],["select","create-polygon"])):(console.log("[reducer annotatemode]",e.annotatemode),Object(We.setIn)(e,["enabledTools"],["select","create-box"]));case"CLASS_LIST":return Object(We.setIn)(e,["regionClsList"],t.classlist);case"IMAGE_INDEX":return Object(We.setIn)(e,["curr_image_index"],t.curr_image_index);case"CHANGE_METADATA":return Object(We.setIn)(e,["metadata"],t.metadata);case"CHANGE_METALIST":return Object(We.setIn)(e,["allowed_metadata"],t.metadata);case"PREVIEW_LIST":return Object(We.setIn)(e,["previewList"],t.image);case"LOADER":return Object(We.setIn)(e,["loader"],t.value);case"LOADER_MESSAGE":return Object(We.setIn)(e,["message"],t.value)}return e},Xa=function(e,t){var a=Ba(e),n=a.currentImageIndex;a.pathToActiveImage,a.activeImage;switch(t.type){case"IMAGE_LOADED":return console.log("[Image_loaded]",e),Object(We.setIn)(e,["images",n,"pixelSize"],{w:t.image.width,h:t.image.height})}return e},Za=function(e,t){var a=function(){return Object(We.setIn)(Ya(e,"Add Keyframe"),["keyframes",e.currentVideoTime],{regions:za(e.keyframes,e.currentVideoTime)})};switch(t.type){case"IMAGE_OR_VIDEO_LOADED":var n=t.metadata.duration;if("number"===typeof n)return Object(We.setIn)(e,["videoDuration"],1e3*n);case"HEADER_BUTTON_CLICKED":switch(t.buttonName.toLowerCase()){case"play":return Object(We.setIn)(e,["videoPlaying"],!0);case"pause":return Object(We.setIn)(e,["videoPlaying"],!1)}case"CHANGE_VIDEO_TIME":return Object(We.setIn)(e,["currentVideoTime"],t.newTime);case"CHANGE_VIDEO_PLAYING":return Object(We.setIn)(e,["videoPlaying"],t.isPlaying);case"DELETE_KEYFRAME":return Object(We.setIn)(e,["keyframes"],Object(We.without)(e.keyframes,t.time))}if(!e.keyframes[e.currentVideoTime])switch(t.type){case"BEGIN_BOX_TRANSFORM":case"BEGIN_MOVE_POINT":case"BEGIN_MOVE_POLYGON_POINT":case"BEGIN_BOX_TRANSFORM":case"BEGIN_MOVE_POLYGON_POINT":case"ADD_POLYGON_POINT":case"SELECT_REGION":case"CHANGE_REGION":case"DELETE_REGION":case"OPEN_REGION_EDITOR":return a();case"MOUSE_DOWN":switch(e.selectedTool){case"create-point":case"create-polygon":case"create-box":return a()}}return e},Qa=(a(498),function(e){return r.a.createElement("div",{className:"loader-container"},r.a.createElement("div",{className:"loader"},r.a.createElement("div",{className:"ellipse"}),r.a.createElement("div",{className:"ellipse"}),r.a.createElement("div",{className:"ellipse"}),r.a.createElement("div",{className:"ellipse"}),r.a.createElement("div",{className:"ellipse"})),r.a.createElement("p",{style:{color:"white",fontSize:"2rem",marginTop:"4rem"}}," ",e.message," "))}),$a=function(e){var t=e.images,a=e.allowedArea,n=e.selectedImage,i=void 0===n?t&&t.length>0?t[0].src:void 0:n,c=e.showPointDistances,l=e.pointDistancePrecision,s=e.showTags,u=void 0===s||s,m=e.enabledTools,d=void 0===m?["select","create-point","create-box"]:m,g=e.regionTagList,h=void 0===g?[]:g,p=e.regionClsList,f=void 0===p?[]:p,b=e.imageTagList,v=void 0===b?[]:b,E=e.imageClsList,y=void 0===E?[]:E,O=e.keyframes,j=void 0===O?{}:O,I=e.taskDescription,_=e.RegionEditLabel,N=e.videoSrc,S=e.videoTime,T=void 0===S?0:S,C=e.videoName,k=e.onExit,A=e.onNextImage,L=e.onPrevImage,R=e.preview,P=e.previewList,D=e.curr_image_index,W=e.changeAnnotateMode,B=e.annotatemode,G=e.allowed_metadata,z=e.metadata,H=void 0===z?{}:z,V=e.loading,F=e.message,U=e.updateRegion;St();if(!t&&!N)return'Missing required prop "images" or "videoSrc"';var Y,J=t?"image":"video",q=Object(o.useReducer)((Y=function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return function(e,a){var n=!0,o=!1,r=void 0;try{for(var i,c=t[Symbol.iterator]();!(n=(i=c.next()).done);n=!0)e=(0,i.value)(e,a)}catch(l){o=!0,r=l}finally{try{n||null==c.return||c.return()}finally{if(o)throw r}}return e}}("image"===J?Xa:Za,Ka),function(e,t){var a=e,n=Y(e,t);if("RESTORE_HISTORY"===t.type){if(e.history.length>0)return Object(We.setIn)(n.history[0].state,["history"],n.history.slice(1))}else if(a!==n&&Object.keys(Ua).includes(t.type))return Object(We.setIn)(n,["history"],[{time:ke()().toDate(),state:Object(We.without)(a,"history"),name:Ua[t.type]||t.type}].concat(n.history||[]).slice(0,9));return n}),Be()(Object(w.a)({message:F,updateRegion:U,loading:V,metadata:H,allowed_metadata:G,annotationType:J,curr_image_index:D,preview:R,previewList:P,changeAnnotateMode:W,annotatemode:B,showTags:u,allowedArea:a,showPointDistances:c,pointDistancePrecision:l,selectedTool:"select",mode:null,taskDescription:I,labelImages:y.length>0||v.length>0,regionClsList:f,regionTagList:h,imageClsList:y,imageTagList:v,currentVideoTime:T,enabledTools:d,history:[],videoName:C},"image"===J?{selectedImage:i,images:t,selectedImageFrameTime:t&&t.length>0?t[0].frameTime:void 0}:{videoSrc:N,keyframes:j}))),K=Object(x.a)(q,2),X=K[0],Z=K[1],Q=Object(M.a)(function(e){if("HEADER_BUTTON_CLICKED"===e.type){if(["Exit","Done","Save","Complete","Review"].includes(e.buttonName))return k(Object(We.without)(X,"history"));if("next image"===e.buttonName&&A)return Z({type:"CHANGE_METADATA",metadata:null}),A(Object(We.without)(X,"history"));if("prev image"===e.buttonName&&L)return Z({type:"CHANGE_METADATA",metadata:null}),L(Object(We.without)(X,"history"))}Z(e)});return Object(o.useEffect)(function(){Z({type:"SELECT_IMAGE",image:X.images.find(function(e){return e.src===i})})},[i]),Object(o.useEffect)(function(){Z({type:"RELOAD",image:t}),Z({type:"SELECT_IMAGE",image:t[0]})},[t]),Object(o.useEffect)(function(){Z({type:"CLASS_LIST",classlist:f})},[f]),Object(o.useEffect)(function(){"object_detection"===X.annotatemode?(Z({type:"ANNOTATION_MODE"}),Z({type:"SELECT_TOOL",selectedTool:"create-box"}),X.changeAnnotateMode(X.annotatemode)):(Z({type:"ANNOTATION_MODE"}),Z({type:"SELECT_TOOL",selectedTool:"create-polygon"}),X.changeAnnotateMode(X.annotatemode))},[X.annotatemode]),Object(o.useEffect)(function(){Z({type:"IMAGE_INDEX",curr_image_index:D})},[D]),Object(o.useEffect)(function(){Z({type:"PREVIEW_LIST",image:P})},[P]),Object(o.useEffect)(function(){Z({type:"CHANGE_METADATA",metadata:H})},[H]),Object(o.useEffect)(function(){Z({type:"CHANGE_METALIST",metadata:G})},[G]),Object(o.useEffect)(function(){Z({type:"LOADER",value:V})},[V]),Object(o.useEffect)(function(){Z({type:"LOADER_MESSAGE",value:F})},[F]),V?r.a.createElement(Qa,{message:F}):r.a.createElement(Tt,null,r.a.createElement(Fa,{RegionEditLabel:_,alwaysShowNextButton:Boolean(A),alwaysShowPrevButton:Boolean(L),state:X,dispatch:Q}))},en=a(17),tn=a.n(en),an=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(a=Object(m.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(o)))).state={src:null,image_key:"",annotatemode:"object_detection",curr_image_index:0,call_type:"first",regions:[],metadata:"",class_list:"",seg_class:[],obj_class:[],allowed_metadata:{},dimension:{imgHeight:0,imgWidth:0},previewList:[],loading:!0,message:"Fetching Image for annotation"},a.getImageSize=function(){var e=Object(O.a)(y.a.mark(function e(t){return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return{},e.abrupt("return",new Promise(function(e,a){var n=new Image;n.src=t,n.onload=function(){return e({imgHeight:n.height,imgWidth:n.width})}}));case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.titleHandler=function(e){switch(e.message){case"Cannot read property 'map' of undefined":return"No segmentation data ";case"Cannot read property 'data' of undefined":return"No more images left for you";case"Cannot read property '0' of undefined":return"Image not valid";default:return e.message}},a.getRandomId=function(){return Math.random().toString().split(".")[1]},a.postImage=function(){var e=Object(O.a)(y.a.mark(function e(t,n){var o,r,i,c,l,s,u,m,d;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:console.log("next",t),o=[],l=a.state.dimension,s=l.imgWidth,u=l.imgHeight,null!=t.metadata?null!==t.images[0].regions?("object_detection"===a.state.annotatemode?t.images[0].regions.map(function(e){o.push({cls:e.cls,highlighted:!1,id:e.id,x:e.x*s,y:e.y*u,w:e.w*s,h:e.h*u,color:"hsl(82,100%,50%)",type:"box",cls_id:"".concat(a.state.class_list.indexOf(e.cls))})}):t.images[0].regions.map(function(e){var t=[];e.points.map(function(e,a){t.push([e[0]*s,e[1]*u])}),o.push({cls:e.cls,highlighted:!1,id:e.id,points:t,color:"hsl(82,100%,50%)",type:"polygon",cls_id:"".concat(a.state.class_list.indexOf(e.cls))})}),console.log("[generarted regions]",o),"review"===n&&(localStorage.getItem("checkList")?(m=JSON.parse(localStorage.getItem("checkList")),d=[].concat(Object(v.a)(m),[a.state.image_key]),localStorage.setItem("checkList",JSON.stringify(d))):localStorage.setItem("checkList",JSON.stringify([a.state.image_key]))),b.a.post("/annotations/update-get-image-data-by-user",{image_key:a.state.image_key,metadata:t.metadata,annotations:o},{headers:{Authorization:"bearer ".concat(localStorage.getItem("jwt"))},params:{annotate_mode:a.state.annotatemode,call_type:"review"===n?"next":n,curr_image_index:"previous"===n?a.state.curr_image_index-1:a.state.curr_image_index+1}}).then(function(e){i=e,localStorage.setItem("metadata",JSON.stringify(e.data.metadata)),console.log("[next api]",e),e.data.error?(a.setState({loading:!1,src:null}),tn()({title:e.data.error,icon:"warning",buttons:!0})):a.toArrayBuffer(e.data.image.data).then(function(t){var o=new Blob([t],{type:"image/jpeg"});r=URL.createObjectURL(o),a.getImageSize(r).then(function(t){c=t;var o=[];e.data.annotations.obj_detect||e.data.annotations.segmentation?"object_detection"===a.state.annotatemode?e.data.annotations.obj_detect.map(function(e,n){o.push({cls:e.Class_Name,highlighted:!1,id:a.getRandomId(),x:e.Region[0]/t.imgWidth,y:e.Region[1]/t.imgHeight,w:e.Region[2]/t.imgWidth,h:e.Region[3]/t.imgHeight,color:"hsl(82,100%,50%)",type:"box"})}):e.data.annotations.segmentation.map(function(e,n){var r=[];e.Region.map(function(e,a){r.push([e[0]/t.imgWidth,e[1]/t.imgHeight])}),o.push({cls:e.Class_Name,highlighted:!1,id:a.getRandomId(),points:r,color:"hsl(82,100%,50%)",type:"polygon"})}):"object_detection"===a.state.annotatemode?e.data.annotations.map(function(e,a){o.push({cls:e.cls,highlighted:!1,id:e.id,x:e.x/t.imgWidth,y:e.y/t.imgHeight,w:e.w/t.imgWidth,h:e.h/t.imgHeight,color:"hsl(82,100%,50%)",type:"box"})}):e.data.annotations.map(function(e,a){var n=[];e.points.map(function(e,a){n.push([e[0]/t.imgWidth,[e[1]/t.imgHeight]])}),o.push({cls:e.cls,highlighted:!1,id:e.id,points:n,color:"hsl(82,100%,50%)",type:"polygon"})}),a.setState({curr_image_index:"previous"===n?a.state.curr_image_index-1:a.state.curr_image_index+1,src:r,regions:o,metadata:e.data.metadata,image_key:e.data.image_key,dimension:t,previewList:JSON.parse(localStorage.getItem("checkList"))?JSON.parse(localStorage.getItem("checkList")):[],loading:!1})}).catch(function(t){a.setState({curr_image_index:"previous"===n?a.state.curr_image_index-1:a.state.curr_image_index+1,src:r,metadata:e.data.metadata,image_key:e.data.image_key,dimension:c,regions:null,previewList:JSON.parse(localStorage.getItem("checkList"))?JSON.parse(localStorage.getItem("checkList")):[],loading:!1}),"Cannot read property 'map' of undefined"!==t.message&&tn()({title:a.titleHandler(t),icon:"warning",buttons:!0})})}).catch(function(t){a.setState({curr_image_index:"previous"===n?a.state.curr_image_index-1:a.state.curr_image_index+1,src:r,metadata:e.data.metadata,image_key:e.data.image_key,dimension:c,regions:null,previewList:JSON.parse(localStorage.getItem("checkList"))?JSON.parse(localStorage.getItem("checkList")):[],loading:!1}),"Cannot read property 'map' of undefined"!==t.message&&tn()({title:a.titleHandler(t),icon:"warning",buttons:!0})})}).catch(function(e){a.setState({curr_image_index:"previous"===n?a.state.curr_image_index-1:a.state.curr_image_index+1,src:r,metadata:i.data.metadata,image_key:i.data.image_key,dimension:c,regions:null,previewList:JSON.parse(localStorage.getItem("checkList"))?JSON.parse(localStorage.getItem("checkList")):[],loading:!1}),"Cannot read property 'map' of undefined"!==e.message&&tn()({title:a.titleHandler(e),icon:"warning",buttons:!0})})):(console.log("exit if"),a.setState({loading:!1,metadata:JSON.parse(localStorage.getItem("metadata"))?JSON.parse(localStorage.getItem("metadata")):null}),tn()({title:"Annotations  cannot be empty",icon:"warning",buttons:!0})):(console.log("[image]",t.images[0].regions,"[state]",a.state.regions),a.setState({loading:!1}),tn()({title:"metadata cannot be empty",icon:"warning",buttons:!0}));case 4:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),a.prevImage=function(){var e=Object(O.a)(y.a.mark(function e(t){return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("previous",t),e.prev=1,a.setState({loading:!0,message:"Fetching previous Image ",metadata:null,regions:t.images[0].regions}),e.next=5,a.postImage(t,"previous").then(function(e){console.log("[prev call]",e)}).catch(function(e){a.setState({loading:!1}),tn()({title:a.titleHandler(e),icon:"warning",buttons:!0})});case 5:e.next=11;break;case 7:e.prev=7,e.t0=e.catch(1),a.setState({loading:!1}),tn()({title:a.titleHandler(e.t0),icon:"warning",buttons:!0});case 11:case"end":return e.stop()}},e,null,[[1,7]])}));return function(t){return e.apply(this,arguments)}}(),a.nextImage=function(){var e=Object(O.a)(y.a.mark(function e(t){return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,a.setState({loading:!0,message:"Fetching Next Image",metadata:null}),null===a.state.src){e.next=8;break}return console.log("ended"),e.next=6,a.postImage(t,"next").then(function(e){console.log("[next call]",e)}).catch(function(e){a.setState({loading:!1}),tn()({title:a.titleHandler(e),icon:"warning",buttons:!0})});case 6:e.next=10;break;case 8:a.setState({loading:!1}),tn()({title:"No more images",text:"Try reload or come back later",icon:"warning",buttons:!0});case 10:e.next=16;break;case 12:e.prev=12,e.t0=e.catch(0),a.setState({loading:!1}),tn()({title:a.titleHandler(e.t0),icon:"warning",buttons:!0});case 16:case"end":return e.stop()}},e,null,[[0,12]])}));return function(t){return e.apply(this,arguments)}}(),a.checkImage=function(e){try{a.setState({loading:!0,message:"Marking the image for Review"}),a.postImage(e,"review").then(function(e){console.log("[review]",e)}).catch(function(e){a.setState({loading:!1}),tn()({title:a.titleHandler(e),icon:"warning",buttons:!0})})}catch(t){a.setState({loading:!1}),tn()({title:a.titleHandler(t),icon:"warning",buttons:!0})}},a.preview=function(e){console.log("[preview image]",e),a.setState({loading:!0,message:"Fething Image for Review"}),a.main_api("review",e)},a.changeAnnotateMode=function(e){a.setState({annotatemode:e}),"segmentation"===e?(a.setState({class_list:a.state.seg_class,curr_image_index:0,loading:!0,message:"changing into Segmentation mode"}),a.main_api("first")):(a.setState({class_list:a.state.obj_class}),"first"!=a.state.call_type&&(a.setState({loading:!0,curr_image_index:0,message:"changing into Object Detection mode"}),a.main_api("first")))},a.get_class=function(){var e=Object(O.a)(y.a.mark(function e(t){return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.a.get("/get_class",{params:{project:t}}).then(function(e){console.log(e),a.setState({obj_class:e.data.classes.obj_class,seg_class:e.data.classes.seg_class,class_list:e.data.classes.obj_class,allowed_metadata:e.data.classes.meta_data})}).catch(function(e){a.setState({loading:!1}),tn()({title:a.titleHandler(e),icon:"warning",buttons:!0})});case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a}return Object(g.a)(t,e),Object(u.a)(t,[{key:"toArrayBuffer",value:function(){var e=Object(O.a)(y.a.mark(function e(t){var a,n,o;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(a=new ArrayBuffer(t.length),n=new Uint8Array(a),o=0;o<t.length;++o)n[o]=t[o];return e.abrupt("return",a);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"main_api",value:function(){var e=Object(O.a)(y.a.mark(function e(t,a){var n,o,r,i=this;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Mainapi"),e.next=3,b.a.get("annotations/get-image-data-by-user",{headers:{Authorization:"bearer ".concat(localStorage.getItem("jwt"))},params:{annotate_mode:this.state.annotatemode,call_type:t,curr_image_index:"first"===t?0:this.state.curr_image_index,image_key:a}}).then(function(e){console.log("[".concat(t,"]"),e),r=e,e.data.error?(i.setState({loading:!1}),tn()({title:e.data.error,text:"come back later",icon:"warning",buttons:!0})):(localStorage.setItem("metadata",JSON.stringify(e.data.metadata)),i.toArrayBuffer(e.data.image.data).then(function(t){var a=new Blob([t],{type:"image/jpeg"});o=URL.createObjectURL(a),i.getImageSize(o).then(function(t){n=t;var a=[];null!=e.data.annotations?(e.data.annotations.obj_detect||e.data.annotations.segmentation?"object_detection"===i.state.annotatemode?e.data.annotations.obj_detect.map(function(e,n){a.push({cls:e.Class_Name,highlighted:!1,id:i.getRandomId(),x:e.Region[0]/t.imgWidth,y:e.Region[1]/t.imgHeight,w:e.Region[2]/t.imgWidth,h:e.Region[3]/t.imgHeight,color:"hsl(82,100%,50%)",type:"box"})}):e.data.annotations.segmentation.map(function(e,n){var o=[];e.Region.map(function(e,a){o.push([e[0]/t.imgWidth,e[1]/t.imgHeight])}),a.push({cls:e.Class_Name,highlighted:!1,id:i.getRandomId(),points:o,color:"hsl(82,100%,50%)",type:"polygon"})}):"object_detection"===i.state.annotatemode?e.data.annotations.map(function(e,n){a.push({cls:e.cls,highlighted:!1,id:e.id,x:e.x/t.imgWidth,y:e.y/t.imgHeight,w:e.w/t.imgWidth,h:e.h/t.imgHeight,color:"hsl(82,100%,50%)",type:"box"})}):e.data.annotations.map(function(e,n){var o=[];e.points.map(function(e,a){o.push([e[0]/t.imgWidth,[e[1]/t.imgHeight]])}),a.push({cls:e.cls,highlighted:!1,id:e.id,points:o,color:"hsl(82,100%,50%)",type:"polygon"})}),console.log("[generarted regions]",a),i.setState({curr_image_index:i.state.curr_image_index,src:o,regions:a,metadata:e.data.metadata,image_key:e.data.image_key,dimension:t,loading:!1})):(i.setState({loading:!1}),tn()({title:"NO Annotations",icon:"warning",buttons:!0}),i.setState({curr_image_index:i.state.curr_image_index,src:o,regions:null,metadata:e.data.metadata,image_key:e.data.image_key,dimension:t,loading:!1}))}).catch(function(t){i.setState({curr_image_index:i.state.curr_image_index,src:o,regions:null,metadata:e.data.metadata,image_key:e.data.image_key,dimension:n,loading:!1}),"Cannot read property 'map' of undefined"!==t.message&&tn()({title:i.titleHandler(t),icon:"warning",buttons:!0})})}).catch(function(t){i.setState({curr_image_index:i.state.curr_image_index,src:o,regions:null,metadata:e.data.metadata,image_key:e.data.image_key,dimension:n,loading:!1}),tn()({title:i.titleHandler(t),icon:"warning",buttons:!0})}))}).catch(function(e){i.setState({curr_image_index:i.state.curr_image_index,src:o,regions:null,metadata:r.data.metadata,image_key:r.data.image_key,dimension:n,loading:!1}),tn()({title:i.titleHandler(e),buttons:!0})});case 3:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){var e=Object(O.a)(y.a.mark(function e(){return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("did mount"),e.next=3,this.get_class("global");case 3:try{"first"===this.state.call_type&&(this.setState({loading:!0,message:"Fetching Image for annotation"}),localStorage.removeItem("checkList"),this.main_api("first","first"),this.setState({call_type:"previous"}))}catch(t){console.log(t.response),alert("could'nt load image")}case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state,t=e.loading,a=e.message,n=e.metadata,o=e.allowed_metadata,i=e.previewList,c=e.curr_image_index,l=e.annotatemode,s=e.class_list,u=e.src,m=e.regions;return r.a.createElement($a,{loading:t,message:a,metadata:n,allowed_metadata:o,preview:this.preview,previewList:i,curr_image_index:c,changeAnnotateMode:this.changeAnnotateMode,annotatemode:l,allowedArea:{x:0,y:0,w:1,h:1},taskDescription:"Annotate the imaes by selecting the mode for object detection or segmentationl",images:[{src:u,name:"Task:Enter the Metadata First then Annotate",regions:m}],regionClsList:s,onPrevImage:this.prevImage,onNextImage:this.nextImage,onExit:this.checkImage})}}]),t}(o.Component),nn=a(88),on=a.n(nn),rn=(a(499),a(168)),cn=a.n(rn),ln=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(a=Object(m.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(o)))).logout=function(){var e=a.props.history;console.log("logging out"),localStorage.removeItem("jwt"),a.props.updateUser({loggedIn:!1,username:null}),e.push("/")},a.confirmLogout=function(){tn()({title:"Are you sure to Logout?",icon:"warning",buttons:!0,dangerMode:!0}).then(function(e){e?a.logout():tn()("You are loggedIn !")})},a}return Object(g.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.props.loggedIn;return r.a.createElement("div",null,e?r.a.createElement("div",{className:"w3-bar w3-black"},r.a.createElement("a",{className:"w3-bar-item"},r.a.createElement("img",{src:on.a,className:"App-logo",alt:"logo"}),r.a.createElement("strong",null,r.a.createElement("span",{className:"w3-text-red"},"AUTO"),"\xa0"),r.a.createElement("strong",null,r.a.createElement("span",null,"ANNOTATION"))),r.a.createElement(l.b,{to:"#",className:"w3-bar-item w3-button w3-hover-dark-gray  w3-right",onClick:this.confirmLogout},r.a.createElement(cn.a,null),r.a.createElement("div",null,"LogOut"))):r.a.createElement("div",{className:"w3-bar w3-black"},r.a.createElement("a",{className:"w3-bar-item"},r.a.createElement("strong",null,r.a.createElement("span",{className:"w3-text-red"},"AUTO"),"\xa0"),r.a.createElement("strong",null,r.a.createElement("span",null,"ANNOTATION"))),r.a.createElement(l.b,{to:"/login",className:"w3-bar-item w3-button w3-hover-dark-gray w3-right"},"Login"),r.a.createElement(l.b,{to:"/signup",className:"w3-bar-item w3-button w3-hover-dark-gray w3-right"},"SignUp")))}}]),t}(o.Component),sn=Object(p.g)(ln),un=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(m.a)(this,Object(d.a)(t).call(this,e))).state={hasError:!1},a}return Object(g.a)(t,e),Object(u.a)(t,[{key:"componentDidCatch",value:function(e,t){alert(e)}},{key:"render",value:function(){return this.state.hasError?r.a.createElement("h1",null,"Something went wrong."):this.props.children}}],[{key:"getDerivedStateFromError",value:function(e){return{hasError:!0}}}]),t}(r.a.Component),mn=function(e){function t(){return Object(s.a)(this,t),Object(m.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(g.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.props.loggedIn,t=this.props.updateUser;return e?r.a.createElement("div",null,r.a.createElement(un,null,r.a.createElement(sn,{updateUser:t,loggedIn:e})),r.a.createElement(un,null,r.a.createElement(an,null))):r.a.createElement(p.a,{to:"/"})}}]),t}(o.Component),dn=Object(p.g)(mn),gn=a(558),hn=a(557),pn=a(560),fn=a(92),bn=a(116),vn=a.n(bn);function En(){return r.a.createElement(fn.a,{variant:"body2",color:"textSecondary",align:"center"},"Copyright \xa9 ",r.a.createElement(hn.a,{color:"inherit",href:"https://fluxauto.xyz/"},"www.fluxauto.xyz")," ",(new Date).getFullYear(),".")}var yn=Object(j.a)(function(e){return{root:{height:"100vh"},image:{backgroundImage:"url(".concat(on.a,")"),backgroundRepeat:"no-repeat",backgroundColor:"black",backgroundSize:"500px 500px",backgroundPosition:"center"},paper:{margin:e.spacing(8,4),display:"flex",flexDirection:"column",alignItems:"center"},avatar:{margin:e.spacing(1),backgroundColor:e.palette.secondary.main},form:{width:"100%",marginTop:e.spacing(1)},submit:{margin:e.spacing(3,0,2)},maindiv:{backgroundImage:"url(".concat(vn.a,")")}}});function On(e){var t=yn(),a=Object(o.useState)(!1),n=Object(x.a)(a,2),i=n[0],c=n[1],l=Object(o.useState)(null),s=Object(x.a)(l,2),u=s[0],m=s[1];return i?r.a.createElement(Qa,{message:"sending reset link to the email address"}):r.a.createElement(ee.a,{container:!0,component:"main",className:t.root},r.a.createElement(gn.a,null),r.a.createElement(ee.a,{item:!0,xs:!1,sm:4,md:7,className:t.image}),r.a.createElement(ee.a,{item:!0,xs:12,sm:8,md:5,component:I.a,elevation:6,square:!0},r.a.createElement("div",{className:t.paper},r.a.createElement("div",null,r.a.createElement("h2",{className:"w3-text-red"},"AUTO"),r.a.createElement("h2",null,"ANNOTATION")),r.a.createElement(fn.a,{component:"h1",variant:"h5"},"FORGOT PASSWORD"),r.a.createElement("form",{className:t.form},r.a.createElement(Je.a,{variant:"outlined",margin:"normal",fullWidth:!0,id:"email",label:"Email Address",name:"email",autoComplete:"email",onChange:function(e){m(e.target.value)},autoFocus:!0,required:!0}),r.a.createElement(lt.a,{type:"submit",fullWidth:!0,onClick:function(e){e.preventDefault(),null!=u?(c(!0),b.a.post("/user/forgot-password",{email:u}).then(function(e){(e.data.message="recovery mail sent")&&(c(!1),tn()({title:"Recovery mail sent check yor mail",icon:"success",buttons:!0}))}).catch(function(e){c(!1),tn()({title:e.message,icon:"warning",buttons:!0})})):tn()({title:"All fields are Mandatory",icon:"warning",buttons:!0})},variant:"contained",color:"primary",className:t.submit},"submit"),r.a.createElement(pn.a,{mt:5},r.a.createElement(En,null))))))}var wn={margin:"1em",fontSize:"24px"},xn=function(e){function t(){var e;return Object(s.a)(this,t),(e=Object(m.a)(this,Object(d.a)(t).call(this))).state={username:"",password:"",confirmPassword:"",updated:!1,isLoading:!0,error:!1},e.handleSubmit=e.handleSubmit.bind(Object(h.a)(Object(h.a)(e))),e.handleChange=e.handleChange.bind(Object(h.a)(Object(h.a)(e))),e}return Object(g.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=Object(O.a)(y.a.mark(function e(){var t,a;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props.match.params.token,e.prev=1,e.next=4,b.a.get("/user/reset",{params:{resetPasswordToken:t}});case 4:"password reset link a-ok"===(a=e.sent).data.message&&(console.log(a.data.username),this.setState({username:a.data.username,updated:!1,isLoading:!1,error:!1})),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(1),console.log(e.t0.response.data),this.setState({updated:!1,isLoading:!1,error:!0});case 12:case"end":return e.stop()}},e,this,[[1,8]])}));return function(){return e.apply(this,arguments)}}()},{key:"handleChange",value:function(e){console.log(e.target.name),this.setState(Object(_t.a)({},e.target.name,e.target.value))}},{key:"handleSubmit",value:function(){var e=Object(O.a)(y.a.mark(function e(t){var a,n,o,r,i;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),a=this.state,n=a.username,o=a.password,r=this.props.match.params.token,e.prev=3,e.next=6,b.a.put("/user/forgot-password-update",{username:n,password:o,resetPasswordToken:r});case 6:i=e.sent,console.log(i.data),"password reset successfully"===i.data.message?(this.setState({updated:!0,error:!1}),this.props.history.push("/")):this.setState({updated:!1,error:!0}),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(3),console.log(e.t0.response.data);case 14:case"end":return e.stop()}},e,this,[[3,11]])}));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state,t=e.password,a=e.error,n=e.isLoading,o=e.updated,i=e.confirmPassword;return a?r.a.createElement("div",null,r.a.createElement("div",{style:wn},r.a.createElement("h4",null,"Problem resetting password. Please send another reset link."))):n?r.a.createElement("div",null,r.a.createElement("div",{style:wn},"Loading User Data...")):r.a.createElement("div",null,r.a.createElement("h4",null,"Reset Password"),r.a.createElement("form",{className:"form-horizontal",onSubmit:this.handleSubmit},r.a.createElement("div",{className:"form-group"},r.a.createElement("div",{className:"col-1 col-ml-auto"},r.a.createElement("label",{className:"form-label",htmlFor:"password"},"New Password")),r.a.createElement("div",{className:"col-3 col-mr-auto"},r.a.createElement("input",{className:"form-input",placeholder:"password",type:"password",name:"password",value:t,onChange:this.handleChange,required:"required"}))),r.a.createElement("div",{className:"form-group"},r.a.createElement("div",{className:"col-1 col-ml-auto"},r.a.createElement("label",{className:"form-label",htmlFor:"username"},"Confirm New Password")),r.a.createElement("div",{className:"col-3 col-mr-auto"},r.a.createElement("input",{className:"form-input",type:"password",name:"confirmPassword",placeholder:"Confirm Password",value:i,onChange:this.handleChange,required:"required"}))),r.a.createElement("div",{className:"form-group "},r.a.createElement("div",{className:"col-7"}),r.a.createElement("button",{className:"btn btn-primary col-1 col-mr-auto",type:"submit"},"Submit"))),o&&r.a.createElement("div",null,r.a.createElement("p",null,"Your password has been successfully reset, please try logging in again.")))}}]),t}(o.Component),jn=Object(p.g)(xn);function In(){return r.a.createElement(fn.a,{variant:"body2",color:"textSecondary",align:"center"},"Copyright \xa9 ",r.a.createElement(hn.a,{color:"inherit",href:"https://fluxauto.xyz/"},"www.fluxauto.xyz")," ",(new Date).getFullYear(),".")}var _n=Object(j.a)(function(e){return{root:{height:"100vh"},image:{backgroundImage:"url(".concat(on.a,")"),backgroundRepeat:"no-repeat",backgroundColor:"black",backgroundSize:"500px 500px",backgroundPosition:"center"},paper:{margin:e.spacing(8,4),display:"flex",flexDirection:"column",alignItems:"center"},avatar:{margin:e.spacing(1),backgroundColor:e.palette.secondary.main},form:{width:"100%",marginTop:e.spacing(1)},submit:{margin:e.spacing(3,0,2)},maindiv:{backgroundImage:"url(".concat(vn.a,")")}}});function Nn(e){var t=_n(),a=Object(o.useState)(!1),n=Object(x.a)(a,2),i=n[0],c=n[1],l=Object(o.useState)(""),s=Object(x.a)(l,2),u=s[0],m=s[1],d=Object(o.useState)(""),g=Object(x.a)(d,2),h=g[0],f=g[1],v=Object(o.useState)(""),E=Object(x.a)(v,2),y=E[0],O=E[1],w=Object(o.useState)(null),j=Object(x.a)(w,2),_=j[0],N=j[1],S=Object(o.useState)(""),T=Object(x.a)(S,2),C=T[0],k=T[1],A=Object(o.useState)(""),M=Object(x.a)(A,2),L=M[0],R=M[1],P=Object(o.useState)(""),D=Object(x.a)(P,2),W=D[0],B=D[1],G=Object(o.useState)(null),z=Object(x.a)(G,2),H=z[0],V=z[1];return _?r.a.createElement(p.a,{to:{pathname:_}}):i?r.a.createElement(Qa,{message:"signing up please wait"}):r.a.createElement(ee.a,{container:!0,component:"main",className:t.root},r.a.createElement(gn.a,null),r.a.createElement(ee.a,{item:!0,xs:!1,sm:4,md:7,className:t.image}),r.a.createElement(ee.a,{item:!0,xs:12,sm:8,md:5,component:I.a,elevation:6,square:!0},r.a.createElement("div",{className:t.paper},r.a.createElement("div",null,r.a.createElement("h2",{className:"w3-text-red"},"AUTO"),r.a.createElement("h2",null,"ANNOTATION")),r.a.createElement(fn.a,{component:"h1",variant:"h5"},"Sign up"),r.a.createElement("form",{className:t.form},r.a.createElement(ee.a,{container:!0,spacing:2},r.a.createElement(ee.a,{item:!0,xs:12,sm:6},r.a.createElement(Je.a,{autoComplete:"fname",name:"firstName",variant:"outlined",required:!0,fullWidth:!0,id:"firstName",onChange:function(e){k(e.target.value)},label:"First Name",autoFocus:!0})),r.a.createElement(ee.a,{item:!0,xs:12,sm:6},r.a.createElement(Je.a,{variant:"outlined",required:!0,fullWidth:!0,id:"lastName",label:"Last Name",name:"lastName",onChange:function(e){R(e.target.value)},autoComplete:"lname"}))),r.a.createElement(Je.a,{autoComplete:"uname",margin:"normal",onChange:function(e){m(e.target.value)},name:"username",variant:"outlined",required:!0,fullWidth:!0,id:"username",label:"User Name",autoFocus:!0}),r.a.createElement(Je.a,{variant:"outlined",margin:"normal",fullWidth:!0,id:"email",label:"Email Address",name:"email",autoComplete:"email",onChange:function(e){V(e.target.value)},autoFocus:!0,required:!0}),r.a.createElement(Je.a,{variant:"outlined",margin:"normal",fullWidth:!0,id:"mobile",label:"Phone",name:"mobile",autoComplete:"mobile",onChange:function(e){B(e.target.value)},autoFocus:!0,required:!0}),r.a.createElement(ee.a,{container:!0,spacing:2},r.a.createElement(ee.a,{item:!0,xs:12,sm:6},r.a.createElement(Je.a,{variant:"outlined",margin:"normal",fullWidth:!0,name:"password",label:"Password",type:"password",id:"password",onChange:function(e){f(e.target.value)},autoComplete:"current-password",required:!0})),r.a.createElement(ee.a,{item:!0,xs:12,sm:6},r.a.createElement(Je.a,{variant:"outlined",margin:"normal",fullWidth:!0,name:"confirmPassword",label:"Confirm Password",type:"password",id:"password",onChange:function(e){O(e.target.value)},autoComplete:"current-password",required:!0}))),r.a.createElement(lt.a,{type:"submit",fullWidth:!0,onClick:function(e){console.log("sign-up handleSubmit, username: "),console.log(u),e.preventDefault(),u&&h&&y&&W&&H&&C&&null!==L?h!==y?alert("Passwords did not match"):(c(!0),b.a.post("/user/",{username:u,password:h,confirmPassword:y,firstName:C,lastName:L,email:H,mobile:W}).then(function(e){e.data.error?(c(!1),tn()({title:"username already exists",icon:"warning",buttons:!0})):(c(!1),console.log("successful signup"),N("/"))}).catch(function(e){c(!1);var t=e.response.data.errors;tn()({title:t[0].msg,icon:"warning",buttons:!0})})):tn()({title:"All fields are Mandatory",icon:"warning",buttons:!0})},variant:"contained",color:"primary",className:t.submit},"Sign Up"),r.a.createElement(ee.a,{container:!0},r.a.createElement(ee.a,{item:!0},r.a.createElement(hn.a,{href:"/",variant:"body2"},"Have an account? Sign In"))),r.a.createElement(pn.a,{mt:5},r.a.createElement(In,null))))))}var Sn=function(){return r.a.createElement("div",null,r.a.createElement(p.d,null,r.a.createElement(p.b,{exact:!0,path:"/signup",component:Nn}),r.a.createElement(p.b,{exact:!0,path:"/forgot-password",component:On}),r.a.createElement(p.b,{exact:!0,path:"/reset/:token",component:jn})))};function Tn(){return r.a.createElement(fn.a,{variant:"body2",color:"textSecondary",align:"center"},"Copyright \xa9 ",r.a.createElement(hn.a,{color:"inherit",href:"https://fluxauto.xyz/"},"www.fluxauto.xyz")," ",(new Date).getFullYear(),".")}var Cn=Object(j.a)(function(e){return{root:{height:"100vh"},image:{backgroundImage:"url(".concat(on.a,")"),backgroundRepeat:"no-repeat",backgroundColor:"black",backgroundSize:"500px 500px",backgroundPosition:"center"},paper:{margin:e.spacing(8,4),display:"flex",flexDirection:"column",alignItems:"center"},avatar:{margin:e.spacing(1),backgroundColor:e.palette.secondary.main},form:{width:"100%",marginTop:e.spacing(1)},submit:{margin:e.spacing(3,0,2)},maindiv:{backgroundImage:"url(".concat(vn.a,")")}}});var kn=Object(p.g)(function(e){var t=Cn(),a=Object(o.useState)(!1),n=Object(x.a)(a,2),i=n[0],c=n[1],l=Object(o.useState)(null),s=Object(x.a)(l,2),u=s[0],m=s[1],d=Object(o.useState)(null),g=Object(x.a)(d,2),h=g[0],f=g[1],v=Object(o.useState)(null),E=Object(x.a)(v,2),y=E[0],O=E[1],w=function(e){switch(e.message){case"Request failed with status code 401":return"Incorect Username or Password";default:return e.message}};return localStorage.getItem("jwt")&&b.a.get("/user",{headers:{Authorization:"bearer ".concat(localStorage.getItem("jwt"))}}).then(function(t){200===t.status&&(e.updateUser({loggedIn:!0,username:t.data.username}),O("/user"))}).catch(function(e){c(!1),alert("login in again session expired")}),y?r.a.createElement(p.a,{to:{pathname:y}}):i?r.a.createElement(Qa,{message:"logging in please wait"}):r.a.createElement(ee.a,{container:!0,component:"main",className:t.root},r.a.createElement(gn.a,null),r.a.createElement(ee.a,{item:!0,xs:!1,sm:4,md:7,className:t.image}),r.a.createElement(ee.a,{item:!0,xs:12,sm:8,md:5,component:I.a,elevation:6,square:!0},r.a.createElement("div",{className:t.paper},r.a.createElement("div",null,r.a.createElement("h2",{className:"w3-text-red"},"AUTO"),r.a.createElement("h2",null,"ANNOTATION")),r.a.createElement(fn.a,{component:"h1",variant:"h5"},"Sign in"),r.a.createElement("form",{className:t.form},r.a.createElement(Je.a,{variant:"outlined",margin:"normal",fullWidth:!0,id:"email",label:"User Name",name:"email",autoComplete:"email",onChange:function(e){m(e.target.value)},autoFocus:!0,required:!0}),r.a.createElement(Je.a,{variant:"outlined",margin:"normal",fullWidth:!0,name:"password",label:"Password",type:"password",id:"password",onChange:function(e){f(e.target.value)},autoComplete:"current-password",required:!0}),r.a.createElement(lt.a,{type:"submit",fullWidth:!0,onClick:function(t){t.preventDefault();var a=e.history;u&&null!==h?(c(!0),b.a.post("/user/login",{username:u,password:h}).then(function(t){200===t.status&&(c(!1),e.updateUser({loggedIn:!0,username:t.data.username}),localStorage.setItem("jwt",t.data.token),O("/user"))}).catch(function(e){c(!1),tn()({title:w(e),icon:"warning",buttons:!0}),a.push("/")})):tn()({title:"All fields are Mandatory",icon:"warning",buttons:!0})},variant:"contained",color:"primary",className:t.submit},"Sign In"),r.a.createElement(ee.a,{container:!0},r.a.createElement(ee.a,{item:!0,xs:!0},r.a.createElement(hn.a,{href:"/forgot-password",variant:"body2"},"Forgot password?")),r.a.createElement(ee.a,{item:!0},r.a.createElement(hn.a,{href:"/signup",variant:"body2"},"Don't have an account? Sign Up"))),r.a.createElement(pn.a,{mt:5},r.a.createElement(Tn,null))))))}),An=function(e){function t(){var e;return Object(s.a)(this,t),(e=Object(m.a)(this,Object(d.a)(t).call(this))).state={loggedIn:!1,username:null},e.updateUser=e.updateUser.bind(Object(h.a)(Object(h.a)(e))),e}return Object(g.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=localStorage.getItem("jwt");b.a.get("/user",{headers:{Authorization:"bearer ".concat(t)}}).then(function(t){t.data.user&&e.setState({loggedIn:!0})}).catch(function(e){"jwt expired"!==e.response.data.message||alert("Token has Expired please LogIn again")})}},{key:"updateUser",value:function(e){this.setState(e)}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"App"},r.a.createElement(p.b,{exact:!0,path:"/user",render:function(){return r.a.createElement(dn,{updateUser:e.updateUser,loggedIn:e.state.loggedIn})}}),r.a.createElement(p.b,{exact:!0,path:"/",render:function(){return r.a.createElement(kn,{updateUser:e.updateUser})}}),r.a.createElement(Sn,null))}}]),t}(o.Component);c.a.render(r.a.createElement(l.a,null,r.a.createElement(An,null)),document.getElementById("root"))},88:function(e,t,a){e.exports=a.p+"static/media/logo.00d8ec7f.png"}},[[275,1,2]]]);
//# sourceMappingURL=main.da05a4fe.chunk.js.map