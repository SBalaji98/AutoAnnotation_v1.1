(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{116:function(e,t,a){e.exports=a.p+"static/media/carback.d753e984.jpg"},188:function(e,t,a){},218:function(e,t){},275:function(e,t,a){e.exports=a(501)},498:function(e,t,a){},499:function(e,t,a){},501:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(16),i=a.n(o),c=(a(188),a(46)),l=a(47),s=a(57),u=a(61),m=a(58),d=a(62),g=a(74),h=a(91),f=a(41),p=a.n(f),b=a(14),v=a(24),y=a.n(v),E=a(66),O=a(11),w=a(10),x=a(539),j=a(542),I=a(233),S=a.n(I),_=a(506),N=a(544),T=a(105),C=a(40),k=a.n(C),A=a(26),M=Object(x.a)({container:{margin:8},header:{display:"flex",flexDirection:"row",alignItems:"center",padding:8,paddingLeft:16,paddingRight:16},title:{fontSize:14,fontWeight:"bold",flexGrow:1,paddingLeft:8,color:T.a[800],"& span":{color:T.a[600],fontSize:12}},expandButton:{padding:0,width:30,height:30,"& .icon":{marginTop:-6,width:20,height:20,transition:"500ms transform","&.expanded":{transform:"rotate(180deg)"}}},expandedContent:{maxHeight:300,overflowY:"auto","&.noScroll":{overflowY:"visible",overflow:"visible"}}}),L=Object(n.memo)(function(e){var t=e.icon,a=e.title,o=e.subTitle,i=e.children,c=e.noScroll,l=void 0!==c&&c,s=e.expandedByDefault,u=void 0!==s&&s,m=M(),d=r.a.createElement("div",{className:k()(m.expandedContent,l&&"noScroll")},i),g=Object(n.useState)(u),h=Object(w.a)(g,2),f=h[0],p=h[1],b=Object(A.a)(function(){return p(!f)});return r.a.createElement(j.a,{className:m.container},r.a.createElement("div",{className:m.header},t,r.a.createElement("div",{className:m.title},a," ",r.a.createElement("span",null,o)),r.a.createElement(_.a,{onClick:b,className:m.expandButton},r.a.createElement(S.a,{className:k()("icon",f&&"expanded")}))),l?f?d:null:r.a.createElement(N.a,{in:f},d))},function(e,t){return e.title===t.title&&e.children===t.children}),R=a(123),P=a.n(R),D=a(260),W=a(138),B=a.n(W),G=Object(D.a)("div")({paddingLeft:16,paddingRight:16,fontSize:12,"& h1":{fontSize:18},"& h2":{fontSize:14},"& h3":{fontSize:12},"& h4":{fontSize:12},"& h5":{fontSize:12},"& h6":{fontSize:12},"& p":{fontSize:12},"& a":{},"& img":{width:"100%"}}),z=(Object(n.memo)(function(e){var t=e.description;return r.a.createElement(L,{title:"Task Description",icon:r.a.createElement(P.a,{style:{color:T.a[700]}}),expandedByDefault:!0},r.a.createElement(G,null,r.a.createElement(B.a,{source:t})))}),a(234)),H=a.n(z),V=a(545),U=a(546),F=a(217),Y=a(79),J=a.n(Y),q=Object(x.a)({img:{width:40,height:40,borderRadius:8}}),K=function(e){return[e.name,(e.regions||[]).length,e.src]},X=Object(n.memo)(function(e){var t=e.images,a=e.onSelect,n=q();return r.a.createElement(L,{title:"Images",subTitle:"(".concat(t.length,")"),icon:r.a.createElement(H.a,{style:{color:T.a[700]}})},r.a.createElement("div",null,r.a.createElement(V.a,null,t.map(function(e,t){return r.a.createElement(U.a,{button:!0,onClick:function(){return a(e)},dense:!0,key:t},r.a.createElement("img",{className:n.img,src:e.src}),r.a.createElement(F.a,{primary:e.name,secondary:"".concat((e.regions||[]).length," Labels")}))}))))},function(e,t){return J()(e.images.map(K),t.images.map(K))}),Z=a(239),$=a.n(Z),Q=a(547),ee=a(235),te=a.n(ee),ae=a(236),ne=a.n(ae),re=a(86),oe=a.n(re),ie=a(113),ce=a.n(ie),le=a(237),se=a.n(le),ue=a(169),me=a.n(ue),de=a(238),ge=a.n(de),he=a(110),fe={container:{fontSize:11,fontWeight:"bold",color:T.a[700],"& .icon":{marginTop:4,width:16,height:16},"& .icon2":{opacity:.5,width:16,height:16,transition:"200ms opacity","&:hover":{cursor:"pointer",opacity:1}}},row:{padding:4,cursor:"pointer","&.header:hover":{backgroundColor:"#fff"},"&.highlighted":{backgroundColor:he.a[100]},"&:hover":{backgroundColor:he.a[50],color:T.a[800]}},chip:{display:"flex",flexDirection:"row",padding:2,borderRadius:2,paddingLeft:4,paddingRight:4,alignItems:"center","& .color":{borderRadius:5,width:10,height:10,marginRight:4},"& .text":{}}},pe=Object(x.a)(fe),be=Object(D.a)("div")({borderTop:"1px solid ".concat(T.a[200]),marginTop:2,marginBottom:2}),ve=function(e){var t=e.color,a=e.text,n=pe();return r.a.createElement("span",{className:n.chip},r.a.createElement("div",{className:"color",style:{backgroundColor:t}}),r.a.createElement("div",{className:"text"},a))},ye=function(e){var t=e.header,a=e.highlighted,o=e.order,i=e.classification,c=e.area,l=(e.tags,e.trash),s=e.lock,u=e.visible,m=e.onClick,d=pe(),g=Object(n.useState)(!1),h=Object(w.a)(g,2),f=(h[0],h[1]);return r.a.createElement("div",{onClick:m,onMouseEnter:function(){return f(!0)},onMouseLeave:function(){return f(!1)},className:k()(d.row,{header:t,highlighted:a})},r.a.createElement(Q.a,{container:!0,alignItems:"center"},r.a.createElement(Q.a,{item:!0,xs:2},r.a.createElement("div",{style:{textAlign:"right",paddingRight:10}},o)),r.a.createElement(Q.a,{item:!0,xs:5},i),r.a.createElement(Q.a,{item:!0,xs:2},r.a.createElement("div",{style:{textAlign:"right",paddingRight:6}},c)),r.a.createElement(Q.a,{item:!0,xs:1},l),r.a.createElement(Q.a,{item:!0,xs:1},s),r.a.createElement(Q.a,{item:!0,xs:1},u)))},Ee=Object(n.memo)(function(){return r.a.createElement(ye,{header:!0,highlighted:!1,order:r.a.createElement(te.a,{className:"icon"}),classification:r.a.createElement("div",{style:{paddingLeft:10}},"Class"),area:r.a.createElement(ne.a,{className:"icon"}),trash:r.a.createElement(oe.a,{className:"icon"}),lock:r.a.createElement(ce.a,{className:"icon"}),visible:r.a.createElement(me.a,{className:"icon"})})}),Oe=Object(n.memo)(function(e){var t=e.region,a=e.highlighted,n=e.onSelectRegion,o=e.onDeleteRegion,i=e.onChangeRegion,c=(e.visible,e.locked,e.color),l=e.cls,s=e.index;return r.a.createElement(ye,{header:!1,highlighted:a,onClick:function(){return n(t)},order:"#".concat(s+1),classification:r.a.createElement(ve,{text:l||"",color:c||"#ddd"}),area:"",trash:r.a.createElement(oe.a,{onClick:function(){return o(t)},className:"icon2"}),lock:t.locked?r.a.createElement(ce.a,{onClick:function(){return i(Object(O.a)({},t,{locked:!1}))},className:"icon2"}):r.a.createElement(se.a,{onClick:function(){return i(Object(O.a)({},t,{locked:!0}))},className:"icon2"}),visible:t.visible||void 0===t.visible?r.a.createElement(me.a,{onClick:function(){return i(Object(O.a)({},t,{visible:!1}))},className:"icon2"}):r.a.createElement(ge.a,{onClick:function(){return i(Object(O.a)({},t,{visible:!0}))},className:"icon2"})})},function(e,t){return e.highlighted===t.highlighted&&e.visible===t.visible&&e.locked===t.locked&&e.id===t.id&&e.index===t.index&&e.cls===t.cls&&e.color===t.color}),we=function(e){return[e.id,e.color,e.locked,e.visible,e.highlighted]},xe=Object(n.memo)(function(e){var t=e.regions,a=e.onDeleteRegion,n=e.onChangeRegion,o=e.onSelectRegion,i=pe();return r.a.createElement(L,{title:"Regions",subTitle:"",icon:r.a.createElement($.a,{style:{color:T.a[700]}}),expandedByDefault:!0},r.a.createElement("div",{className:i.container},r.a.createElement(Ee,null),r.a.createElement(be,null),t.map(function(e,t){return r.a.createElement(Oe,Object.assign({key:e.id},e,{region:e,index:t,onSelectRegion:o,onDeleteRegion:a,onChangeRegion:n}))})))},function(e,t){return J()(e.regions.map(we),t.regions.map(we))}),je=a(240),Ie=a.n(je),Se=a(548),_e=a(166),Ne=a.n(_e),Te=a(114),Ce=a.n(Te),ke=Object(x.a)({emptyText:{fontSize:14,fontWeight:"bold",color:T.a[500],textAlign:"center",padding:20}}),Ae=Object(n.memo)(function(e){var t=e.history,a=e.onRestoreHistory,n=ke();return r.a.createElement(L,{title:"History",icon:r.a.createElement(Ie.a,{style:{color:T.a[700]}}),expandedByDefault:!0},r.a.createElement(V.a,null,0===t.length&&r.a.createElement("div",{className:n.emptyText},"No History Yet"),t.map(function(e,t){var n=e.name,o=e.time;return r.a.createElement(U.a,{button:!0,dense:!0,key:t},r.a.createElement(F.a,{primary:n,secondary:Ce()(o).format("LT")}),0===t&&r.a.createElement(Se.a,{onClick:function(){return a()}},r.a.createElement(_.a,null,r.a.createElement(Ne.a,null))))})))},function(e,t){return J()(e.history.map(function(e){return[e.name,e.time]}),t.history.map(function(e){return[e.name,e.time]}))}),Me=function(e){var t=e.state,a=e.lastAction,n=(t.images||[]).find(function(e){return e.src===t.selectedImage}),o=n?(n.regions||[]).find(function(e){return e.highlighted}):null;return r.a.createElement(L,{title:"Debug",icon:r.a.createElement("span",null),expandedByDefault:!0},r.a.createElement("div",{style:{padding:4}},r.a.createElement("div",null,r.a.createElement("b",null,"region"),":"),r.a.createElement("pre",null,JSON.stringify(o,null,"  ")),r.a.createElement("div",null,r.a.createElement("b",null,"lastAction"),":"),r.a.createElement("pre",null,JSON.stringify(a,null,"  ")),r.a.createElement("div",null,r.a.createElement("b",null,"mode"),":"),r.a.createElement("pre",null,JSON.stringify(t.mode,null,"  ")),r.a.createElement("div",null,r.a.createElement("b",null,"frame:")),r.a.createElement("pre",null,JSON.stringify(t.selectedImageFrameTime,null,"  "))))},Le=a(241),Re=a.n(Le),Pe=a(65),De=a(8),We=a.n(De),Be=(Object(x.a)({}),[]),Ge=Object(n.memo)(function(e){var t=e.currentImage,a=e.imageClsList,o=void 0===a?Be:a,i=e.imageTagList,c=void 0===i?Be:i,l=e.onChangeImage;if(!t)return null;var s=t.tags,u=void 0===s?[]:s,m=t.cls,d=void 0===m?null:m,g=Object(A.a)(function(e){return l({cls:e.value})}),h=Object(A.a)(function(e){return l({tags:e.map(function(e){return e.value})})}),f=Object(n.useMemo)(function(){return d?{value:d,label:d}:null},[d]),p=Object(n.useMemo)(function(){return Object(De.asMutable)(o.map(function(e){return{value:e,label:e}}))},[o]),b=Object(n.useMemo)(function(){return Object(De.asMutable)(c.map(function(e){return{value:e,label:e}}))},[c]),v=Object(n.useMemo)(function(){return u.map(function(e){return{value:e,label:e}})},[u]);return r.a.createElement(L,{title:"Image Tags",expandedByDefault:!0,noScroll:!0,icon:r.a.createElement(Re.a,{style:{color:T.a[700]}})},o.length>0&&r.a.createElement("div",{style:{padding:8}},r.a.createElement(Pe.a,{placeholder:"Image Classification",onChange:g,value:f,options:p})),c.length>0&&r.a.createElement("div",{style:{padding:8,paddingTop:0}},r.a.createElement(Pe.a,{isMulti:!0,placeholder:"Image Tags",onChange:h,value:v,options:b})))},function(e,t){return e.currentImage.cls===t.currentImage.cls&&e.currentImage.tags===t.currentImage.tags&&e.imageClsList===t.imageClsList&&e.imageTagList===t.imageTagList}),ze=a(242),He=a.n(ze),Ve=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(e<1e3)return e+"ms";var a=e/1e3;if(a<60)return Number.isInteger(a)?a+"s":a.toFixed(t)+"s";var n=a/60;return Number.isInteger(n)?n+"m":n.toFixed(t)+"m"},Ue=Object(D.a)("div")({cursor:"pointer",display:"flex",alignItems:"center",padding:8,fontSize:14,color:T.a[700],"&.current":{backgroundColor:he.a[100]},"&:hover":{backgroundColor:T.a[100]},"& .time":{flexGrow:1,fontWeight:"bold","& .regionCount":{marginLeft:8,fontWeight:"normal",color:T.a[500]}},"& .trash":{"& .icon":{fontSize:18,color:T.a[600],transition:"transform 80ms","&:hover":{color:T.a[800],transform:"scale(1.25,1.25)"}}}}),Fe=function(e){var t=e.currentVideoTime,a=e.keyframes,n=e.onChangeVideoTime,o=e.onDeleteKeyframe,i=Object.keys(a).map(function(e){return parseInt(e)});return r.a.createElement(L,{title:"Keyframes",subTitle:"",icon:r.a.createElement(He.a,{style:{color:T.a[700]}}),expandedByDefault:!0},i.map(function(e){return r.a.createElement(Ue,{fullWidth:!0,key:e,className:t===e?"current":"",onClick:function(){return n(e)}},r.a.createElement("div",{className:"time"},Ve(e,2),r.a.createElement("span",{className:"regionCount"},"(",(a[e].regions||[]).length,")")),r.a.createElement("div",{className:"trash"},r.a.createElement(oe.a,{onClick:function(t){o(e),t.stopPropagation()},className:"icon"})))}))},Ye=a(228),Je=(Object(x.a)({shortcutKeyFieldWrapper:{paddingTop:8,display:"inline-flex",width:"100%"},shortcutKeyText:{lineHeight:0},shortcutTextfield:{width:"100%",boxSizing:"border-box",textAlign:"center"}}),a(261)),qe=a(559),Ke=Object(D.a)("div")({"& > div":{width:"100%",height:"100%"}}),Xe=function(e){var t=e.children,a=Object(Je.a)(e,["children"]),o=Object(n.useState)(!1),i=Object(w.a)(o,2),c=i[0],l=i[1],s=Object(A.a)(function(e){c||l(!0),a.onMouseMove&&a.onMouseMove(e)}),u=Object(A.a)(function(e){setTimeout(function(){c&&l(!1)},100)});return r.a.createElement(Ke,Object.assign({},a,{onMouseMove:s,onMouseLeave:u}),r.a.createElement(qe.a,{enabled:c,removeScrollBar:!1},t))},Ze=a(243),$e=a.n(Ze),Qe=function(e){var t=e.handlePreview,a=e.previewImages;return r.a.createElement(L,{title:"Review",icon:r.a.createElement($e.a,{style:{color:T.a[700]}}),expandedByDefault:!0},a.length>0&&r.a.createElement("table",{className:"w3-table"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"sl.No"),r.a.createElement("th",null,"Images"))),r.a.createElement("tbody",null,a.map(function(e,a){return r.a.createElement("tr",{onClick:function(){return t(e)}},r.a.createElement("td",null,a+1),r.a.createElement("td",{className:"w3-hover-grey"},e))}))))},et=(Object(n.memo)(Qe),a(218),function(e){var t=e.allowed_metadata,a=e.metadata,n=e.onChange;return r.a.createElement(L,{title:"Meta Data",icon:r.a.createElement(P.a,{style:{color:T.a[700]}}),expandedByDefault:!0},r.a.createElement("label",null,"Climate"),r.a.createElement(Pe.a,{className:"w3-margin-bottom w3-margin-left w3-margin-right",placeholder:"Classification",onChange:function(e){return n(Object(O.a)({},a,{climate:e.value}))},value:a.climate?{label:a.climate,value:a.climate}:null,options:Object(De.asMutable)(t.climate.map(function(e){return{value:e,label:e}}))}),r.a.createElement("label",null,"Road"),r.a.createElement(Pe.a,{className:"w3-margin-bottom w3-margin-left w3-margin-right",placeholder:"Classification",onChange:function(e){return n(Object(O.a)({},a,{road:e.value}))},value:a.road?{label:a.road,value:a.road}:null,options:Object(De.asMutable)(t.road.map(function(e){return{value:e,label:e}}))}),r.a.createElement("label",null,"Time of Day"),r.a.createElement(Pe.a,{className:"w3-margin-bottom w3-margin-left w3-margin-right",placeholder:"Classification",onChange:function(e){return n(Object(O.a)({},a,{time_of_day:e.value}))},value:a.time_of_day?{label:a.time_of_day,value:a.time_of_day}:null,options:Object(De.asMutable)(t.time_of_day.map(function(e){return{value:e,label:e}}))}),r.a.createElement("label",null,"Area"),r.a.createElement(Pe.a,{className:"w3-margin-bottom w3-margin-left w3-margin-right",placeholder:"Classification",onChange:function(e){return n(Object(O.a)({},a,{area:e.value}))},value:a.area?{label:a.area,value:a.area}:null,options:Object(De.asMutable)(t.area.map(function(e){return{value:e,label:e}}))}),r.a.createElement("div",null,r.a.createElement("label",null,"Number of Lanes"),r.a.createElement("input",{className:"w3-button w3-border w3-margin-bottom",placeholder:"no. of Lanes",type:"number",onChange:function(e){return n(Object(O.a)({},a,{no_of_lanes:e.currentTarget.value}))}})),r.a.createElement("div",null,r.a.createElement("label",null,"Number of classes"),r.a.createElement("input",{className:"w3-button w3-border w3-margin-bottom ",placeholder:"no. of classes",type:"number",onChange:function(e){return n(Object(O.a)({},a,{no_of_classes:e.currentTarget.value}))}})))}),tt=(Object(n.memo)(et),Object(x.a)({})),at=[],nt=function(e){var t=e.metadata,a=e.allowed_metadata,n=e.preview,o=e.previewList,i=e.debug,c=(e.taskDescription,e.keyframes),l=e.images,s=e.regions,u=e.history,m=e.labelImages,d=e.currentImage,g=e.currentVideoTime,h=e.imageClsList,f=e.imageTagList,p=e.onChangeMetadata,b=e.onChangeImage,v=e.onSelectRegion,y=e.onSelectImage,E=e.onChangeRegion,O=e.onDeleteRegion,w=e.onRestoreHistory,x=e.onChangeVideoTime,j=e.onDeleteKeyframe;e.onShortcutActionDispatched,tt();return s||(s=at),r.a.createElement("div",null,r.a.createElement(et,{allowed_metadata:a,metadata:null===t?{climate:"None",road:"None",time_of_day:"None",area:"None",no_of_classes:0,no_of_lanes:0}:t,onChange:p}),r.a.createElement(Qe,{handlePreview:n,previewImages:o}),i&&r.a.createElement(Me,{state:i,lastAction:i.lastAction}),m&&r.a.createElement(Ge,{currentImage:d,imageClsList:h,imageTagList:f,onChangeImage:b,expandedByDefault:!0}),l&&l.length>1&&r.a.createElement(X,{onSelect:y,images:l}),r.a.createElement(xe,{regions:s,onSelectRegion:v,onChangeRegion:E,onDeleteRegion:O}),r.a.createElement(Ae,{history:u,onRestoreHistory:function(){return w()}}),c&&r.a.createElement(Fe,{currentVideoTime:g,keyframes:c,onChangeVideoTime:x,onDeleteKeyframe:j}))},rt=a(147),ot=(a(444),function(e){var t=e.mousePosition,a=e.x,o=e.y,i=Object(n.useState)(),c=Object(w.a)(i,2),l=(c[0],c[1]);return t&&(a=t.current.x,o=t.current.y),Object(n.useEffect)(function(){if(t){var e=setInterval(function(){a===t.current.x&&o===t.current.y||l([t.current.x,t.current.y])},10);return function(){return clearInterval(e)}}}),r.a.createElement(n.Fragment,null,r.a.createElement("div",{style:{position:"absolute",height:"100%",width:1,zIndex:10,backgroundColor:"#f00",left:a,pointerEvents:"none",top:0}}),r.a.createElement("div",{style:{position:"absolute",width:"100%",zIndex:10,height:1,backgroundColor:"#f00",top:o,pointerEvents:"none",left:0}}))}),it={regionInfo:{fontSize:12,cursor:"default",transition:"opacity 200ms",opacity:.7,"&:hover":{opacity:.9,cursor:"pointer"},"&.highlighted":{opacity:.9,"&:hover":{opacity:1}},fontWeight:600,color:T.a[900],padding:8,"& .name":{display:"flex",flexDirection:"row",alignItems:"center","& .circle":{marginRight:4,boxShadow:"0px 0px 2px rgba(0,0,0,0.4)",width:10,height:10,borderRadius:5}},"& .tags":{"& .tag":{color:T.a[700],display:"inline-block",margin:1,fontSize:10,textDecoration:"underline"}}}},ct=a(219),lt=a(167),st=a.n(lt),ut=Object(x.a)(it),mt=Object(n.memo)(function(e){var t=e.region,a=e.editing,n=e.allowedClasses,o=e.allowedTags,i=e.onDelete,c=e.onChange,l=e.onClose,s=e.onOpen,u=ut();return r.a.createElement(j.a,{onKeyPress:function(e){e.stopPropagation()},onKeyDown:function(e){e.stopPropagation()},onKeyUp:function(e){e.stopPropagation()},onClick:function(){return a?null:s(t)},className:k()(u.regionInfo,{highlighted:t.highlighted})},a?r.a.createElement("div",{style:{width:200}},r.a.createElement("div",{style:{display:"flex",flexDirection:"row"}},r.a.createElement("div",{style:{display:"flex",backgroundColor:t.color,color:"#fff",padding:4,paddingLeft:8,paddingRight:8,borderRadius:4,fontWeight:"bold",textShadow:"0px 0px 5px rgba(0,0,0,0.4)"}},t.type),r.a.createElement("div",{style:{flexGrow:1}}),r.a.createElement(_.a,{onClick:function(){return i(t)},tabIndex:-1,style:{width:22,height:22},size:"small",variant:"outlined"},r.a.createElement(oe.a,{style:{marginTop:-8,width:16,height:16}}))),(n||[]).length>0&&r.a.createElement("div",{style:{marginTop:6}},r.a.createElement(Pe.a,{placeholder:"Classification",onChange:function(e){return c(Object(O.a)({},t,{cls:e.value}))},value:t.cls?{label:t.cls,value:t.cls}:null,options:Object(De.asMutable)(n.map(function(e){return{value:e,label:e}}))})),(o||[]).length>0&&r.a.createElement("div",{style:{marginTop:4}},r.a.createElement(Pe.a,{onChange:function(e){return c(Object(O.a)({},t,{tags:e.map(function(e){return e.value})}))},placeholder:"Tags",value:(t.tags||[]).map(function(e){return{label:e,value:e}}),isMulti:!0,options:Object(De.asMutable)(o.map(function(e){return{value:e,label:e}}))})),r.a.createElement("div",{style:{marginTop:4,display:"flex"}},r.a.createElement("div",{style:{flexGrow:1}}),r.a.createElement(ct.a,{onClick:function(){return l(t)},size:"small",variant:"contained",color:"primary"},r.a.createElement(st.a,null)))):r.a.createElement("div",null,t.cls&&r.a.createElement("div",{className:"name"},r.a.createElement("div",{className:"circle",style:{backgroundColor:t.color}}),t.cls),t.tags&&r.a.createElement("div",{className:"tags"},t.tags.map(function(e){return r.a.createElement("div",{key:e,className:"tag"},e)}))))},function(e,t){return e.editing===t.editing&&e.region.x===t.region.x&&e.region.y===t.region.y&&e.region.tags===t.region.tags&&e.region.cls===t.region.cls&&e.region.color===t.region.color&&e.region.highlighted===t.region.highlighted}),dt=Object(x.a)({"@keyframes borderDance":{from:{strokeDashoffset:0},to:{strokeDashoffset:100}},highlightBox:{zIndex:2,transition:"opacity 500ms","&.highlighted":{zIndex:3},"&:not(.highlighted)":{opacity:0},"&:not(.highlighted):hover":{opacity:.6},"& path":{vectorEffect:"non-scaling-stroke",strokeWidth:2,stroke:"#FFF",fill:"none",strokeDasharray:5,animationName:"$borderDance",animationDuration:"4s",animationTimingFunction:"linear",animationIterationCount:"infinite",animationPlayState:"running"}}}),gt=function(e){var t=e.mouseEvents,a=e.dragWithPrimary,n=e.zoomWithPrimary,o=e.createWithPrimary,i=e.onBeginMovePoint,c=e.onSelectRegion,l=e.region,s=e.pbox,u=dt();return r.a.createElement("svg",Object.assign({key:l.id,className:k()(u.highlightBox,{highlighted:l.highlighted})},t,n||a?{}:{onMouseDown:function(e){return!l.locked&&"point"===l.type&&l.highlighted&&0===e.button?i(l):0!==e.button||o?void t.onMouseDown(e):c(l)}},{style:Object(O.a)({},l.highlighted?{pointerEvents:"point"!==l.type?"none":void 0,cursor:"grab"}:{cursor:n||a||o?void 0:"pointer",pointerEvents:n||a||o&&!l.highlighted?"none":void 0},{position:"absolute",left:s.x-5,top:s.y-5,width:s.w+10,height:s.h+10})}),r.a.createElement("path",{d:"M5,5 L".concat(s.w+5,",5 L").concat(s.w+5,",").concat(s.h+5," L5,").concat(s.h+5," Z")}))},ht=a(562),ft=a(553),pt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1/0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,a="undefined"!==typeof window,r=Object(ht.a)({width:a?window.innerWidth:e,height:a?window.innerHeight:t}),o=Object(w.a)(r,2),i=o[0],c=o[1];return Object(n.useEffect)(function(){if(a){var e=function(){c({width:window.innerWidth,height:window.innerHeight})};return window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}}},[]),Object(ft.a)(function(){a&&(window.innerWidth===i.width&&window.innerHeight===i.height||c({width:window.innerWidth,height:window.innerHeight}))},100),i},bt=function(e){var t=e.canvasEl,a=e.changeMat,r=e.changeDragging,o=e.zoomStart,i=(e.zoomEnd,e.changeZoomStart),c=e.changeZoomEnd,l=e.layoutParams,s=e.zoomWithPrimary,u=e.dragWithPrimary,m=e.mat,d=e.onMouseMove,g=e.onMouseUp,h=e.onMouseDown,f=e.dragging,p=Object(n.useRef)({x:0,y:0}),b=Object(n.useRef)({x:0,y:0}),v=function(e,t){var n=[t.x,t.y],r=n[0],o=n[1],i="object"===typeof e?e.to/m.a:1+.2*e;m.translate(r,o).scaleU(i),m.a>2&&m.scaleU(2/m.a),m.a<.1&&m.scaleU(.1/m.a),m.translate(-r,-o),a(m.clone())};return{mouseEvents:{onMouseMove:function(e){var n=t.current.getBoundingClientRect(),r=n.left,i=n.top;b.current.x=p.current.x,b.current.y=p.current.y,p.current.x=e.clientX-r,p.current.y=e.clientY-i;var u=m.applyToPoint(p.current.x,p.current.y);s&&o&&c(u);var g=l.current,h=g.iw,v=g.ih;d({x:u.x/h,y:u.y/v}),f&&(m.translate(b.current.x-p.current.x,b.current.y-p.current.y),a(m.clone())),e.preventDefault()},onMouseDown:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e.preventDefault(),1===e.button||0===e.button&&u)return r(!0);var a=m.applyToPoint(p.current.x,p.current.y);if(s&&0===e.button)return i(a),void c(a);if(0===e.button){t.type,t.type;var n=l.current,o=n.iw,d=n.ih;h({x:a.x/o,y:a.y/d})}},onMouseUp:function(e){e.preventDefault();var t=m.applyToPoint(p.current.x,p.current.y);if(o){var n=t;if(Math.abs(o.x-n.x)<10&&Math.abs(o.y-n.y)<10)m.a<1?v({to:1},p.current):v({to:.25},p.current);else{var s=l.current,d=s.iw,h=s.ih;if(o.x>n.x){var f=[n.x,o.x];o.x=f[0],n.x=f[1]}if(o.y>n.y){var b=[n.y,o.y];o.y=b[0],n.y=b[1]}var y=Math.min((n.x-o.x)/d,(n.y-o.y)/h);y<.1&&(y=.1),y>10&&(y=10);var E=rt.Matrix.from(1,0,0,1,-10,-10).translate(o.x,o.y).scaleU(y);a(E.clone())}i(null),c(null)}if(1===e.button||0===e.button&&u)return r(!1);if(0===e.button){var O=l.current,w=O.iw,x=O.ih;g({x:t.x/w,y:t.y/x})}},onWheel:function(e){var t=e.deltaY>0?1:e.deltaY<0?-1:0;v(t,p.current)}},mousePosition:p}},vt=function(e){var t=e.layoutParams,a=e.mat;return Object(A.a)(function(e){var n=t.current,r=n.iw,o=n.ih,i=function(e){switch(e.type){case"polygon":var t={x:Math.min.apply(Math,Object(b.a)(e.points.map(function(e){var t=Object(w.a)(e,2),a=t[0];return t[1],a}))),y:Math.min.apply(Math,Object(b.a)(e.points.map(function(e){var t=Object(w.a)(e,2);return t[0],t[1]}))),w:0,h:0};return t.w=Math.max.apply(Math,Object(b.a)(e.points.map(function(e){var t=Object(w.a)(e,2),a=t[0];return t[1],a})))-t.x,t.h=Math.max.apply(Math,Object(b.a)(e.points.map(function(e){var t=Object(w.a)(e,2);return t[0],t[1]})))-t.y,t;case"box":return{x:e.x,y:e.y,w:e.w,h:e.h};case"point":return{x:e.x,y:e.y,w:0,h:0};case"pixel":if(void 0!==e.sx&&void 0!==e.sy&&e.w&&e.h)return{x:e.sx,y:e.sy,w:e.w,h:e.h};if(e.points){var a={x:Math.min.apply(Math,Object(b.a)(e.points.map(function(e){var t=Object(w.a)(e,2),a=t[0];return t[1],a}))),y:Math.min.apply(Math,Object(b.a)(e.points.map(function(e){var t=Object(w.a)(e,2);return t[0],t[1]}))),w:0,h:0};return a.w=Math.max.apply(Math,Object(b.a)(e.points.map(function(e){var t=Object(w.a)(e,2),a=t[0];return t[1],a})))-a.x,a.h=Math.max.apply(Math,Object(b.a)(e.points.map(function(e){var t=Object(w.a)(e,2);return t[0],t[1]})))-a.y,a}}throw new Error("unknown region")}(e),c="point"===e.type?15:2,l={x:i.x*r-c,y:i.y*o-c,w:i.w*r+2*c,h:i.h*o+2*c};return Object(O.a)({},a.clone().inverse().applyToPoint(l.x,l.y),{w:l.w/a.a,h:l.h/a.d})})},yt=Object(D.a)("svg")({pointerEvents:"none",position:"absolute",zIndex:1,left:0,top:0,width:"100%",height:"100%","& text":{fill:"#fff"},"& path":{vectorEffect:"non-scaling-stroke",strokeWidth:2,opacity:.5,stroke:"#FFF",fill:"none",strokeDasharray:5,animationDuration:"4s",animationTimingFunction:"linear",animationIterationCount:"infinite",animationPlayState:"running"}}),Et=function(e){var t=e.projectRegionBox,a=e.regions,o=e.pointDistancePrecision,i=e.realSize;return r.a.createElement(yt,null,a.filter(function(e){return"point"===e.type}).flatMap(function(e,c){return a.filter(function(e,t){return t>c}).filter(function(e){return"point"===e.type}).map(function(a){var c,l=t(e),s=t(a),u={x:(l.x+l.w/2+s.x+s.w/2)/2,y:(l.y+l.h/2+s.y+s.h/2)/2};if(i){var m=i.w,d=i.h,g=i.unitName;c=Math.sqrt(Math.pow(e.x*m-a.x*m,2)+Math.pow(e.y*d-a.y*d,2)).toFixed(o)+g}else c=(100*Math.sqrt(Math.pow(e.x-a.x,2)+Math.pow(e.y-a.y,2))).toFixed(o)+"%";return r.a.createElement(n.Fragment,null,r.a.createElement("path",{d:"M".concat(l.x+l.w/2,",").concat(l.y+l.h/2," L").concat(s.x+s.w/2,",").concat(s.y+s.h/2)}),r.a.createElement("text",{x:u.x,y:u.y},c))})}))},Ot=function(e){var t=e.regions,a=e.projectRegionBox,n=e.mouseEvents,o=e.regionClsList,i=e.regionTagList,c=e.onBeginRegionEdit,l=e.onChangeRegion,s=e.onCloseRegionEdit,u=e.onDeleteRegion,m=e.layoutParams,d=e.imageSrc,g=e.RegionEditLabel,h=null!=g?g:mt;return t.filter(function(e){return e.visible||void 0===e.visible}).map(function(e){var g=a(e),f=m.current,p=(f.iw,f.ih,8);e.highlighted&&"box"===e.type&&(p+=6);var b=e.editingLabels&&!e.locked?170:e.tags?60:50,v=g.y>b,y=v?{left:g.x,top:g.y-p/2}:{left:g.x,top:g.y+g.h+p/2};return e.locked?r.a.createElement("div",{key:e.id,style:Object(O.a)({position:"absolute"},y,{zIndex:10+(e.editingLabels?5:0)})},r.a.createElement(j.a,{style:Object(O.a)({position:"absolute",left:0},v?{bottom:0}:{top:0},{zIndex:10,backgroundColor:"#fff",borderRadius:4,padding:2,paddingBottom:0,opacity:.5,pointerEvents:"none"})},r.a.createElement(ce.a,{style:{width:16,height:16,color:"#333"}}))):r.a.createElement("div",{key:e.id,style:Object(O.a)({position:"absolute"},y,{zIndex:10+(e.editingLabels?5:0),width:200}),onMouseDown:function(e){return e.preventDefault()},onMouseUp:function(e){return e.preventDefault()},onMouseEnter:function(t){e.editingLabels&&(n.onMouseUp(t),t.button=1,n.onMouseUp(t))}},r.a.createElement("div",Object.assign({style:Object(O.a)({position:"absolute",left:0},v?{bottom:0}:{top:0})},e.editingLabels?{}:function(e){for(var t=Object(O.a)({},e),a=arguments.length,n=new Array(a>1?a-1:0),r=1;r<a;r++)n[r-1]=arguments[r];for(var o=0,i=n;o<i.length;o++)delete t[i[o]];return t}(n,"onMouseDown","onMouseUp")),r.a.createElement(h,{allowedClasses:o,allowedTags:i,onOpen:c,onChange:l,onClose:s,onDelete:u,editing:e.editingLabels,region:e,regions:t,imageSrc:d})))})},wt=Object(D.a)("div")({width:8,height:8,zIndex:2,border:"2px solid #FFF",position:"absolute"}),xt=[["nw-resize","n-resize","ne-resize"],["w-resize","grab","e-resize"],["sw-resize","s-resize","se-resize"]],jt=function(e){var t=e.regions,a=e.mouseEvents,o=e.projectRegionBox,i=e.dragWithPrimary,c=e.createWithPrimary,l=e.zoomWithPrimary,s=e.onBeginMovePoint,u=e.onSelectRegion,m=e.layoutParams,d=e.mat,g=e.onBeginBoxTransform,h=e.onBeginMovePolygonPoint,f=e.onAddPolygonPoint;return t.filter(function(e){return e.visible||void 0===e.visible}).filter(function(e){return!e.locked}).map(function(e,t){var p=o(e),b=m.current,v=b.iw,y=b.ih;return r.a.createElement(n.Fragment,{key:e.id},r.a.createElement(Xe,null,r.a.createElement(gt,{region:e,mouseEvents:a,dragWithPrimary:i,createWithPrimary:c,zoomWithPrimary:l,onBeginMovePoint:s,onSelectRegion:u,pbox:p}),"box"===e.type&&!i&&!l&&!e.locked&&e.highlighted&&d.a<1.2&&[[0,0],[.5,0],[1,0],[1,.5],[1,1],[.5,1],[0,1],[0,.5],[.5,.5]].map(function(t,n){var o=Object(w.a)(t,2),i=o[0],c=o[1];return r.a.createElement(wt,Object.assign({key:n},a,{onMouseDown:function(t){if(0===t.button)return g(e,[2*i-1,2*c-1]);a.onMouseDown(t)},style:{left:p.x-4-2+p.w*i,top:p.y-4-2+p.h*c,cursor:xt[2*c][2*i],borderRadius:.5===i&&.5===c?4:void 0}}))}),"polygon"===e.type&&!i&&!l&&!e.locked&&e.highlighted&&e.points.map(function(t,n){var o=Object(w.a)(t,2),i=o[0],c=o[1],l=d.clone().inverse().applyToPoint(i*v,c*y);return r.a.createElement(wt,Object.assign({key:n},a,{onMouseDown:function(t){if(0===t.button&&(!e.open||0===n))return h(e,n);a.onMouseDown(t)},style:{cursor:e.open?0===n?"pointer":void 0:"move",pointerEvents:e.open&&n===e.points.length-1?"none":void 0,left:l.x-4,top:l.y-4}}))}),"polygon"===e.type&&e.highlighted&&!i&&!l&&!e.locked&&!e.open&&e.points.length>1&&e.points.map(function(t,a){return[t,e.points[(a+1)%e.points.length]]}).map(function(e){var t=Object(w.a)(e,2),a=t[0],n=t[1];return[(a[0]+n[0])/2,(a[1]+n[1])/2]}).map(function(t,n){var o=d.clone().inverse().applyToPoint(t[0]*v,t[1]*y);return r.a.createElement(wt,Object.assign({key:n},a,{onMouseDown:function(r){if(0===r.button)return f(e,t,n+1);a.onMouseDown(r)},style:{cursor:"copy",left:o.x-4,top:o.y-4,border:"2px dotted #fff",opacity:.5}}))})))})},It=a(64),St=Object(n.createContext)({showCrosshairs:!1}),_t=function(){return Object(n.useContext)(St)},Nt=function(e){var t=e.children,a=Object(n.useState)(function(){return function(){if(!window||!window.localStorage)return{};for(var e={},t=0;t<window.localStorage.length;t++){var a=window.localStorage.key(t);if(a.startsWith("settings_"))try{e[a.replace("settings_","")]=JSON.parse(window.localStorage.getItem(a))}catch(n){}}return e}()}),o=Object(w.a)(a,2),i=o[0],c=o[1];return r.a.createElement(St.Provider,{value:Object(O.a)({},i,{changeSetting:function(e,t){c(Object(O.a)({},i,Object(It.a)({},e,t))),window.localStorage.setItem("settings_".concat(e),JSON.stringify(t))}})},t)},Tt=Object(D.a)("video")({zIndex:0,position:"absolute"}),Ct=Object(D.a)("img")({zIndex:0,position:"absolute"}),kt=function(e){var t=e.imagePosition,a=e.mouseEvents,o=e.videoTime,i=e.videoSrc,c=e.imageSrc,l=e.onLoad,s=e.videoPlaying,u=e.onChangeVideoTime,m=e.onChangeVideoPlaying,d=_t(),g=Object(n.useRef)(),h=Object(n.useRef)();Object(n.useEffect)(function(){!s&&g.current&&(g.current.currentTime=(o||0)/1e3)},[o]),Object(n.useEffect)(function(){var e=!1;return g.current&&(s?(g.current.play(),e=!0,d.videoPlaybackSpeed&&(g.current.playbackRate=parseFloat(d.videoPlaybackSpeed))):g.current.pause()),function t(){if(e&&g.current){var a=Math.floor(1e3*g.current.currentTime);o!==a&&u(a),g.current.paused&&(e=!1,m(!1)),requestAnimationFrame(t)}}(),function(){e=!1}},[s]);var f=Object(A.a)(function(e){var t=e.currentTarget;t.currentTime=(o||0)/1e3,l&&l({naturalWidth:t.videoWidth,naturalHeight:t.videoHeight,videoElm:t,duration:t.duration})}),p=Object(A.a)(function(e){var t=e.currentTarget;l&&l({naturalWidth:t.naturalWidth,naturalHeight:t.naturalHeight,imageElm:t})}),b=Object(n.useMemo)(function(){var e=t.bottomRight.x-t.topLeft.x,a=t.bottomRight.y-t.topLeft.y;return{left:t.topLeft.x,top:t.topLeft.y,width:isNaN(e)?0:e,height:isNaN(a)?0:a}},[t.topLeft.x,t.topLeft.y,t.bottomRight.x,t.bottomRight.y]);return i||c?c&&void 0===o?r.a.createElement(Ct,Object.assign({},a,{src:c,ref:h,style:b,onLoad:p})):r.a.createElement(Tt,Object.assign({},a,{ref:g,style:b,onLoadedMetadata:f,src:i||c})):"No imageSrc or videoSrc provided"};function At(e){if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(!e)return;if("string"===typeof e)return Mt(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Mt(e,t)}(e))){var t=0,a=function(){};return{s:a,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,r,o=!0,i=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return o=e.done,e},e:function(e){i=!0,r=e},f:function(){try{o||null==n.return||n.return()}finally{if(i)throw r}}}}function Mt(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}var Lt,Rt=Object(x.a)({canvas:{width:"100%",height:"100%",position:"relative",zIndex:1},zoomIndicator:{position:"absolute",bottom:16,right:0,backgroundColor:"rgba(0,0,0,0.4)",color:"#fff",opacity:.5,fontWeight:"bolder",fontSize:14,padding:4}}),Pt=function(e){var t=e.regions,a=e.imageSrc,o=e.videoSrc,i=e.videoTime,c=e.realSize,l=e.showTags,s=e.onMouseMove,u=void 0===s?function(e){return null}:s,m=e.onMouseDown,d=void 0===m?function(e){return null}:m,g=e.onMouseUp,h=void 0===g?function(e){return null}:g,f=e.dragWithPrimary,p=void 0!==f&&f,v=e.zoomWithPrimary,y=void 0!==v&&v,E=e.createWithPrimary,x=void 0!==E&&E,j=e.pointDistancePrecision,I=void 0===j?0:j,S=e.regionClsList,_=e.regionTagList,N=e.showCrosshairs,T=e.showPointDistances,C=e.allowedArea,k=e.RegionEditLabel,M=void 0===k?null:k,L=e.videoPlaying,R=void 0!==L&&L,P=e.onImageOrVideoLoaded,D=e.onChangeRegion,W=e.onBeginRegionEdit,B=e.onCloseRegionEdit,G=e.onBeginBoxTransform,z=e.onBeginMovePolygonPoint,H=e.onAddPolygonPoint,V=e.onSelectRegion,U=e.onBeginMovePoint,F=e.onDeleteRegion,Y=e.onChangeVideoTime,J=e.onChangeVideoPlaying,q=Rt(),K=Object(n.useRef)(null),X=Object(n.useRef)({}),Z=Object(ht.a)(!1),$=Object(w.a)(Z,2),Q=$[0],ee=$[1],te=Object(ht.a)(0),ae=Object(w.a)(te,2),ne=ae[0],re=ae[1],oe=Object(ht.a)(null),ie=Object(w.a)(oe,2),ce=ie[0],le=ie[1],se=Object(ht.a)(null),ue=Object(w.a)(se,2),me=ue[0],de=ue[1],ge=Object(ht.a)(rt.Matrix.from(1,0,0,1,-10,-10)),he=Object(w.a)(ge,2),fe=he[0],pe=he[1],be=Object(n.useRef)({}),ve=pt(),ye=bt({canvasEl:K,dragging:Q,mat:fe,layoutParams:X,changeMat:pe,zoomStart:ce,zoomEnd:me,changeZoomStart:le,changeZoomEnd:de,changeDragging:ee,zoomWithPrimary:y,dragWithPrimary:p,onMouseMove:u,onMouseDown:d,onMouseUp:h}),Ee=ye.mouseEvents,Oe=ye.mousePosition;Object(n.useLayoutEffect)(function(){return pe(fe.clone())},[ve]);fe.applyToPoint(Oe.current.x,Oe.current.y);var we=vt({layoutParams:X,mat:fe}),xe=Object(n.useState)(),je=Object(w.a)(xe,2),Ie=je[0],Se=je[1],_e=Boolean(Ie&&Ie.naturalWidth),Ne=Object(A.a)(function(e){var t={naturalWidth:e.naturalWidth,naturalHeight:e.naturalHeight,duration:e.duration};P&&P(t),Se(t),setTimeout(function(){return Se(t)},10)}),Te=function(){var e=Object(n.useRef)(null);if(null===e.current){e.current={image:new Image,pattern:null};var t=document.createElement("canvas");t.width=100,t.height=100;var a=t.getContext("2d");e.current.image.onload=function(){e.current.pattern=a.createPattern(e.current.image,"repeat")},e.current.image.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAC4jAAAuIwF4pT92AAAAB3RJTUUH4wMSAxY5oG+lzgAAABl0RVh0Q29tbWVudABDcmVhdGVkIHdpdGggR0lNUFeBDhcAAAAcSURBVAjXY/jPwPCfAQnA+TAGugLcAhhakRUAAK3lEe8m9qZhAAAAAElFTkSuQmCC"}return e.current.pattern}(),Ce=K.current;if(Ce&&_e){var ke=Ce.clientWidth,Ae=Ce.clientHeight,Me=Math.max(Ie.naturalWidth/(ke-20),Ie.naturalHeight/(Ae-20)),Le=Ie.naturalWidth/Me,Re=Ie.naturalHeight/Me;X.current={iw:Le,ih:Re,fitScale:Me,canvasWidth:ke,canvasHeight:Ae}}Object(n.useLayoutEffect)(function(){if(Ie){var e=Ce.clientWidth,a=Ce.clientHeight;Ce.width=e,Ce.height=a;var n=Ce.getContext("2d");n.save(),n.transform.apply(n,Object(b.a)(fe.clone().inverse().toArray()));var r=X.current,o=r.iw,i=r.ih;if(C){var c=C.x,l=C.y,s=C.w,u=C.h;n.save(),n.globalAlpha=.25;var m=[[0,0],[o,0],[o,i],[0,i]],d=[[c*o,l*i],[c*o+s*o,l*i],[c*o+s*o,l*i+u*i],[c*o,l*i+u*i]];n.moveTo.apply(n,Object(b.a)(m[0])),m.forEach(function(e){return n.lineTo.apply(n,Object(b.a)(e))}),n.lineTo.apply(n,Object(b.a)(m[0])),n.closePath(),d.reverse(),n.moveTo.apply(n,Object(b.a)(d[0])),d.forEach(function(e){return n.lineTo.apply(n,Object(b.a)(e))}),n.lineTo.apply(n,Object(b.a)(d[0])),n.fillStyle=Te||"#f00",n.fill(),n.restore()}n.save(),n.globalAlpha=.5*fe.a+.5,n.lineWidth=1*fe.a+1,n.globalAlpha>.6&&(n.shadowColor="black",n.shadowBlur=4);var g,h=At(t.filter(function(e){return e.visible||void 0===e.visible}));try{var f=function(){var e=g.value;switch(e.type){case"point":n.save(),n.beginPath(),n.strokeStyle=e.color,n.moveTo(e.x*o-10,e.y*i),n.lineTo(e.x*o-2,e.y*i),n.moveTo(e.x*o+10,e.y*i),n.lineTo(e.x*o+2,e.y*i),n.moveTo(e.x*o,e.y*i-10),n.lineTo(e.x*o,e.y*i-2),n.moveTo(e.x*o,e.y*i+10),n.lineTo(e.x*o,e.y*i+2),n.moveTo(e.x*o+5,e.y*i),n.arc(e.x*o,e.y*i,5,0,2*Math.PI),n.stroke(),n.restore();break;case"box":n.save(),n.shadowColor="black",n.shadowBlur=4,n.strokeStyle=e.color,n.strokeRect(e.x*o,e.y*i,e.w*o,e.h*i),n.restore();break;case"polygon":n.save(),n.shadowColor="black",n.shadowBlur=4,n.strokeStyle=e.color,n.beginPath(),n.moveTo(e.points[0][0]*o,e.points[0][1]*i);var t,a=At(e.points);try{for(a.s();!(t=a.n()).done;){var r=t.value;n.lineTo(r[0]*o,r[1]*i)}}catch(c){a.e(c)}finally{a.f()}e.open||n.closePath(),n.stroke(),n.restore();break;case"pixel":n.save(),be.current[e.src]?"CANVAS"===be.current[e.src].nodeName&&(n.globalAlpha=.6,n.drawImage(be.current[e.src],e.sx*o,e.sy*i,e.w*o,e.h*i)):(be.current[e.src]=new Image,be.current[e.src].onload=function(){var t=be.current[e.src],a=document.createElement("canvas");a.width=t.naturalWidth,a.height=t.naturalHeight;var n=a.getContext("2d");n.drawImage(t,0,0);for(var r=n.getImageData(0,0,t.naturalWidth,t.naturalHeight),o=0;o<r.data.length;o+=4){var i=r.data.slice(o,o+4),c=Object(w.a)(i,4),l=c[0],s=c[1],u=c[2],m=(c[3],l<10&&s<10&&u<10);r.data[o]=0,r.data[o+1]=0,r.data[o+2]=m?255:0,r.data[o+3]=m?255:0}n.clearRect(0,0,t.naturalWidth,t.naturalHeight),n.putImageData(r,0,0),be.current[e.src]=a,re(ne+1)},be.current[e.src].src=e.src),n.restore()}};for(h.s();!(g=h.n()).done;)f()}catch(p){h.e(p)}finally{h.f()}n.restore(),n.restore()}});var Pe=X.current,De=Pe.iw,We=Pe.ih,Be=ce&&me?Object(O.a)({},fe.clone().inverse().applyToPoint(ce.x,ce.y),{w:(me.x-ce.x)/fe.a,h:(me.y-ce.y)/fe.d}):null;Be&&(Be.w<0&&(Be.x+=Be.w,Be.w*=-1),Be.h<0&&(Be.y+=Be.h,Be.h*=-1));var Ge={topLeft:fe.clone().inverse().applyToPoint(0,0),bottomRight:fe.clone().inverse().applyToPoint(De,We)};return r.a.createElement("div",{style:{width:"100%",height:"100%",maxHeight:"calc(100vh - 68px)",position:"relative",overflow:"hidden",cursor:x?"crosshair":Q?"grabbing":p?"grab":y?fe.a<1?"zoom-out":"zoom-in":void 0}},N&&r.a.createElement(ot,{key:"crossHairs",mousePosition:Oe}),_e&&r.a.createElement(jt,{key:"regionSelectAndTransformBoxes",regions:t,mouseEvents:Ee,projectRegionBox:we,dragWithPrimary:p,createWithPrimary:x,zoomWithPrimary:y,onBeginMovePoint:U,onSelectRegion:V,layoutParams:X,mat:fe,onBeginBoxTransform:G,onBeginMovePolygonPoint:z,onAddPolygonPoint:H}),_e&&l&&r.a.createElement(Xe,{key:"regionTags"},r.a.createElement(Ot,{regions:t,projectRegionBox:we,mouseEvents:Ee,regionClsList:S,regionTagList:_,onBeginRegionEdit:W,onChangeRegion:D,onCloseRegionEdit:B,onDeleteRegion:F,layoutParams:X,imageSrc:a,RegionEditLabel:M})),y&&null!==Be&&r.a.createElement("div",{key:"zoomBox",style:{position:"absolute",zIndex:1,border:"1px solid #fff",pointerEvents:"none",left:Be.x,top:Be.y,width:Be.w,height:Be.h}}),T&&r.a.createElement(Et,{key:"pointDistances",regions:t,realSize:c,projectRegionBox:we,pointDistancePrecision:I}),r.a.createElement(Xe,Object.assign({style:{width:"100%",height:"100%"}},Ee),r.a.createElement(r.a.Fragment,null,r.a.createElement("canvas",{className:q.canvas,ref:K}),r.a.createElement(kt,{videoPlaying:R,imagePosition:Ge,mouseEvents:Ee,onLoad:Ne,videoTime:i,videoSrc:o,imageSrc:a,onChangeVideoTime:Y,onChangeVideoPlaying:J}))),r.a.createElement("div",{className:q.zoomIndicator},(1/fe.a*100).toFixed(0),"%"))},Dt=Object(D.a)(ct.a)({width:80,margin:2}),Wt=Object(D.a)("div")({fontWeight:"bold"}),Bt=Object(n.createContext)(),Gt=Object(n.memo)(function(e){var t=e.name,a=e.disabled,n=e.Icon,o=e.onClick;return r.a.createElement(Dt,{disabled:a,onClick:o},r.a.createElement("div",null,r.a.createElement(n,null),r.a.createElement(Wt,null,t)))},function(e,t){return e.name===t.name&&e.disabled===t.disabled}),zt=function(e){var t=e.name,a=e.disabled,o=e.Icon,i=Object(n.useContext)(Bt).onHeaderButtonClick,c=Object(A.a)(function(){return i(t)});return r.a.createElement(Gt,{name:t,disabled:a,Icon:o,onClick:c})},Ht=a(148),Vt=a.n(Ht),Ut=a(149),Ft=a.n(Ut),Yt=a(246),Jt=a.n(Yt),qt=a(247),Kt=a.n(qt),Xt=a(249),Zt=a.n(Xt),$t=a(172),Qt=a.n($t),ea=a(245),ta=a.n(ea),aa=a(248),na=a.n(aa),ra={header:{display:"flex",position:"relative",flexDirection:"row",flexShrink:0,zIndex:10,boxShadow:"0px 3px 8px rgba(0,0,0,.1)"},fileInfo:{alignItems:"center",flexGrow:1,"&.videoMode":{flexMode:.1},display:"flex",fontWeight:"bold",color:T.a[800],marginRight:16,fontSize:24,paddingLeft:16}},oa=a(170),ia=a.n(oa),ca=a(108),la=a(244);function sa(e){if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(!e)return;if("string"===typeof e)return ua(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return ua(e,t)}(e))){var t=0,a=function(){};return{s:a,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,r,o=!0,i=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return o=e.done,e},e:function(e){i=!0,r=e},f:function(){try{o||null==n.return||n.return()}finally{if(i)throw r}}}}function ua(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}var ma=Object(D.a)("div")({position:"relative",display:"flex",flexGrow:1,minWidth:240,marginLeft:16,marginRight:16}),da=Object(D.a)("div")({position:"absolute",width:2,marginLeft:-1,height:"100%",backgroundColor:T.a[300],bottom:0}),ga=Object(D.a)("div")({position:"absolute",userSelect:"none",fontSize:10,color:T.a[600],fontWeight:"bold",bottom:0}),ha=Object(D.a)("div")({position:"absolute",bottom:"calc(50% + 6px)",fontSize:10,fontWeight:"bold",color:"#fff",display:"grid",placeItems:"center",width:48,marginLeft:-24,borderRadius:2,height:24,backgroundColor:he.a[500],userSelect:"none",fontVariantNumeric:"tabular-nums","&::before":{position:"absolute",bottom:-6,left:16,content:'""',width:0,height:0,borderTop:"8px solid ".concat(he.a[500]),borderLeft:"8px solid transparent",borderRight:"8px solid transparent"}}),fa=Object(D.a)("div")((Lt={position:"absolute",bottom:8,cursor:"pointer",opacity:.75,fontSize:10,fontWeight:"bold",color:"#fff",display:"grid",placeItems:"center",width:16,marginLeft:0,borderTopLeftRadius:2,borderTopRightRadius:2,height:12},Object(It.a)(Lt,"marginLeft",-8),Object(It.a)(Lt,"backgroundColor",ca.a[500]),Object(It.a)(Lt,"userSelect","none"),Object(It.a)(Lt,"fontVariantNumeric","tabular-nums"),Object(It.a)(Lt,"&::before",{position:"absolute",bottom:-8,left:0,content:'""',width:0,height:0,borderTop:"8px solid ".concat(ca.a[500]),borderLeft:"8px solid transparent",borderRight:"8px solid transparent"}),Lt)),pa=[[50,250],[100,500],[250,1e3],[1e3,5e3],[5e3,3e4],[1e4,6e4],[3e4,12e4],[6e4,3e5],[3e5,18e5],[6e5,36e5],[18e5,108e5],[36e5,18e6]],ba=function(e){var t=e.currentTime,a=void 0===t?0:t,o=e.duration,i=e.onChangeCurrentTime,c=e.keyframes,l=Object(la.a)(),s=Object(w.a)(l,2),u=s[0],m=s[1],d=Object(n.useState)(a),g=Object(w.a)(d,2),h=g[0],f=g[1],p=Object(ht.a)(!1),b=Object(w.a)(p,2),v=b[0],y=b[1],E=Object.keys(c||{}).map(function(e){return parseInt(e)}).filter(function(e){return!isNaN(e)}).sort(function(e,t){return e-t});Object(n.useEffect)(function(){a!==h&&f(a)},[a]);var O=Object(n.useMemo)(function(){return function(e){var t,a=sa(pa);try{for(a.s();!(t=a.n()).done;){var n=t.value,r=Object(w.a)(n,2),o=r[0],i=r[1];if(e/i<6&&e/i>2)return[o,i]}}catch(c){a.e(c)}finally{a.f()}return[e/4,e]}(o)},[o]),x=Object(w.a)(O,2),j=x[0],I=x[1],S=Object(A.a)(function(e){if(v){var t=(e.clientX-m.left)/m.width;f(Math.min(o,Math.max(0,Math.floor(t*o))))}}),_=Object(A.a)(function(e){y(!1);var t=(e.clientX-m.left)/m.width,a=Math.min(o,Math.max(0,Math.floor(t*o)));f(a),i(a)});return o?r.a.createElement(ma,{onMouseMove:S,onMouseUp:_,ref:u},ia()(0,o,I).map(function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement(da,{key:e,style:{left:e/o*m.width,height:"50%"}}),r.a.createElement(ga,{style:{left:e/o*m.width+8,bottom:"calc(50% - 12px)"}},Ve(e)))}),ia()(0,o,j).filter(function(e){return!Number.isInteger(e/I)}).map(function(e){return r.a.createElement(da,{key:e,style:{left:e/o*m.width,height:"25%"}})}),E.map(function(e){return r.a.createElement(fa,{onClick:function(){return i(e)},key:e,style:{left:e/o*m.width}})}),r.a.createElement(ha,{onMouseDown:function(e){return y(!0)},style:{cursor:v?"grabbing":"grab",left:h/o*m.width}},Ve(h))):null},va=a(250),ya=a.n(va),Ea=Object(x.a)(ra),Oa=function(e){var t=e.state,a=e.onHeaderButtonClick,n=e.title,o=e.inFullScreen,i=e.videoMode,c=(e.isAVideoFrame,e.nextVideoFrameHasRegions),l=void 0!==c&&c,s=e.videoDuration,u=e.currentVideoTime,m=e.multipleImages,d=e.videoPlaying,g=e.onChangeCurrentTime,h=e.keyframes,f=e.alwaysShowPrevButton,p=e.alwaysShowNextButton,b=Ea();return r.a.createElement("div",{className:b.header},r.a.createElement("div",{className:k()(b.fileInfo,i&&"videoMode")},n),r.a.createElement("div",{className:k()(b.fileInfo,i&&"videoMode")},"Mode: ","object_detection"===t.annotatemode?"Object Detection":"Segmentation"),i&&r.a.createElement(ba,{key:"keyframeTimeline",currentTime:u,duration:s,onChangeCurrentTime:g,keyframes:h}),r.a.createElement("div",{className:b.headerActions},r.a.createElement(Bt.Provider,{value:{onHeaderButtonClick:a}},(m||f)&&r.a.createElement(zt,{name:"Prev",Icon:Vt.a}),(m||p)&&r.a.createElement(r.a.Fragment,null,r.a.createElement(zt,{name:"Next",Icon:Ft.a}),r.a.createElement(zt,{name:"Clone",disabled:l,Icon:ta.a})),i&&r.a.createElement(r.a.Fragment,null,d?r.a.createElement(zt,{key:"pause",name:"Pause",Icon:Kt.a}):r.a.createElement(zt,{key:"play",name:"Play",Icon:Jt.a})),r.a.createElement(zt,{name:"object_detection"===t.annotatemode?"SEGMENTATION":"OBJECT DETECTION",Icon:na.a}),t.curr_image_index>0&&r.a.createElement(zt,{name:"prev image",Icon:Vt.a}),r.a.createElement(zt,{name:"next image",Icon:Ft.a}),r.a.createElement(zt,{name:"Settings",Icon:Zt.a}),o?r.a.createElement(zt,{name:"Window",Icon:Qt.a}):r.a.createElement(zt,{name:"Fullscreen",Icon:Qt.a}),r.a.createElement(zt,{name:"Review",Icon:ya.a}))))},wa=a(80),xa=a(81),ja=a(565),Ia=Object(n.createContext)(),Sa=Object(n.memo)(function(e){var t=e.id,a=e.name,o=e.icon,i=e.selected,c=e.togglable,l=e.alwaysShowing,s=void 0!==l&&l,u=Object(n.useContext)(Ia),m=u.enabledTools,d=u.selectedTool,g=u.onClickTool;return m.includes(t)||s?(i=i||d===t,r.a.createElement(ja.a,{placement:"right",title:a},r.a.createElement("div",null,r.a.createElement(_.a,{disabled:c?void 0:i,"aria-label":a,onClick:function(){return g(t)},size:"small",style:{width:50,height:50,margin:1,color:i?he.a[500]:void 0}},o)))):null},function(e,t){return e.togglable===t.togglable&&e.selected===t.selected&&e.name===t.name&&e.id===t.id}),_a=Object(x.a)({iconTools:{display:"flex",padding:4,flexDirection:"column",zIndex:9,boxShadow:"0px 0px 5px rgba(0,0,0,0.1)",borderRight:"1px solid ".concat(T.a[300]),backgroundColor:T.a[100]}}),Na=["select","create-point","create-box","create-polygon"],Ta=function(e){var t=e.showTags,a=e.selectedTool,o=e.onClickTool,i=e.enabledTools,c=void 0===i?Na:i,l=_a(),s=Object(n.useMemo)(function(){return{enabledTools:c,selectedTool:a,onClickTool:o}},[c,a]);return r.a.createElement("div",{className:l.iconTools},r.a.createElement(Ia.Provider,{value:s},r.a.createElement(Sa,{id:"select",name:"Select Region",icon:r.a.createElement(wa.a,{size:"xs",fixedWidth:!0,icon:xa.d})}),r.a.createElement(Sa,{alwaysShowing:!0,id:"pan",name:"Drag/Pan",icon:r.a.createElement(wa.a,{size:"xs",fixedWidth:!0,icon:xa.c})}),r.a.createElement(Sa,{alwaysShowing:!0,id:"zoom",name:"Zoom In/Out",icon:r.a.createElement(wa.a,{size:"xs",fixedWidth:!0,icon:xa.f})}),r.a.createElement(Sa,{alwaysShowing:!0,togglable:!0,id:"show-tags",selected:t,name:"Show Tags",icon:r.a.createElement(wa.a,{size:"xs",fixedWidth:!0,icon:xa.g})}),r.a.createElement(Sa,{id:"create-point",name:"Add Point",icon:r.a.createElement(wa.a,{size:"xs",fixedWidth:!0,icon:xa.a})}),r.a.createElement(Sa,{id:"create-box",name:"Add Bounding Box",icon:r.a.createElement(wa.a,{size:"xs",fixedWidth:!0,icon:xa.h})}),r.a.createElement(Sa,{id:"create-polygon",name:"Add Polygon",icon:r.a.createElement(wa.a,{size:"xs",fixedWidth:!0,icon:xa.b})}),r.a.createElement(Sa,{id:"create-pixel",name:"Add Pixel Region",icon:r.a.createElement(wa.a,{size:"xs",fixedWidth:!0,icon:xa.e})})))},Ca={container:{display:"flex",flexGrow:1,flexDirection:"column",height:"100%",maxHeight:"100vh",backgroundColor:"#fff",overflow:"hidden","&.fullscreen":{position:"absolute",zIndex:99999,left:0,right:0,top:0,bottom:0}},workspace:{backgroundColor:T.a[200],flexGrow:1,display:"flex",flexDirection:"row",height:"100%",overflow:"hidden"},iconToolsContainer:{display:"flex"},imageCanvasContainer:{display:"flex",flexGrow:1,alignItems:"center",justifyContent:"center"},noImageSelected:{fontWeight:"bold",fontSize:32,color:T.a[500]},sidebarContainer:{width:300,flexShrink:0,overflowY:"auto",backgroundColor:T.a[100],borderLeft:"1px solid ".concat(T.a[300]),zIndex:9,height:"100%",boxShadow:"0px 0px 5px rgba(0,0,0,0.1)"}},ka=a(252),Aa=a.n(ka),Ma=a(563),La=a(554),Ra=a(555),Pa=a(556),Da=a(253),Wa=a.n(Da),Ba=function(e){var t=e.open,a=e.onClose,n=_t();return r.a.createElement(Ma.a,{open:t||!1,onClose:a},r.a.createElement(La.a,null,"Settings"),r.a.createElement(Ra.a,{style:{minWidth:400}},r.a.createElement(Wa.a,{variant:"flat",noActions:!0,defaultAnswers:n,onQuestionChange:function(e,t,a){return n.changeSetting(e,t)},form:{questions:[{type:"boolean",title:"Show Crosshairs",name:"showCrosshairs"},{type:"dropdown",title:"Video Playback Speed",name:"videoPlaybackSpeed",defaultValue:".25x",choices:["0.25x","0.5x","1x","2x"]}]}})),r.a.createElement(Pa.a,null,r.a.createElement(ct.a,{onClick:a},"Close")))},Ga=a(258),za=a.n(Ga),Ha=function(e){return e.enabled?r.a.createElement(za.a,e,e.children):e.children},Va=function(e){var t,a,n=null;return"image"===e.annotationType?-1===(n=e.images.findIndex(function(t){return t.src===e.selectedImage&&(void 0===e.selectedImageFrameTime||t.frameTime===e.selectedImageFrameTime)}))?(n=null,a=null):(t=["images",n],a=Object(De.getIn)(e,t)):"video"===e.annotationType&&(t=["keyframes",e.currentVideoTime||0],a=Object(De.getIn)(e,t)||null),{currentImageIndex:n,pathToActiveImage:t,activeImage:a}};function Ua(e){if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(!e)return;if("string"===typeof e)return Fa(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Fa(e,t)}(e))){var t=0,a=function(){};return{s:a,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,r,o=!0,i=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return o=e.done,e},e:function(e){i=!0,r=e},f:function(){try{o||null==n.return||n.return()}finally{if(i)throw r}}}}function Fa(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}var Ya=[],Ja=function(e,t){if(e[t||0])return e[t||0].regions;var a=Object.keys(e).map(function(e){return parseInt(e)}).filter(function(e){return!isNaN(e)});if(0===a.length)return Ya;a.sort(function(e,t){return e-t});var n=a.findIndex(function(e){return e>=t});if(-1===n)return e[a[a.length-1]].regions||Ya;if(0===n)return Ya;var r,o=a[n-1],i=e[o],c=a[n],l=e[c],s={},u={},m=Ua(i.regions);try{for(m.s();!(r=m.n()).done;){var d=r.value;s[d.id]=d}}catch(w){m.e(w)}finally{m.f()}var g,h=Ua(l.regions);try{for(h.s();!(g=h.n()).done;){var f=g.value;u[f.id]=f}}catch(w){h.e(w)}finally{h.f()}var p=[],b=(c-t)/(c-o),v=1-b,y=function(e){var t=[s[e],u[e]],a=t[0],n=t[1];if(!n)return p.push(Object(O.a)({},a,{highlighted:!1,editingLabels:!1})),"continue";switch(a.type){case"point":p.push(Object(O.a)({},a,{highlighted:!1,editingLabels:!1,x:a.x*b+n.x*v,y:a.y*b+n.y*v}));break;case"box":p.push(Object(O.a)({},a,{highlighted:!1,editingLabels:!1,x:a.x*b+n.x*v,y:a.y*b+n.y*v,w:a.w*b+n.w*v,h:a.h*b+n.h*v}));break;case"polygon":n.points.length===a.points.length?p.push(Object(O.a)({},a,{highlighted:!1,editingLabels:!1,points:a.points.map(function(e,t){return[e[0]*b+n.points[t][0]*v,e[1]*b+n.points[t][1]*v]})})):p.push(a)}};for(var E in s)y(E);return p},qa=[],Ka=Object(x.a)(Ca),Xa=function(e){var t,a=e.state,o=e.dispatch,i=(e.alwaysShowNextButton,e.alwaysShowPrevButton,e.RegionEditLabel),c=Ka(),l=_t(),s=Object(n.useRef)({}),u=function(e){for(var t=arguments.length,a=new Array(t>1?t-1:0),n=1;n<t;n++)a[n-1]=arguments[n];var r="".concat(e,"(").concat(a.join(","),")");if(s.current[r])return s.current[r];var i=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return a.length>0?o(Object(O.a)({type:e},a.reduce(function(e,t,a){return e[t]=n[a],e},{}))):o(Object(O.a)({type:e},n[0]))};return s.current[r]=i,i},m=Va(a),d=m.currentImageIndex,g=m.activeImage;null!==d&&(t=a.images[d+1]),Aa()(function(){return o({type:"CANCEL"})},{detectKeys:[27]});var h=g&&void 0!==g.frameTime,f=function(e){if("video"!==e.annotationType)return qa;var t=e.keyframes,a=e.currentVideoTime,r=void 0===a?0:a;return Object(n.useMemo)(function(){return Ja(t,r)},[t,r])}(a);return r.a.createElement(Ha,{enabled:a.fullScreen,onChange:function(e){e||u("HEADER_BUTTON_CLICKED","buttonName")("Exit Fullscreen")}},r.a.createElement("div",{className:k()(c.container,a.fullScreen&&"Fullscreen")},r.a.createElement("div",{className:c.headerContainer},r.a.createElement(Oa,{state:a,onHeaderButtonClick:u("HEADER_BUTTON_CLICKED","buttonName"),videoMode:"video"===a.annotationType,inFullScreen:a.fullScreen,isAVideoFrame:h,nextVideoFrameHasRegions:!t||t.regions&&t.regions.length>0,videoDuration:a.videoDuration,multipleImages:a.images&&a.images.length>1,title:"image"===a.annotationType?g?g.name:"No Image Selected":a.videoName||"",onChangeCurrentTime:u("CHANGE_VIDEO_TIME","newTime"),videoPlaying:a.videoPlaying,currentVideoTime:a.currentVideoTime,keyframes:a.keyframes})),r.a.createElement("div",{className:c.workspace},r.a.createElement("div",{className:c.iconToolsContainer},r.a.createElement(Ta,{enabledTools:a.enabledTools,showTags:a.showTags,selectedTool:a.selectedTool,onClickTool:u("SELECT_TOOL","selectedTool")})),r.a.createElement("div",{className:c.imageCanvasContainer},"image"!==a.annotationType||a.selectedImage?r.a.createElement("div",{style:{height:"100%",width:"100%"}},r.a.createElement(Pt,Object.assign({},l,{key:a.selectedImage,showTags:a.showTags,allowedArea:a.allowedArea,regionClsList:a.regionClsList,regionTagList:a.regionTagList,regions:"image"===a.annotationType?g.regions||[]:f,realSize:g?g.realSize:void 0,videoPlaying:a.videoPlaying,imageSrc:"image"===a.annotationType?a.selectedImage:null,videoSrc:"video"===a.annotationType?a.videoSrc:null,pointDistancePrecision:a.pointDistancePrecision,createWithPrimary:a.selectedTool.includes("create"),dragWithPrimary:"pan"===a.selectedTool,zoomWithPrimary:"zoom"===a.selectedTool,showPointDistances:a.showPointDistances,videoTime:"image"===a.annotationType?a.selectedImageFrameTime:a.currentVideoTime,onMouseMove:u("MOUSE_MOVE"),onMouseDown:u("MOUSE_DOWN"),onMouseUp:u("MOUSE_UP"),onChangeRegion:u("CHANGE_REGION","region"),onBeginRegionEdit:u("OPEN_REGION_EDITOR","region"),onCloseRegionEdit:u("CLOSE_REGION_EDITOR","region"),onDeleteRegion:u("DELETE_REGION","region"),onBeginBoxTransform:u("BEGIN_BOX_TRANSFORM","box","directions"),onBeginMovePolygonPoint:u("BEGIN_MOVE_POLYGON_POINT","polygon","pointIndex"),onAddPolygonPoint:u("ADD_POLYGON_POINT","polygon","point","pointIndex"),onSelectRegion:u("SELECT_REGION","region"),onBeginMovePoint:u("BEGIN_MOVE_POINT","point"),onImageLoaded:u("IMAGE_LOADED","image"),RegionEditLabel:i,onImageOrVideoLoaded:u("IMAGE_OR_VIDEO_LOADED","metadata"),onChangeVideoTime:u("CHANGE_VIDEO_TIME","newTime"),onChangeVideoPlaying:u("CHANGE_VIDEO_PLAYING","isPlaying")}))):r.a.createElement("div",{className:c.noImageSelected},"No Image Selected")),r.a.createElement("div",{className:c.sidebarContainer},r.a.createElement(nt,{metadata:a.metadata,allowed_metadata:a.allowed_metadata,preview:a.preview,previewList:a.previewList,debug:window.localStorage.$ANNOTATE_DEBUG_MODE&&a,taskDescription:a.taskDescription,images:a.images,regions:g?g.regions:null,history:a.history,currentImage:g,labelImages:a.labelImages,imageClsList:a.imageClsList,imageTagList:a.imageTagList,keyframes:a.keyframes,currentVideoTime:a.currentVideoTime,onChangeMetadata:u("CHANGE_METADATA","metadata"),onChangeImage:u("CHANGE_IMAGE","delta"),onSelectRegion:u("SELECT_REGION","region"),onDeleteRegion:u("DELETE_REGION","region"),onSelectImage:u("SELECT_IMAGE","image"),onChangeRegion:u("CHANGE_REGION","region"),onRestoreHistory:u("RESTORE_HISTORY"),onChangeVideoTime:u("CHANGE_VIDEO_TIME","newTime"),onDeleteKeyframe:u("DELETE_KEYFRAME","time"),onShortcutActionDispatched:o}))),r.a.createElement(Ba,{open:a.settingsOpen,onClose:function(){return o({type:"HEADER_BUTTON_CLICKED",buttonName:"Settings"})}})))};function Za(e){if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(!e)return;if("string"===typeof e)return $a(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return $a(e,t)}(e))){var t=0,a=function(){};return{s:a,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,r,o=!0,i=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return o=e.done,e},e:function(e){i=!0,r=e},f:function(){try{o||null==n.return||n.return()}finally{if(i)throw r}}}}function $a(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}var Qa={BEGIN_BOX_TRANSFORM:"Transform/Move Box",BEGIN_MOVE_POINT:"Move Point",DELETE_REGION:"Delete Region"},en=function(e,t){return Object(De.updateIn)(e,["history"],function(a){return[{time:Ce()().toDate(),state:Object(De.without)(e,"history"),name:t}].concat((a||[]).slice(0,9))})},tn=function(){return Math.random().toString().split(".")[1]},an=function(){var e,t,a=(e=0,t=360,Math.floor(Math.random()*(t-e+1))+e);return"hsl(".concat(a,",").concat(100,"%,").concat(50,"%)")},nn=function(e,t){if("MOUSE_MOVE"===t.type){if(Date.now()-(e.lastMouseMoveCall||0)<16)return e;e=Object(De.setIn)(e,["lastMouseMoveCall"],Date.now())}t.type.includes("MOUSE")||(e=Object(De.setIn)(e,["lastAction"],t));var a=Va(e),n=a.currentImageIndex,r=a.pathToActiveImage,o=a.activeImage,i=function(e){var t="string"===typeof e?e:e.id;if(!o)return null;var a=(o.regions||[]).findIndex(function(e){return e.id===t});return-1===a?null:a},c=function(e){if(!o)return null;var t=i(e);return null===t?[null,null]:[o.regions[t],t]},l=function(t,a){var n=c(t),i=Object(w.a)(n,2),l=i[0],s=i[1];if(!l)return e;if(null!==a)return Object(De.setIn)(e,[].concat(Object(b.a)(r),["regions",s]),Object(O.a)({},l,a));var u=o.regions;return Object(De.setIn)(e,[].concat(Object(b.a)(r),["regions"]),(u||[]).filter(function(e){return e.id!==l.id}))},s=function(e){return o?Object(De.setIn)(e,[].concat(Object(b.a)(r),["regions"]),(o.regions||[]).map(function(e){return Object(O.a)({},e,{highlighted:!1})})):e},u=function(e){return null===n?e:Object(De.setIn)(e,[].concat(Object(b.a)(r),["regions"]),(o.regions||[]).map(function(e){return Object(O.a)({},e,{editingLabels:!1})}))},m=function(t){var a="object"===typeof t?t:{src:t},n=a.src,r=a.frameTime;return Object(De.setIn)(Object(De.setIn)(e,["selectedImage"],n),["selectedImageFrameTime"],r)};switch(t.type){case"@@INIT":return e;case"SELECT_IMAGE":return m(t.image);case"CHANGE_REGION":var d=i(t.region);if(null===d)return e;var g=o.regions[d];return g.cls!==t.region.cls&&(e=en(e,"Change Region Classification")),J()(g.tags,t.region.tags)||(e=en(e,"Change Region Tags")),Object(De.setIn)(e,[].concat(Object(b.a)(r),["regions",d]),t.region);case"CHANGE_IMAGE":if(!o)return e;for(var h=t.delta,f=0,p=Object.keys(h);f<p.length;f++){var v=p[f];"cls"===v&&en(e,"Change Image Class"),"tags"===v&&en(e,"Change Image Tags"),e=Object(De.setIn)(e,[].concat(Object(b.a)(r),[v]),h[v])}return e;case"SELECT_REGION":var y=t.region;if(null===i(t.region))return e;var E=Object(b.a)(o.regions||[]).map(function(e){return Object(O.a)({},e,{highlighted:e.id===y.id,editingLabels:e.id===y.id})});return Object(De.setIn)(e,[].concat(Object(b.a)(r),["regions"]),E);case"BEGIN_MOVE_POINT":return e=u(e),Object(De.setIn)(e,["mode"],{mode:"MOVE_REGION",regionId:t.point.id});case"BEGIN_BOX_TRANSFORM":var x=t.box,j=t.directions;return e=u(e),0===j[0]&&0===j[1]?Object(De.setIn)(e,["mode"],{mode:"MOVE_REGION",regionId:x.id}):Object(De.setIn)(e,["mode"],{mode:"RESIZE_BOX",regionId:x.id,freedom:j,original:{x:x.x,y:x.y,w:x.w,h:x.h}});case"BEGIN_MOVE_POLYGON_POINT":var I=t.polygon,S=t.pointIndex;return(e=u(e)).mode&&"DRAW_POLYGON"===e.mode.mode&&0===S?Object(De.setIn)(l(I,{points:I.points.slice(0,-1),open:!1}),["mode"],null):(e=en(e,"Move Polygon Point"),Object(De.setIn)(e,["mode"],{mode:"MOVE_POLYGON_POINT",regionId:I.id,pointIndex:S}));case"ADD_POLYGON_POINT":var _=t.polygon,N=t.point,T=t.pointIndex,C=i(_);if(null===C)return e;var k=Object(b.a)(_.points);return k.splice(T,0,N),Object(De.setIn)(e,[].concat(Object(b.a)(r),["regions",C]),Object(O.a)({},_,{points:k}));case"MOUSE_MOVE":var A=t.x,M=t.y;if(!e.mode)return e;if(!o)return e;switch(e.mode.mode){case"MOVE_POLYGON_POINT":var L=e.mode,R=L.pointIndex,P=L.regionId,D=i(P);return null===D?e:Object(De.setIn)(e,[].concat(Object(b.a)(r),["regions",D,"points",R]),[A,M]);case"MOVE_REGION":var W=e.mode.regionId,B=i(W);return null===B?e:Object(De.setIn)(e,[].concat(Object(b.a)(r),["regions",B]),function(e,t,a){switch(e.type){case"point":return Object(O.a)({},e,{x:t,y:a});case"box":return Object(O.a)({},e,{x:t-e.w/2,y:a-e.h/2})}return e}(o.regions[B],A,M));case"RESIZE_BOX":var G=e.mode,z=G.regionId,H=Object(w.a)(G.freedom,2),V=H[0],U=H[1],F=G.original,Y=F.x,q=F.y,K=F.w,X=F.h,Z=i(z);if(null===Z)return e;var $=o.regions[Z],Q=0===V?Y:-1===V?Math.min(Y+K,A):Y,ee=0===V?K:-1===V?K+(Y-Q):Math.max(0,K+(A-Y-K)),te=0===U?q:-1===U?Math.min(q+X,M):q,ae=0===U?X:-1===U?X+(q-te):Math.max(0,X+(M-q-X));return ee<=.001&&(e=Object(De.setIn)(e,["mode","freedom"],[-1*V,U])),ae<=.001&&(e=Object(De.setIn)(e,["mode","freedom"],[V,-1*U])),Object(De.setIn)(e,[].concat(Object(b.a)(r),["regions",Z]),Object(O.a)({},$,{x:Q,w:ee,y:te,h:ae}));case"DRAW_POLYGON":var ne=e.mode.regionId,re=c(ne),oe=Object(w.a)(re,2),ie=oe[0],ce=oe[1];return ie?Object(De.setIn)(e,[].concat(Object(b.a)(r),["regions",ce,"points",ie.points.length-1]),[A,M]):Object(De.setIn)(e,["mode"],null)}return e;case"MOUSE_DOWN":if(!o)return e;var le,se=t.x,ue=t.y;if(e.allowedArea){var me=e.allowedArea;if(se<me.x||se>me.x+me.w||ue<me.y||ue>me.y+me.h)return e}switch(e.selectedTool){case"create-point":e=en(e,"Create Point"),le={type:"point",x:se,y:ue,highlighted:!0,editingLabels:!0,color:an(),id:tn()};break;case"create-box":e=en(e,"Create Box"),le={type:"box",x:se,y:ue,w:.01,h:.01,highlighted:!0,editingLabels:!1,color:an(),id:tn()},e=s(e),e=Object(De.setIn)(e,["mode"],{mode:"RESIZE_BOX",editLabelEditorAfter:!0,regionId:le.id,freedom:[1,1],original:{x:se,y:ue,w:le.w,h:le.h},isNew:!0});break;case"create-polygon":if(e.mode&&"DRAW_POLYGON"===e.mode.mode)break;e=en(e,"Create Polygon"),le={type:"polygon",points:[[se,ue],[se,ue]],open:!0,highlighted:!0,color:an(),id:tn()},e=Object(De.setIn)(e,["mode"],{mode:"DRAW_POLYGON",regionId:le.id})}if(le&&(e=s(e)),e.mode)switch(e.mode.mode){case"DRAW_POLYGON":var de=c(e.mode.regionId),ge=Object(w.a)(de,2),he=ge[0],fe=ge[1];if(!he)break;return Object(De.setIn)(e,[].concat(Object(b.a)(r),["regions",fe]),Object(O.a)({},he,{points:he.points.concat([[se,ue]])}))}var pe=Object(b.a)(o.regions||[]).map(function(e){return Object(O.a)({},e,{editingLabels:!1})}).concat(le?[le]:[]);return Object(De.setIn)(e,[].concat(Object(b.a)(r),["regions"]),pe);case"MOUSE_UP":var be=t.x,ve=t.y;if(!e.mode)return e;switch(e.mode.mode){case"RESIZE_BOX":if(e.mode.isNew&&Math.abs(e.mode.original.x-be)<.01&&Math.abs(e.mode.original.y-ve)<.01)return Object(De.setIn)(l(e.mode.regionId,null),["mode"],null);if(e.mode.editLabelEditorAfter)return Object(O.a)({},l(e.mode.regionId,{editingLabels:!0}),{mode:null});case"MOVE_REGION":case"MOVE_POLYGON_POINT":return Object(O.a)({},e,{mode:null})}return e;case"CHANGE_REGION":var ye=t.region,Ee=i(t.region);return null===Ee?e:Object(De.setIn)(e,[].concat(Object(b.a)(r),["regions",Ee]),ye);case"OPEN_REGION_EDITOR":t.region;var Oe=i(t.region);if(null===Oe)return e;var we=Object(De.setIn)(o.regions.map(function(e){return Object(O.a)({},e,{highlighted:!1,editingLabels:!1})}),[Oe],Object(O.a)({},(o.regions||[])[Oe],{highlighted:!0,editingLabels:!0}));return Object(De.setIn)(e,[].concat(Object(b.a)(r),["regions"]),we);case"CLOSE_REGION_EDITOR":t.region;var xe=i(t.region);return null===xe?e:Object(De.setIn)(e,[].concat(Object(b.a)(r),["regions",xe]),Object(O.a)({},(o.regions||[])[xe],{editingLabels:!1}));case"DELETE_REGION":return null===i(t.region)?e:Object(De.setIn)(e,[].concat(Object(b.a)(r),["regions"]),(o.regions||[]).filter(function(e){return e.id!==t.region.id}));case"HEADER_BUTTON_CLICKED":switch(t.buttonName.toLowerCase()){case"prev":return null===n?e:0===n?e:m(e.images[n-1]);case"next":return null===n?e:n===e.images.length-1?e:m(e.images[n+1]);case"clone":return null===n?e:n===e.images.length-1?e:Object(De.setIn)(m(e.images[n+1]),["images",n+1,"regions"],o.regions);case"settings":return Object(De.setIn)(e,["settingsOpen"],!e.settingsOpen);case"fullscreen":return Object(De.setIn)(e,["fullScreen"],!0);case"exit fullscreen":case"window":return Object(De.setIn)(e,["fullScreen"],!1);case"hotkeys":return e;case"exit":case"done":case"next image":case"prev image":return e;case"object detection":return Object(De.setIn)(e,["annotatemode"],"object_detection");case"segmentation":return Object(De.setIn)(e,["annotatemode"],"segmentation")}return e;case"SELECT_TOOL":return e=Object(De.setIn)(e,["mode"],null),"show-tags"===t.selectedTool?Object(De.setIn)(e,["showTags"],!e.showTags):(console.log("[selectedtool]",e.selectedTool),Object(De.setIn)(e,["selectedTool"],t.selectedTool));case"CANCEL":var je=e.mode;if(je)switch(je.mode){case"DRAW_POLYGON":return l(je.regionId,null);case"MOVE_POLYGON_POINT":case"RESIZE_BOX":case"MOVE_REGION":return Object(De.setIn)(e,["mode"],null)}var Ie=o.regions;return Ie.some(function(e){return e.editingLabels})?Object(De.setIn)(e,[].concat(Object(b.a)(r),["regions"]),Ie.map(function(e){return Object(O.a)({},e,{editingLabels:!1})})):Object(De.setIn)(e,[].concat(Object(b.a)(r),["regions"]),Ie.map(function(e){return Object(O.a)({},e,{highlighted:!1})}));case"RELOAD":return Object(De.setIn)(e,["images"],t.image);case"ANNOTATION_MODE":return"segmentation"===e.annotatemode?(console.log("[reducer annotatemode]",e.annotatemode),Object(De.setIn)(e,["enabledTools"],["select","create-polygon"])):(console.log("[reducer annotatemode]",e.annotatemode),Object(De.setIn)(e,["enabledTools"],["select","create-box"]));case"CLASS_LIST":return Object(De.setIn)(e,["regionClsList"],t.classlist);case"IMAGE_INDEX":return Object(De.setIn)(e,["curr_image_index"],t.curr_image_index);case"CHANGE_METADATA":return Object(De.setIn)(e,["metadata"],t.metadata);case"CHANGE_METALIST":return Object(De.setIn)(e,["allowed_metadata"],t.metadata);case"PREVIEW_LIST":return Object(De.setIn)(e,["previewList"],t.image);case"LOADER":return Object(De.setIn)(e,["loader"],t.value);case"LOADER_MESSAGE":return Object(De.setIn)(e,["message"],t.value)}return e},rn=function(e,t){var a=Va(e),n=a.currentImageIndex;a.pathToActiveImage,a.activeImage;switch(t.type){case"IMAGE_LOADED":return console.log("[Image_loaded]",e),Object(De.setIn)(e,["images",n,"pixelSize"],{w:t.image.width,h:t.image.height})}return e},on=function(e,t){var a=function(){return Object(De.setIn)(en(e,"Add Keyframe"),["keyframes",e.currentVideoTime],{regions:Ja(e.keyframes,e.currentVideoTime)})};switch(t.type){case"IMAGE_OR_VIDEO_LOADED":var n=t.metadata.duration;if("number"===typeof n)return Object(De.setIn)(e,["videoDuration"],1e3*n);case"HEADER_BUTTON_CLICKED":switch(t.buttonName.toLowerCase()){case"play":return Object(De.setIn)(e,["videoPlaying"],!0);case"pause":return Object(De.setIn)(e,["videoPlaying"],!1)}case"CHANGE_VIDEO_TIME":return Object(De.setIn)(e,["currentVideoTime"],t.newTime);case"CHANGE_VIDEO_PLAYING":return Object(De.setIn)(e,["videoPlaying"],t.isPlaying);case"DELETE_KEYFRAME":return Object(De.setIn)(e,["keyframes"],Object(De.without)(e.keyframes,t.time))}if(!e.keyframes[e.currentVideoTime])switch(t.type){case"BEGIN_BOX_TRANSFORM":case"BEGIN_MOVE_POINT":case"BEGIN_MOVE_POLYGON_POINT":case"BEGIN_BOX_TRANSFORM":case"BEGIN_MOVE_POLYGON_POINT":case"ADD_POLYGON_POINT":case"SELECT_REGION":case"CHANGE_REGION":case"DELETE_REGION":case"OPEN_REGION_EDITOR":return a();case"MOUSE_DOWN":switch(e.selectedTool){case"create-point":case"create-polygon":case"create-box":return a()}}return e},cn=(a(498),function(e){return r.a.createElement("div",{className:"loader-container"},r.a.createElement("div",{className:"loader"},r.a.createElement("div",{className:"ellipse"}),r.a.createElement("div",{className:"ellipse"}),r.a.createElement("div",{className:"ellipse"}),r.a.createElement("div",{className:"ellipse"}),r.a.createElement("div",{className:"ellipse"})),r.a.createElement("p",{style:{color:"white",fontSize:"2rem",marginTop:"4rem"}}," ",e.message," "))}),ln=function(e){var t=e.images,a=e.allowedArea,o=e.selectedImage,i=void 0===o?t&&t.length>0?t[0].src:void 0:o,c=e.showPointDistances,l=e.pointDistancePrecision,s=e.showTags,u=void 0===s||s,m=e.enabledTools,d=void 0===m?["select","create-point","create-box"]:m,g=e.regionTagList,h=void 0===g?[]:g,f=e.regionClsList,p=void 0===f?[]:f,b=e.imageTagList,v=void 0===b?[]:b,y=e.imageClsList,E=void 0===y?[]:y,x=e.keyframes,j=void 0===x?{}:x,I=e.taskDescription,S=e.RegionEditLabel,_=e.videoSrc,N=e.videoTime,T=void 0===N?0:N,C=e.videoName,k=e.onExit,M=e.onNextImage,L=e.onPrevImage,R=e.preview,P=e.previewList,D=e.curr_image_index,W=e.changeAnnotateMode,B=e.annotatemode,G=e.allowed_metadata,z=e.metadata,H=void 0===z?{}:z,V=e.loading,U=e.message,F=e.updateRegion;_t();if(!t&&!_)return'Missing required prop "images" or "videoSrc"';var Y,J=t?"image":"video",q=Object(n.useReducer)((Y=function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return function(e,a){var n,r=Za(t);try{for(r.s();!(n=r.n()).done;)e=(0,n.value)(e,a)}catch(o){r.e(o)}finally{r.f()}return e}}("image"===J?rn:on,nn),function(e,t){var a=e,n=Y(e,t);if("RESTORE_HISTORY"===t.type){if(e.history.length>0)return Object(De.setIn)(n.history[0].state,["history"],n.history.slice(1))}else if(a!==n&&Object.keys(Qa).includes(t.type))return Object(De.setIn)(n,["history"],[{time:Ce()().toDate(),state:Object(De.without)(a,"history"),name:Qa[t.type]||t.type}].concat(n.history||[]).slice(0,9));return n}),We()(Object(O.a)({message:U,updateRegion:F,loading:V,metadata:H,allowed_metadata:G,annotationType:J,curr_image_index:D,preview:R,previewList:P,changeAnnotateMode:W,annotatemode:B,showTags:u,allowedArea:a,showPointDistances:c,pointDistancePrecision:l,selectedTool:"select",mode:null,taskDescription:I,labelImages:E.length>0||v.length>0,regionClsList:p,regionTagList:h,imageClsList:E,imageTagList:v,currentVideoTime:T,enabledTools:d,history:[],videoName:C},"image"===J?{selectedImage:i,images:t,selectedImageFrameTime:t&&t.length>0?t[0].frameTime:void 0}:{videoSrc:_,keyframes:j}))),K=Object(w.a)(q,2),X=K[0],Z=K[1],$=Object(A.a)(function(e){if("HEADER_BUTTON_CLICKED"===e.type){if(["Exit","Done","Save","Complete","Review"].includes(e.buttonName))return k(Object(De.without)(X,"history"));if("next image"===e.buttonName&&M)return Z({type:"CHANGE_METADATA",metadata:null}),M(Object(De.without)(X,"history"));if("prev image"===e.buttonName&&L)return Z({type:"CHANGE_METADATA",metadata:null}),L(Object(De.without)(X,"history"))}Z(e)});return Object(n.useEffect)(function(){Z({type:"SELECT_IMAGE",image:X.images.find(function(e){return e.src===i})})},[i]),Object(n.useEffect)(function(){Z({type:"RELOAD",image:t}),Z({type:"SELECT_IMAGE",image:t[0]})},[t]),Object(n.useEffect)(function(){Z({type:"CLASS_LIST",classlist:p})},[p]),Object(n.useEffect)(function(){"object_detection"===X.annotatemode?(Z({type:"ANNOTATION_MODE"}),Z({type:"SELECT_TOOL",selectedTool:"create-box"}),X.changeAnnotateMode(X.annotatemode)):(Z({type:"ANNOTATION_MODE"}),Z({type:"SELECT_TOOL",selectedTool:"create-polygon"}),X.changeAnnotateMode(X.annotatemode))},[X.annotatemode]),Object(n.useEffect)(function(){Z({type:"IMAGE_INDEX",curr_image_index:D})},[D]),Object(n.useEffect)(function(){Z({type:"PREVIEW_LIST",image:P})},[P]),Object(n.useEffect)(function(){Z({type:"CHANGE_METADATA",metadata:H})},[H]),Object(n.useEffect)(function(){Z({type:"CHANGE_METALIST",metadata:G})},[G]),Object(n.useEffect)(function(){Z({type:"LOADER",value:V})},[V]),Object(n.useEffect)(function(){Z({type:"LOADER_MESSAGE",value:U})},[U]),V?r.a.createElement(cn,{message:U}):r.a.createElement(Nt,null,r.a.createElement(Xa,{RegionEditLabel:S,alwaysShowNextButton:Boolean(M),alwaysShowPrevButton:Boolean(L),state:X,dispatch:$}))},sn=a(17),un=a.n(sn),mn=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(u.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={src:null,image_key:"",annotatemode:"object_detection",curr_image_index:0,call_type:"first",regions:[],metadata:"",class_list:"",seg_class:[],obj_class:[],allowed_metadata:{},dimension:{imgHeight:0,imgWidth:0},previewList:[],loading:!0,message:"Fetching Image for annotation"},a.getImageSize=function(){var e=Object(E.a)(y.a.mark(function e(t){return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return{},e.abrupt("return",new Promise(function(e,a){var n=new Image;n.src=t,n.onload=function(){return e({imgHeight:n.height,imgWidth:n.width})}}));case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.titleHandler=function(e){switch(e.message){case"Cannot read property 'map' of undefined":return"No segmentation data ";case"Cannot read property 'data' of undefined":return"No more images left for you";case"Cannot read property '0' of undefined":return"Image not valid";default:return e.message}},a.getRandomId=function(){return Math.random().toString().split(".")[1]},a.postImage=function(){var e=Object(E.a)(y.a.mark(function e(t,n){var r,o,i,c,l,s,u,m,d;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:console.log("next",t),r=[],l=a.state.dimension,s=l.imgWidth,u=l.imgHeight,null!=t.metadata?null!==t.images[0].regions?("object_detection"===a.state.annotatemode?t.images[0].regions.map(function(e){r.push({cls:e.cls,highlighted:!1,id:e.id,x:e.x*s,y:e.y*u,w:e.w*s,h:e.h*u,color:"hsl(82,100%,50%)",type:"box",cls_id:"".concat(a.state.class_list.indexOf(e.cls))})}):t.images[0].regions.map(function(e){var t=[];e.points.map(function(e,a){t.push([e[0]*s,e[1]*u])}),r.push({cls:e.cls,highlighted:!1,id:e.id,points:t,color:"hsl(82,100%,50%)",type:"polygon",cls_id:"".concat(a.state.class_list.indexOf(e.cls))})}),console.log("[generarted regions]",r),"review"===n&&(localStorage.getItem("checkList")?(m=JSON.parse(localStorage.getItem("checkList")),d=[].concat(Object(b.a)(m),[a.state.image_key]),localStorage.setItem("checkList",JSON.stringify(d))):localStorage.setItem("checkList",JSON.stringify([a.state.image_key]))),p.a.post("/annotations/update-get-image-data-by-user",{image_key:a.state.image_key,metadata:t.metadata,annotations:r},{headers:{Authorization:"bearer ".concat(localStorage.getItem("jwt"))},params:{annotate_mode:a.state.annotatemode,call_type:"review"===n?"next":n,curr_image_index:"previous"===n?a.state.curr_image_index-1:a.state.curr_image_index+1}}).then(function(e){i=e,localStorage.setItem("metadata",JSON.stringify(e.data.metadata)),console.log("[next api]",e),e.data.error?(a.setState({loading:!1,src:null}),un()({title:e.data.error,icon:"warning",buttons:!0})):a.toArrayBuffer(e.data.image.data).then(function(t){var r=new Blob([t],{type:"image/jpeg"});o=URL.createObjectURL(r),a.getImageSize(o).then(function(t){c=t;var r=[];e.data.annotations.obj_detect||e.data.annotations.segmentation?"object_detection"===a.state.annotatemode?e.data.annotations.obj_detect.map(function(e,n){r.push({cls:e.Class_Name,highlighted:!1,id:a.getRandomId(),x:e.Region[0]/t.imgWidth,y:e.Region[1]/t.imgHeight,w:e.Region[2]/t.imgWidth,h:e.Region[3]/t.imgHeight,color:"hsl(82,100%,50%)",type:"box"})}):e.data.annotations.segmentation.map(function(e,n){var o=[];e.Region.map(function(e,a){o.push([e[0]/t.imgWidth,e[1]/t.imgHeight])}),r.push({cls:e.Class_Name,highlighted:!1,id:a.getRandomId(),points:o,color:"hsl(82,100%,50%)",type:"polygon"})}):"object_detection"===a.state.annotatemode?e.data.annotations.map(function(e,a){r.push({cls:e.cls,highlighted:!1,id:e.id,x:e.x/t.imgWidth,y:e.y/t.imgHeight,w:e.w/t.imgWidth,h:e.h/t.imgHeight,color:"hsl(82,100%,50%)",type:"box"})}):e.data.annotations.map(function(e,a){var n=[];e.points.map(function(e,a){n.push([e[0]/t.imgWidth,[e[1]/t.imgHeight]])}),r.push({cls:e.cls,highlighted:!1,id:e.id,points:n,color:"hsl(82,100%,50%)",type:"polygon"})}),a.setState({curr_image_index:"previous"===n?a.state.curr_image_index-1:a.state.curr_image_index+1,src:o,regions:r,metadata:e.data.metadata,image_key:e.data.image_key,dimension:t,previewList:JSON.parse(localStorage.getItem("checkList"))?JSON.parse(localStorage.getItem("checkList")):[],loading:!1})}).catch(function(t){a.setState({curr_image_index:"previous"===n?a.state.curr_image_index-1:a.state.curr_image_index+1,src:o,metadata:e.data.metadata,image_key:e.data.image_key,dimension:c,regions:null,previewList:JSON.parse(localStorage.getItem("checkList"))?JSON.parse(localStorage.getItem("checkList")):[],loading:!1}),"Cannot read property 'map' of undefined"!==t.message&&un()({title:a.titleHandler(t),icon:"warning",buttons:!0})})}).catch(function(t){a.setState({curr_image_index:"previous"===n?a.state.curr_image_index-1:a.state.curr_image_index+1,src:o,metadata:e.data.metadata,image_key:e.data.image_key,dimension:c,regions:null,previewList:JSON.parse(localStorage.getItem("checkList"))?JSON.parse(localStorage.getItem("checkList")):[],loading:!1}),"Cannot read property 'map' of undefined"!==t.message&&un()({title:a.titleHandler(t),icon:"warning",buttons:!0})})}).catch(function(e){a.setState({curr_image_index:"previous"===n?a.state.curr_image_index-1:a.state.curr_image_index+1,src:o,metadata:i.data.metadata,image_key:i.data.image_key,dimension:c,regions:null,previewList:JSON.parse(localStorage.getItem("checkList"))?JSON.parse(localStorage.getItem("checkList")):[],loading:!1}),"Cannot read property 'map' of undefined"!==e.message&&un()({title:a.titleHandler(e),icon:"warning",buttons:!0})})):(console.log("exit if"),a.setState({loading:!1,metadata:JSON.parse(localStorage.getItem("metadata"))?JSON.parse(localStorage.getItem("metadata")):null}),un()({title:"Annotations  cannot be empty",icon:"warning",buttons:!0})):(console.log("[image]",t.images[0].regions,"[state]",a.state.regions),a.setState({loading:!1}),un()({title:"metadata cannot be empty",icon:"warning",buttons:!0}));case 4:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),a.prevImage=function(){var e=Object(E.a)(y.a.mark(function e(t){return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("previous",t),e.prev=1,a.setState({loading:!0,message:"Fetching previous Image ",metadata:null,regions:t.images[0].regions}),e.next=5,a.postImage(t,"previous").then(function(e){console.log("[prev call]",e)}).catch(function(e){a.setState({loading:!1}),un()({title:a.titleHandler(e),icon:"warning",buttons:!0})});case 5:e.next=11;break;case 7:e.prev=7,e.t0=e.catch(1),a.setState({loading:!1}),un()({title:a.titleHandler(e.t0),icon:"warning",buttons:!0});case 11:case"end":return e.stop()}},e,null,[[1,7]])}));return function(t){return e.apply(this,arguments)}}(),a.nextImage=function(){var e=Object(E.a)(y.a.mark(function e(t){return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,a.setState({loading:!0,message:"Fetching Next Image",metadata:null}),null===a.state.src){e.next=8;break}return console.log("ended"),e.next=6,a.postImage(t,"next").then(function(e){console.log("[next call]",e)}).catch(function(e){a.setState({loading:!1}),un()({title:a.titleHandler(e),icon:"warning",buttons:!0})});case 6:e.next=10;break;case 8:a.setState({loading:!1}),un()({title:"No more images",text:"Try reload or come back later",icon:"warning",buttons:!0});case 10:e.next=16;break;case 12:e.prev=12,e.t0=e.catch(0),a.setState({loading:!1}),un()({title:a.titleHandler(e.t0),icon:"warning",buttons:!0});case 16:case"end":return e.stop()}},e,null,[[0,12]])}));return function(t){return e.apply(this,arguments)}}(),a.checkImage=function(e){try{a.setState({loading:!0,message:"Marking the image for Review"}),a.postImage(e,"review").then(function(e){console.log("[review]",e)}).catch(function(e){a.setState({loading:!1}),un()({title:a.titleHandler(e),icon:"warning",buttons:!0})})}catch(t){a.setState({loading:!1}),un()({title:a.titleHandler(t),icon:"warning",buttons:!0})}},a.preview=function(e){console.log("[preview image]",e),a.setState({loading:!0,message:"Fething Image for Review"}),a.main_api("review",e)},a.changeAnnotateMode=function(e){a.setState({annotatemode:e}),"segmentation"===e?(a.setState({class_list:a.state.seg_class,curr_image_index:0,loading:!0,message:"changing into Segmentation mode"}),a.main_api("first")):(a.setState({class_list:a.state.obj_class}),"first"!=a.state.call_type&&(a.setState({loading:!0,curr_image_index:0,message:"changing into Object Detection mode"}),a.main_api("first")))},a.get_class=function(){var e=Object(E.a)(y.a.mark(function e(t){return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.a.get("/get_class",{params:{project:t}}).then(function(e){console.log(e),a.setState({obj_class:e.data.classes.obj_class,seg_class:e.data.classes.seg_class,class_list:e.data.classes.obj_class,allowed_metadata:e.data.classes.meta_data})}).catch(function(e){a.setState({loading:!1}),un()({title:a.titleHandler(e),icon:"warning",buttons:!0})});case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a}return Object(d.a)(t,e),Object(s.a)(t,[{key:"toArrayBuffer",value:function(){var e=Object(E.a)(y.a.mark(function e(t){var a,n,r;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(a=new ArrayBuffer(t.length),n=new Uint8Array(a),r=0;r<t.length;++r)n[r]=t[r];return e.abrupt("return",a);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"main_api",value:function(){var e=Object(E.a)(y.a.mark(function e(t,a){var n,r,o,i=this;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Mainapi"),e.next=3,p.a.get("annotations/get-image-data-by-user",{headers:{Authorization:"bearer ".concat(localStorage.getItem("jwt"))},params:{annotate_mode:this.state.annotatemode,call_type:t,curr_image_index:"first"===t?0:this.state.curr_image_index,image_key:a}}).then(function(e){console.log("[".concat(t,"]"),e),o=e,e.data.error?(i.setState({loading:!1}),un()({title:e.data.error,text:"come back later",icon:"warning",buttons:!0})):(localStorage.setItem("metadata",JSON.stringify(e.data.metadata)),i.toArrayBuffer(e.data.image.data).then(function(t){var a=new Blob([t],{type:"image/jpeg"});r=URL.createObjectURL(a),i.getImageSize(r).then(function(t){n=t;var a=[];null!=e.data.annotations?(e.data.annotations.obj_detect||e.data.annotations.segmentation?"object_detection"===i.state.annotatemode?e.data.annotations.obj_detect.map(function(e,n){a.push({cls:e.Class_Name,highlighted:!1,id:i.getRandomId(),x:e.Region[0]/t.imgWidth,y:e.Region[1]/t.imgHeight,w:e.Region[2]/t.imgWidth,h:e.Region[3]/t.imgHeight,color:"hsl(82,100%,50%)",type:"box"})}):e.data.annotations.segmentation.map(function(e,n){var r=[];e.Region.map(function(e,a){r.push([e[0]/t.imgWidth,e[1]/t.imgHeight])}),a.push({cls:e.Class_Name,highlighted:!1,id:i.getRandomId(),points:r,color:"hsl(82,100%,50%)",type:"polygon"})}):"object_detection"===i.state.annotatemode?e.data.annotations.map(function(e,n){a.push({cls:e.cls,highlighted:!1,id:e.id,x:e.x/t.imgWidth,y:e.y/t.imgHeight,w:e.w/t.imgWidth,h:e.h/t.imgHeight,color:"hsl(82,100%,50%)",type:"box"})}):e.data.annotations.map(function(e,n){var r=[];e.points.map(function(e,a){r.push([e[0]/t.imgWidth,[e[1]/t.imgHeight]])}),a.push({cls:e.cls,highlighted:!1,id:e.id,points:r,color:"hsl(82,100%,50%)",type:"polygon"})}),console.log("[generarted regions]",a),i.setState({curr_image_index:i.state.curr_image_index,src:r,regions:a,metadata:e.data.metadata,image_key:e.data.image_key,dimension:t,loading:!1})):(i.setState({loading:!1}),un()({title:"NO Annotations",icon:"warning",buttons:!0}),i.setState({curr_image_index:i.state.curr_image_index,src:r,regions:null,metadata:e.data.metadata,image_key:e.data.image_key,dimension:t,loading:!1}))}).catch(function(t){i.setState({curr_image_index:i.state.curr_image_index,src:r,regions:null,metadata:e.data.metadata,image_key:e.data.image_key,dimension:n,loading:!1}),"Cannot read property 'map' of undefined"!==t.message&&un()({title:i.titleHandler(t),icon:"warning",buttons:!0})})}).catch(function(t){i.setState({curr_image_index:i.state.curr_image_index,src:r,regions:null,metadata:e.data.metadata,image_key:e.data.image_key,dimension:n,loading:!1}),un()({title:i.titleHandler(t),icon:"warning",buttons:!0})}))}).catch(function(e){i.setState({curr_image_index:i.state.curr_image_index,src:r,regions:null,metadata:o.data.metadata,image_key:o.data.image_key,dimension:n,loading:!1}),un()({title:i.titleHandler(e),buttons:!0})});case 3:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){var e=Object(E.a)(y.a.mark(function e(){return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("did mount"),e.next=3,this.get_class("global");case 3:try{"first"===this.state.call_type&&(this.setState({loading:!0,message:"Fetching Image for annotation"}),localStorage.removeItem("checkList"),this.main_api("first","first"),this.setState({call_type:"previous"}))}catch(t){console.log(t.response),alert("could'nt load image")}case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state,t=e.loading,a=e.message,n=e.metadata,o=e.allowed_metadata,i=e.previewList,c=e.curr_image_index,l=e.annotatemode,s=e.class_list,u=e.src,m=e.regions;return r.a.createElement(ln,{loading:t,message:a,metadata:n,allowed_metadata:o,preview:this.preview,previewList:i,curr_image_index:c,changeAnnotateMode:this.changeAnnotateMode,annotatemode:l,allowedArea:{x:0,y:0,w:1,h:1},taskDescription:"Annotate the imaes by selecting the mode for object detection or segmentationl",images:[{src:u,name:"Task:Enter the Metadata First then Annotate",regions:m}],regionClsList:s,onPrevImage:this.prevImage,onNextImage:this.nextImage,onExit:this.checkImage})}}]),t}(n.Component),dn=a(88),gn=a.n(dn),hn=(a(499),a(168)),fn=a.n(hn),pn=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(u.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).logout=function(){var e=a.props.history;console.log("logging out"),localStorage.removeItem("jwt"),a.props.updateUser({loggedIn:!1,username:null}),e.push("/")},a.confirmLogout=function(){un()({title:"Are you sure to Logout?",icon:"warning",buttons:!0,dangerMode:!0}).then(function(e){e?a.logout():un()("You are loggedIn !")})},a}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props.loggedIn;return r.a.createElement("div",null,e?r.a.createElement("div",{className:"w3-bar w3-black"},r.a.createElement("a",{className:"w3-bar-item"},r.a.createElement("img",{src:gn.a,className:"App-logo",alt:"logo"}),r.a.createElement("strong",null,r.a.createElement("span",{className:"w3-text-red"},"AUTO"),"\xa0"),r.a.createElement("strong",null,r.a.createElement("span",null,"ANNOTATION"))),r.a.createElement(c.b,{to:"#",className:"w3-bar-item w3-button w3-hover-dark-gray  w3-right",onClick:this.confirmLogout},r.a.createElement(fn.a,null),r.a.createElement("div",null,"LogOut"))):r.a.createElement("div",{className:"w3-bar w3-black"},r.a.createElement("a",{className:"w3-bar-item"},r.a.createElement("strong",null,r.a.createElement("span",{className:"w3-text-red"},"AUTO"),"\xa0"),r.a.createElement("strong",null,r.a.createElement("span",null,"ANNOTATION"))),r.a.createElement(c.b,{to:"/login",className:"w3-bar-item w3-button w3-hover-dark-gray w3-right"},"Login"),r.a.createElement(c.b,{to:"/signup",className:"w3-bar-item w3-button w3-hover-dark-gray w3-right"},"SignUp")))}}]),t}(n.Component),bn=Object(h.g)(pn),vn=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).state={hasError:!1},a}return Object(d.a)(t,e),Object(s.a)(t,[{key:"componentDidCatch",value:function(e,t){alert(e)}},{key:"render",value:function(){return this.state.hasError?r.a.createElement("h1",null,"Something went wrong."):this.props.children}}],[{key:"getDerivedStateFromError",value:function(e){return{hasError:!0}}}]),t}(r.a.Component),yn=function(e){function t(){return Object(l.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props.loggedIn,t=this.props.updateUser;return e?r.a.createElement("div",null,r.a.createElement(vn,null,r.a.createElement(bn,{updateUser:t,loggedIn:e})),r.a.createElement(vn,null,r.a.createElement(mn,null))):r.a.createElement(h.a,{to:"/"})}}]),t}(n.Component),En=Object(h.g)(yn),On=a(558),wn=a(557),xn=a(560),jn=a(92),In=a(116),Sn=a.n(In);function _n(){return r.a.createElement(jn.a,{variant:"body2",color:"textSecondary",align:"center"},"Copyright \xa9 ",r.a.createElement(wn.a,{color:"inherit",href:"https://fluxauto.xyz/"},"www.fluxauto.xyz")," ",(new Date).getFullYear(),".")}var Nn=Object(x.a)(function(e){return{root:{height:"100vh"},image:{backgroundImage:"url(".concat(gn.a,")"),backgroundRepeat:"no-repeat",backgroundColor:"black",backgroundSize:"500px 500px",backgroundPosition:"center"},paper:{margin:e.spacing(8,4),display:"flex",flexDirection:"column",alignItems:"center"},avatar:{margin:e.spacing(1),backgroundColor:e.palette.secondary.main},form:{width:"100%",marginTop:e.spacing(1)},submit:{margin:e.spacing(3,0,2)},maindiv:{backgroundImage:"url(".concat(Sn.a,")")}}});function Tn(e){var t=Nn(),a=Object(n.useState)(!1),o=Object(w.a)(a,2),i=o[0],c=o[1],l=Object(n.useState)(null),s=Object(w.a)(l,2),u=s[0],m=s[1];return i?r.a.createElement(cn,{message:"sending reset link to the email address"}):r.a.createElement(Q.a,{container:!0,component:"main",className:t.root},r.a.createElement(On.a,null),r.a.createElement(Q.a,{item:!0,xs:!1,sm:4,md:7,className:t.image}),r.a.createElement(Q.a,{item:!0,xs:12,sm:8,md:5,component:j.a,elevation:6,square:!0},r.a.createElement("div",{className:t.paper},r.a.createElement("div",null,r.a.createElement("h2",{className:"w3-text-red"},"AUTO"),r.a.createElement("h2",null,"ANNOTATION")),r.a.createElement(jn.a,{component:"h1",variant:"h5"},"FORGOT PASSWORD"),r.a.createElement("form",{className:t.form},r.a.createElement(Ye.a,{variant:"outlined",margin:"normal",fullWidth:!0,id:"email",label:"Email Address",name:"email",autoComplete:"email",onChange:function(e){m(e.target.value)},autoFocus:!0,required:!0}),r.a.createElement(ct.a,{type:"submit",fullWidth:!0,onClick:function(e){e.preventDefault(),null!=u?(c(!0),p.a.post("/user/forgot-password",{email:u}).then(function(e){(e.data.message="recovery mail sent")&&(c(!1),un()({title:"Recovery mail sent check yor mail",icon:"success",buttons:!0}))}).catch(function(e){c(!1),un()({title:e.message,icon:"warning",buttons:!0})})):un()({title:"All fields are Mandatory",icon:"warning",buttons:!0})},variant:"contained",color:"primary",className:t.submit},"submit"),r.a.createElement(xn.a,{mt:5},r.a.createElement(_n,null))))))}var Cn={margin:"1em",fontSize:"24px"},kn=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(u.a)(this,Object(m.a)(t).call(this))).state={username:"",password:"",confirmPassword:"",updated:!1,isLoading:!0,error:!1},e.handleSubmit=e.handleSubmit.bind(Object(g.a)(Object(g.a)(e))),e.handleChange=e.handleChange.bind(Object(g.a)(Object(g.a)(e))),e}return Object(d.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=Object(E.a)(y.a.mark(function e(){var t,a;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props.match.params.token,e.prev=1,e.next=4,p.a.get("/user/reset",{params:{resetPasswordToken:t}});case 4:"password reset link a-ok"===(a=e.sent).data.message&&(console.log(a.data.username),this.setState({username:a.data.username,updated:!1,isLoading:!1,error:!1})),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(1),console.log(e.t0.response.data),this.setState({updated:!1,isLoading:!1,error:!0});case 12:case"end":return e.stop()}},e,this,[[1,8]])}));return function(){return e.apply(this,arguments)}}()},{key:"handleChange",value:function(e){console.log(e.target.name),this.setState(Object(It.a)({},e.target.name,e.target.value))}},{key:"handleSubmit",value:function(){var e=Object(E.a)(y.a.mark(function e(t){var a,n,r,o,i;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),a=this.state,n=a.username,r=a.password,o=this.props.match.params.token,e.prev=3,e.next=6,p.a.put("/user/forgot-password-update",{username:n,password:r,resetPasswordToken:o});case 6:i=e.sent,console.log(i.data),"password reset successfully"===i.data.message?(this.setState({updated:!0,error:!1}),this.props.history.push("/")):this.setState({updated:!1,error:!0}),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(3),console.log(e.t0.response.data);case 14:case"end":return e.stop()}},e,this,[[3,11]])}));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state,t=e.password,a=e.error,n=e.isLoading,o=e.updated,i=e.confirmPassword;return a?r.a.createElement("div",null,r.a.createElement("div",{style:Cn},r.a.createElement("h4",null,"Problem resetting password. Please send another reset link."))):n?r.a.createElement("div",null,r.a.createElement("div",{style:Cn},"Loading User Data...")):r.a.createElement("div",null,r.a.createElement("h4",null,"Reset Password"),r.a.createElement("form",{className:"form-horizontal",onSubmit:this.handleSubmit},r.a.createElement("div",{className:"form-group"},r.a.createElement("div",{className:"col-1 col-ml-auto"},r.a.createElement("label",{className:"form-label",htmlFor:"password"},"New Password")),r.a.createElement("div",{className:"col-3 col-mr-auto"},r.a.createElement("input",{className:"form-input",placeholder:"password",type:"password",name:"password",value:t,onChange:this.handleChange,required:"required"}))),r.a.createElement("div",{className:"form-group"},r.a.createElement("div",{className:"col-1 col-ml-auto"},r.a.createElement("label",{className:"form-label",htmlFor:"username"},"Confirm New Password")),r.a.createElement("div",{className:"col-3 col-mr-auto"},r.a.createElement("input",{className:"form-input",type:"password",name:"confirmPassword",placeholder:"Confirm Password",value:i,onChange:this.handleChange,required:"required"}))),r.a.createElement("div",{className:"form-group "},r.a.createElement("div",{className:"col-7"}),r.a.createElement("button",{className:"btn btn-primary col-1 col-mr-auto",type:"submit"},"Submit"))),o&&r.a.createElement("div",null,r.a.createElement("p",null,"Your password has been successfully reset, please try logging in again.")))}}]),t}(n.Component),An=Object(h.g)(kn);function Mn(){return r.a.createElement(jn.a,{variant:"body2",color:"textSecondary",align:"center"},"Copyright \xa9 ",r.a.createElement(wn.a,{color:"inherit",href:"https://fluxauto.xyz/"},"www.fluxauto.xyz")," ",(new Date).getFullYear(),".")}var Ln=Object(x.a)(function(e){return{root:{height:"100vh"},image:{backgroundImage:"url(".concat(gn.a,")"),backgroundRepeat:"no-repeat",backgroundColor:"black",backgroundSize:"500px 500px",backgroundPosition:"center"},paper:{margin:e.spacing(8,4),display:"flex",flexDirection:"column",alignItems:"center"},avatar:{margin:e.spacing(1),backgroundColor:e.palette.secondary.main},form:{width:"100%",marginTop:e.spacing(1)},submit:{margin:e.spacing(3,0,2)},maindiv:{backgroundImage:"url(".concat(Sn.a,")")}}});function Rn(e){var t=Ln(),a=Object(n.useState)(!1),o=Object(w.a)(a,2),i=o[0],c=o[1],l=Object(n.useState)(""),s=Object(w.a)(l,2),u=s[0],m=s[1],d=Object(n.useState)(""),g=Object(w.a)(d,2),f=g[0],b=g[1],v=Object(n.useState)(""),y=Object(w.a)(v,2),E=y[0],O=y[1],x=Object(n.useState)(null),I=Object(w.a)(x,2),S=I[0],_=I[1],N=Object(n.useState)(""),T=Object(w.a)(N,2),C=T[0],k=T[1],A=Object(n.useState)(""),M=Object(w.a)(A,2),L=M[0],R=M[1],P=Object(n.useState)(""),D=Object(w.a)(P,2),W=D[0],B=D[1],G=Object(n.useState)(null),z=Object(w.a)(G,2),H=z[0],V=z[1];return S?r.a.createElement(h.a,{to:{pathname:S}}):i?r.a.createElement(cn,{message:"signing up please wait"}):r.a.createElement(Q.a,{container:!0,component:"main",className:t.root},r.a.createElement(On.a,null),r.a.createElement(Q.a,{item:!0,xs:!1,sm:4,md:7,className:t.image}),r.a.createElement(Q.a,{item:!0,xs:12,sm:8,md:5,component:j.a,elevation:6,square:!0},r.a.createElement("div",{className:t.paper},r.a.createElement("div",null,r.a.createElement("h2",{className:"w3-text-red"},"AUTO"),r.a.createElement("h2",null,"ANNOTATION")),r.a.createElement(jn.a,{component:"h1",variant:"h5"},"Sign up"),r.a.createElement("form",{className:t.form},r.a.createElement(Q.a,{container:!0,spacing:2},r.a.createElement(Q.a,{item:!0,xs:12,sm:6},r.a.createElement(Ye.a,{autoComplete:"fname",name:"firstName",variant:"outlined",required:!0,fullWidth:!0,id:"firstName",onChange:function(e){k(e.target.value)},label:"First Name",autoFocus:!0})),r.a.createElement(Q.a,{item:!0,xs:12,sm:6},r.a.createElement(Ye.a,{variant:"outlined",required:!0,fullWidth:!0,id:"lastName",label:"Last Name",name:"lastName",onChange:function(e){R(e.target.value)},autoComplete:"lname"}))),r.a.createElement(Ye.a,{autoComplete:"uname",margin:"normal",onChange:function(e){m(e.target.value)},name:"username",variant:"outlined",required:!0,fullWidth:!0,id:"username",label:"User Name",autoFocus:!0}),r.a.createElement(Ye.a,{variant:"outlined",margin:"normal",fullWidth:!0,id:"email",label:"Email Address",name:"email",autoComplete:"email",onChange:function(e){V(e.target.value)},autoFocus:!0,required:!0}),r.a.createElement(Ye.a,{variant:"outlined",margin:"normal",fullWidth:!0,id:"mobile",label:"Phone",name:"mobile",autoComplete:"mobile",onChange:function(e){B(e.target.value)},autoFocus:!0,required:!0}),r.a.createElement(Q.a,{container:!0,spacing:2},r.a.createElement(Q.a,{item:!0,xs:12,sm:6},r.a.createElement(Ye.a,{variant:"outlined",margin:"normal",fullWidth:!0,name:"password",label:"Password",type:"password",id:"password",onChange:function(e){b(e.target.value)},autoComplete:"current-password",required:!0})),r.a.createElement(Q.a,{item:!0,xs:12,sm:6},r.a.createElement(Ye.a,{variant:"outlined",margin:"normal",fullWidth:!0,name:"confirmPassword",label:"Confirm Password",type:"password",id:"password",onChange:function(e){O(e.target.value)},autoComplete:"current-password",required:!0}))),r.a.createElement(ct.a,{type:"submit",fullWidth:!0,onClick:function(e){console.log("sign-up handleSubmit, username: "),console.log(u),e.preventDefault(),u&&f&&E&&W&&H&&C&&null!==L?f!==E?alert("Passwords did not match"):(c(!0),p.a.post("/user/",{username:u,password:f,confirmPassword:E,firstName:C,lastName:L,email:H,mobile:W}).then(function(e){e.data.error?(c(!1),un()({title:"username already exists",icon:"warning",buttons:!0})):(c(!1),console.log("successful signup"),_("/"))}).catch(function(e){c(!1);var t=e.response.data.errors;un()({title:t[0].msg,icon:"warning",buttons:!0})})):un()({title:"All fields are Mandatory",icon:"warning",buttons:!0})},variant:"contained",color:"primary",className:t.submit},"Sign Up"),r.a.createElement(Q.a,{container:!0},r.a.createElement(Q.a,{item:!0},r.a.createElement(wn.a,{href:"/",variant:"body2"},"Have an account? Sign In"))),r.a.createElement(xn.a,{mt:5},r.a.createElement(Mn,null))))))}var Pn=function(){return r.a.createElement("div",null,r.a.createElement(h.d,null,r.a.createElement(h.b,{exact:!0,path:"/signup",component:Rn}),r.a.createElement(h.b,{exact:!0,path:"/forgot-password",component:Tn}),r.a.createElement(h.b,{exact:!0,path:"/reset/:token",component:An})))};function Dn(){return r.a.createElement(jn.a,{variant:"body2",color:"textSecondary",align:"center"},"Copyright \xa9 ",r.a.createElement(wn.a,{color:"inherit",href:"https://fluxauto.xyz/"},"www.fluxauto.xyz")," ",(new Date).getFullYear(),".")}var Wn=Object(x.a)(function(e){return{root:{height:"100vh"},image:{backgroundImage:"url(".concat(gn.a,")"),backgroundRepeat:"no-repeat",backgroundColor:"black",backgroundSize:"500px 500px",backgroundPosition:"center"},paper:{margin:e.spacing(8,4),display:"flex",flexDirection:"column",alignItems:"center"},avatar:{margin:e.spacing(1),backgroundColor:e.palette.secondary.main},form:{width:"100%",marginTop:e.spacing(1)},submit:{margin:e.spacing(3,0,2)},maindiv:{backgroundImage:"url(".concat(Sn.a,")")}}});var Bn=Object(h.g)(function(e){var t=Wn(),a=Object(n.useState)(!1),o=Object(w.a)(a,2),i=o[0],c=o[1],l=Object(n.useState)(null),s=Object(w.a)(l,2),u=s[0],m=s[1],d=Object(n.useState)(null),g=Object(w.a)(d,2),f=g[0],b=g[1],v=Object(n.useState)(null),y=Object(w.a)(v,2),E=y[0],O=y[1],x=function(e){switch(e.message){case"Request failed with status code 401":return"Incorect Username or Password";default:return e.message}};return localStorage.getItem("jwt")&&p.a.get("/user",{headers:{Authorization:"bearer ".concat(localStorage.getItem("jwt"))}}).then(function(t){200===t.status&&(e.updateUser({loggedIn:!0,username:t.data.username}),O("/user"))}).catch(function(e){c(!1),alert("login in again session expired")}),E?r.a.createElement(h.a,{to:{pathname:E}}):i?r.a.createElement(cn,{message:"logging in please wait"}):r.a.createElement(Q.a,{container:!0,component:"main",className:t.root},r.a.createElement(On.a,null),r.a.createElement(Q.a,{item:!0,xs:!1,sm:4,md:7,className:t.image}),r.a.createElement(Q.a,{item:!0,xs:12,sm:8,md:5,component:j.a,elevation:6,square:!0},r.a.createElement("div",{className:t.paper},r.a.createElement("div",null,r.a.createElement("h2",{className:"w3-text-red"},"AUTO"),r.a.createElement("h2",null,"ANNOTATION")),r.a.createElement(jn.a,{component:"h1",variant:"h5"},"Sign in"),r.a.createElement("form",{className:t.form},r.a.createElement(Ye.a,{variant:"outlined",margin:"normal",fullWidth:!0,id:"email",label:"User Name",name:"email",autoComplete:"email",onChange:function(e){m(e.target.value)},autoFocus:!0,required:!0}),r.a.createElement(Ye.a,{variant:"outlined",margin:"normal",fullWidth:!0,name:"password",label:"Password",type:"password",id:"password",onChange:function(e){b(e.target.value)},autoComplete:"current-password",required:!0}),r.a.createElement(ct.a,{type:"submit",fullWidth:!0,onClick:function(t){t.preventDefault();var a=e.history;u&&null!==f?(c(!0),p.a.post("/user/login",{username:u,password:f}).then(function(t){200===t.status&&(c(!1),e.updateUser({loggedIn:!0,username:t.data.username}),localStorage.setItem("jwt",t.data.token),O("/user"))}).catch(function(e){c(!1),un()({title:x(e),icon:"warning",buttons:!0}),a.push("/")})):un()({title:"All fields are Mandatory",icon:"warning",buttons:!0})},variant:"contained",color:"primary",className:t.submit},"Sign In"),r.a.createElement(Q.a,{container:!0},r.a.createElement(Q.a,{item:!0,xs:!0},r.a.createElement(wn.a,{href:"/forgot-password",variant:"body2"},"Forgot password?")),r.a.createElement(Q.a,{item:!0},r.a.createElement(wn.a,{href:"/signup",variant:"body2"},"Don't have an account? Sign Up"))),r.a.createElement(xn.a,{mt:5},r.a.createElement(Dn,null))))))}),Gn=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(u.a)(this,Object(m.a)(t).call(this))).state={loggedIn:!1,username:null},e.updateUser=e.updateUser.bind(Object(g.a)(Object(g.a)(e))),e}return Object(d.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=localStorage.getItem("jwt");p.a.get("/user",{headers:{Authorization:"bearer ".concat(t)}}).then(function(t){t.data.user&&e.setState({loggedIn:!0})}).catch(function(e){"jwt expired"!==e.response.data.message||alert("Token has Expired please LogIn again")})}},{key:"updateUser",value:function(e){this.setState(e)}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"App"},r.a.createElement(h.b,{exact:!0,path:"/user",render:function(){return r.a.createElement(En,{updateUser:e.updateUser,loggedIn:e.state.loggedIn})}}),r.a.createElement(h.b,{exact:!0,path:"/",render:function(){return r.a.createElement(Bn,{updateUser:e.updateUser})}}),r.a.createElement(Pn,null))}}]),t}(n.Component);i.a.render(r.a.createElement(c.a,null,r.a.createElement(Gn,null)),document.getElementById("root"))},88:function(e,t,a){e.exports=a.p+"static/media/logo.00d8ec7f.png"}},[[275,1,2]]]);
//# sourceMappingURL=main.cfccbf49.chunk.js.map